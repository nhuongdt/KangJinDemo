@using System.Web.Optimization
@using banhang24.AppCache
@using banhang24.Hellper
@{
    Layout = null;
}
<html>
<head>
    <meta http-equiv="origin-trial" content="Ah8wkbmYC1I0m0P4DSoZlNFIhvdOZE+Fndwcv8V3IHxswPZshSTF6dAQuPFeNrSmiHAecB8ys" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0" />
    <link href="~/Content/images/open24.vn.png" type="image/gif" rel="icon">
    <title>Open24.vn - Bán lẻ </title>
    <link href="@Html.WriteRenderFile(Styles.Url("~/Content/CssFramework"))" rel="stylesheet" />
    <link href="@Html.WriteRenderFile(Styles.Url("~/Content/Open24Css"))" rel="stylesheet" />
    <link href="@Html.WriteRenderFile(Styles.Url("~/Content/BanLeCss"))" rel="stylesheet" />
    <script type="text/javascript" src="@Scripts.Url("~/bundles/JsFramework")"></script>
    <script type="text/javascript" src="@Scripts.Url("~/bundles/JsStatic")"></script>

    <style>
        .op-popup-shortkey li {
            width: 100%
        }

        .mauin-cot-netlien {
            border-bottom: 1px solid #ccc;
        }

        .mauin-cot-netdut {
            border-bottom: 1px dashed #ccc;
        }
    </style>
    <style>
        .op-hoadon-item:hover .op-hoadon-ghichu > *, .op-hoadon-item:hover .op-hoadon-ghichu > input[type=text]::-webkit-input-placeholder {
            opacity: 1
        }

        .op-hoadon-ghichu input[type=text]::-webkit-input-placeholder {
            opacity: 0
        }

        .op-hoadon-ghichu input[type=text]:focus {
            opacity: 1;
        }

            .op-hoadon-ghichu input[type=text]:focus::-webkit-input-placeholder {
                opacity: 1;
            }

            .op-hoadon-ghichu input[type=text]:focus + i {
                opacity: 1;
            }

        .op-hoadon-text {
            padding-bottom: 5px;
            position: relative;
        }

        .op-hoadon-ghichu {
            position: relative;
            /*bottom: -4px;*/
            height: 15px;
            /*left: 134px;*/
            width: 250px;
        }

            .op-hoadon-ghichu > i {
                position: absolute;
                left: 0;
                top: 0;
                opacity: 0;
            }

            .op-hoadon-ghichu > input {
                border: none;
                padding-left: 15px;
                border-bottom: 1px solid #ccc;
                border-radius: 0;
                font-size: 12px;
                line-height: 15px;
                height: 15px;
                padding-top: 0px;
                width: 250px;
                opacity: 0
            }

        .input-sl-quy-cach input {
            min-width: 55px;
            max-width: 55px;
        }

        #floatpayment {
            cursor: pointer;
            line-height: 15px;
            height: 50px;
            width: auto;
            border-radius: 75px;
            background: var(--color-primary);
            border: 3px solid white;
            text-align: center;
            padding: 15px;
            font-size: 18px;
            color: white;
            font-weight: bold;
            position: fixed;
            bottom: 15px;
            z-index: 12;
            right: 0;
        }

        .hoverenabled {
            background: #99cccc;
        }

        .content-warning {
            border-bottom: 1px solid #32b7b3 !important;
        }

        #txtDaTraKhach {
            border-bottom: none;
        }

        .slide-goods {
            height: 340px !important;
        }

        #thanhtoan {
            transition: border-radius 0.4s cubic-bezier(0.4,0.0,0.2,1);
        }

        .bor22 {
            border-top-left-radius: 23px;
            border-bottom-left-radius: 23px;
        }

        .my-fa-check {
            display: block !important;
            color: black !important;
        }
        /* style for bottomrightnotify */
        .margin-bttom-70 {
            margin-bottom: 70px !important;
        }
        /* style for delete file excel */
        .delete-file {
            float: right;
            line-height: 32px;
            padding-right: 10px;
            padding-top: 9px;
        }

        .focusLot {
            background: #99cccc !important;
        }

        .divlist-LoHang {
            width: 292px !important;
        }

            .divlist-LoHang span i {
                font-size: 12px !important;
            }

            .divlist-LoHang li {
                border-bottom: 1px solid #ccc !important;
            }

        .lbl-input {
            padding-top: 10px;
            float: right;
        }

        #mobile-nav {
            background: var(--color-main);
        }

        .grocery .bill-listchoose li {
            border-bottom: none;
        }

        .group-list-img-user li, .detail-user .bill-listmenu {
            padding: 0px !important;
        }

        .bor-der-detail-user {
            border-right: 1px solid #00a69c;
            border-top: 1px solid #00a69c;
            border-left: 1px solid #00a69c;
        }

        .thanh-toan-header {
            height: 43px;
        }

        .pay-fix {
            min-height: 100px;
            width: 100%
        }

        .supper-hotline {
            height: 30px;
        }

        .ui-autocomplete {
            max-height: 700px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .name-lot1 {
            padding-left: 0px;
        }

        .bill-de {
            float: right;
        }

        .pop-discount-user .callprice-left {
            white-space: nowrap;
            width: 40%;
        }

        .pop-discount-user .callprice-right {
            width: 60%;
        }

        .table-discount-user {
            max-height: 370px;
            min-height: 360px;
        }

        .pop-discount-user input {
            border: none;
            border-bottom: 1px solid #ccc !important;
            line-height: 29px;
            outline: none;
        }

        .expiry-date-service .form-group label {
            width: 110px !important;
            margin-top: 0;
            line-height: 30px !important;
            border-radius: 0px;
        }

        .expiry-date-service .form-group {
            width: 55% !important;
            margin: 0px !important;
        }

            .expiry-date-service .form-group .form-news {
                width: calc(100% - 110px);
            }

        .group-quantity-serrvice {
            position: absolute;
            top: 0px;
            width: 60px;
            padding: 0px;
            background: #f59c00;
        }

            .group-quantity-serrvice label {
                top: 3px;
            }

        .group-detail-serrvice {
            position: absolute;
            background: #555;
            color: white;
            top: -60px;
            left: 71px;
            z-index: 2;
            border-radius: 5px;
            width: 109px;
            padding: 5px;
        }

            .group-detail-serrvice .title-p {
                font-size: 14px;
                font-weight: bold;
                border-bottom: 1px solid white;
            }

        .grocery .bill-listmenu, .slide-goods1 .bill-listmenu li {
            overflow: inherit;
        }

        .group-detail-serrvice:before {
            font-family: FontAwesome;
            position: absolute;
            bottom: 0;
            right: 108px;
            font-size: 30px;
            top: 48px;
            content: "\f0d9";
            color: #555555;
        }

        .expiry-date-service .form-news input {
            border: none;
            border-bottom: 1px solid #ccc;
            box-shadow: none;
        }

        .list-munber-edit-quy-cach {
            width: 155px;
        }

        .list-nameproduct {
            width: calc(100% - 560px) !important;
        }

        .i-con-ban-hang {
            display: inline-block;
            display: flex;
            flex-direction: row;
            justify-content: flex-end;
            align-items: center
        }

            .i-con-ban-hang a {
                margin-left: 2px;
                line-height: 24px;
                width: 30px;
                padding: 3px;
                height: 30px;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .i-con-ban-hang img {
                margin-bottom: 9px;
            }

        .input-sl-quy-cach {
            position: relative;
        }

            .input-sl-quy-cach span {
                float: left
            }

        .check-after-li {
            float: right;
            padding-right: 20px;
            line-height: 21px;
            color: #009ddc;
            display: inline !important;
        }

        ._ten-hang-hoa p {
            margin: 0px;
        }

        .item-lot p:last-child {
            margin: 0px;
            margin-top: 3px;
        }

        .tree-title-check-all i {
            position: absolute;
            top: 8px;
            color: #999;
            line-height: 15px;
            left: 0px;
        }

        .item-lot {
            padding-bottom: 0;
            margin-bottom: 0
        }

        .list-price.input-sl {
            display: flex;
        }
    </style>
    <style>
        .op-table-bill td {
            line-height: 30px;
            font-size: 13px;
            padding: 5px;
            max-height: 40px;
            height: 40px;
            font-size: 14px;
            border-bottom: 1px solid #ccc;
        }
    </style>

</head>

<body class="grocery grocery-news">
    <div id="divPage">
        <!--start: chiet khau cthd (tính trên thành tiền)-->
        <div class="callprice" style="display: none; width:300px"
             id="ckTongCTHD">
            <div class="callprice-left" style="width:40%">
                Chiết khấu/ tổng:
            </div>
            <div class="callprice-right" style="width:60%">
                <input type="text" class=" number-price text-right" maxlength="12" style="width:100%!important"
                       onclick="this.select()"
                        onkeypress="keypressNumber_limitNumber(event,this)"
                       data-bind="event:{keyup: $root.editChietKhauTong_CTHD}">
            </div>
        </div>

        <div class=" bill-header floatleft flex" id="bill-header">
            <div class="w701" id="header1">
                <input style="display:none" value="@ViewBag.cookieDonVi" id="txtDonVi" />
                <input type="hidden" value="@contant.GetUserCookies().ID_NhanVien" id="txtIDNhanVien" />
                <input type="hidden" value="@contant.GetUserCookies().ID" id="txtIDUser" />
                <input type="hidden" value="@contant.GetUserCookies().TaiKhoan" id="txtUserLogin" />
                <input type="hidden" value="@ViewBag.shopCookies" id="txtShopCookie" />
                <input type="hidden" value="@ViewBag.SubDomain" id="subDomain" />
                <div class="logoOpen24">
                    <a href="javascript:void(0)" hidden id="imgLogoOpen">
                        <img src="~/Content/images/logo-open24-min.png" data-bind="click: $root.GotoHome" alt="Logo" tabindex="0" onkeyup="" onkeydown="" />
                    </a>
                    <ul class="nav nav-tabs tab-so-do" hidden id="tabSoDo">
                        <li class="active" data-id="1" data-bind="click: function(){ClickTab_PhongBan(false)} ">
                            <a data-toggle="tab" href="#banhangsodo">
                                <span class="sp-hdbl-sodo">
                                    Sơ đồ(F1)
                                </span>
                                <span class="i-hdbl-sodo">
                                    <i class="fa fa-cubes" aria-hidden="true"></i>
                                </span>
                            </a>
                        </li>
                        <li data-id="2" data-bind="click: ClickTab_HangHoa">
                            <a data-toggle="tab" href="#banhanghanghoa">
                                <span class="sp-hdbl-sodo">Hàng hóa(F2)</span><span class="i-hdbl-sodo">
                                    <i class="fa fa-shopping-basket" aria-hidden="true"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="filter-so-do" hidden>
                    <div class="input-so-do" id="sodo">
                        <input class="form-control " placeholder="Tìm kiếm vị trí" id="txtSearchVT" autocomplete="off"
                               v-model="query" v-on:keyup="submit" onfocusout="HideLostFocust()" onclick="this.select()">
                        <i class="fa fa-search" aria-hidden="true" style="font-size: 16px;line-height: 10px;"></i>
                        <div id="divSearchVT" hidden>
                            <ul>
                                <li class="list-search " v-for="item of resultPhongBan" v-on:click="click(item)" v-bind:id="item.ID">
                                    <div class="detail-user-discount detail-search">
                                        <p>
                                            <span class="title-user">{{ item.TenViTri }}</span>
                                        </p>
                                        <span class="seach-hh"> {{ item.TenKhuVuc }}</span>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="total-so-do">
                        <span data-bind="text: NumberTableUsed"></span>&nbsp;trí bận | <span data-bind="text: NumberTableEmpty"></span>&nbsp;vị trí trống
                    </div>
                </div>
                <div class="filter-ban-le  flex flex-row">
                    @*<button id="showHH_m">
                        <i class="material-icons">menu</i>
                    </button>*@
                    <button id="showHH_m" hidden class="btn-link "><i class="material-icons">playlist_add</i></button>
                    <button id="showTH_m" hidden class="btn-link"><i class="material-icons">shuffle</i></button>
                    <div id="searchandadd">
                        <div id="el" class="position-relative">
                            <input type="text" class="form-control ui-autocomplete-input form-control " id="txtSearchHH" autocomplete="off" title="Tìm kiếm hàng hóa, dịch vụ"
                                   v-model="query" v-on:keyup="submit" onfocusout="HideLostFocust()" placeholder="Tìm kiếm(F3)" onclick="this.select(),add_zindex_above(this)" onkeypress="add_zindex_above(this)">
                            <i class="fa fa-search" aria-hidden="true" style="    font-size: 18px;    line-height: 10px;   position: absolute;    top: 15px;    color: #686868;    left: 15px;"></i>
                            <button type="button" class="icon-addHH bg-hover" title="Thêm mới hàng" data-bind="click: ShowForm_NewProduct">
                                <i class="material-icons md-24">add</i>
                            </button>
                            <div id="showseach" hidden>
                                <ul class="op-vue-listsearchHH">
                                    <li v-for="item of searchResult" v-on:click="click(item)" v-bind:id="item.ID_DonViQuiDoi +'_'+ item.ID_LoHang">
                                        <div>
                                            <img v-bind:src="item.SrcImage != '' ? Open24FileManager.hostUrl + item.SrcImage : '/Content/images/iconbepp18.9/gg-37.png'" alt="Ảnh tìm kiếm" />
                                            <div class="op-hh-detail">
                                                <div>
                                                    <span class="bold">
                                                        {{ item.TenHangHoa }}
                                                        <span style="font-style:normal">
                                                            <span title="Thuộc tính giá trị" style="color:#ff6a00">{{item.ThuocTinh_GiaTri}}</span>
                                                            <span title="Đơn vị tính" style="color:#007acc">{{ item.TenDonViTinh }}</span>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div>
                                                    <span v-if="item.MaLoHang">
                                                        <span> Lô:</span>
                                                        <span class="red">{{ item.MaLoHang }}</span>
                                                    </span>
                                                    <span v-if="item.NgaySanXuat">
                                                        <span> NSX:</span>
                                                        <span style="color:green">
                                                            {{ item.NgaySanXuat==null?'': moment(item.NgaySanXuat).format('DD/MM/YYYY')}}
                                                        </span>
                                                    </span>
                                                    <span v-if="item.NgayHetHan">
                                                        <span> HSD:</span>
                                                        <span style="color:red">
                                                            {{ item.NgayHetHan==null?'': moment(item.NgayHetHan).format('DD/MM/YYYY') }}
                                                        </span>
                                                    </span>
                                                </div>
                                                <div>
                                                    <span>
                                                        <span> Mã HH:</span>
                                                        <span class="bold">
                                                            {{ item.MaHangHoa }}
                                                        </span>
                                                    </span>
                                                    <span>
                                                        <span> Giá:</span>
                                                        <span>
                                                            {{ formatNumber3Digit(item.GiaBan) }}
                                                        </span>
                                                    </span>
                                                    <span>
                                                        <span>  Tồn kho:</span>
                                                        <span>{{ formatNumber3Digit(item.TonKho) }}</span>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="position-relative">
                        <div class="number-fast-banle " id="pressNormal">
                            <input type="text" class="form-control text-right" id="txtSoLuong"
                                   onkeypress="keypressNumber_limitNumber(event,this)" maxlength="9"
                                   data-bind="value: $root.txtSoLuong, event:{keyup: editSoLuong_NhapThuong}, valueUpdate:'afterkeydown'"
                                   placeholder="Số lượng" />
                            <input type="text" class="form-control text-right" placeholder="Đơn giá" id="txtDonGia"
                                   onkeypress="return keypressNumber(event)"
                                   data-bind="value: $root.txtDonGia, event:{keyup: editDonGia_NhapThuong}, valueUpdate:'afterkeydown'" />
                        </div>
                        <div class="box-barcode " data-bind="click: NhapThuong_Nhanh" tabindex="-1">
                            <img src="~/Content/images/print-min.png" alt="Nhập nhanh" />
                        </div>
                    </div>
                    <button id="showHH_r" class="btn-link ">
                        <i class="material-icons">more_vert</i>
                    </button>
                </div>
                <div class="bill-bxslide bill-bxslide-news pull-right " id="divListHD" hidden>
                    <div class="pull-left" style="width:100%; ">
                        <div class="pull-left btn-slide-prev">
                            <a class="btn btn-link" href="javascript:void(0)" data-bind="click: prevHoaDon, visible: hasPrevHD">
                                <i class="glyphicon glyphicon-menu-left"></i>
                            </a>
                        </div>
                        <ul class="pull-left" id="divListHDul">
                            <!--ko foreach: result_HoaDon -->
                            <li data-bind="click: $parent.GetThongTinHoaDon, attr:{class: IsActive, title: MaHoaDon}" tabindex="0">
                                <img class="act-l" src="~/Content/images/coner.png" hidden tabindex="-1" alt="" />
                                <label data-bind="text: commonStatisJs.SubStringContent(MaHoaDon,12)"></label>
                                <font data-bind="attr:{id:'li_'+ $index() }, text: MaHoaDon" hidden>
                                </font>
                                <span data-bind="click: $parent.CloseHoaDon" class="btn-bodder" tabindex="0">
                                    <i class="material-icons md-18">close</i>
                                </span>
                                <img class="act-r" src="~/Content/images/coner.png" hidden alt="" />
                            </li>
                            <!--/ko-->
                            @*<li class="add-top1 add-tab-ban-le bg-hover" data-bind="click:addPhongBan" tabindex="0">
                                <a href="javascript:void(0)" class="bill-pluss bill-plusnext">
                                    <i class="material-icons md-24">add</i>
                                </a>
                            </li>*@
                        </ul>
                        <div class="pull-right btn-slide-next">
                            <a class="btn btn-link" href="javascript:void(0)" data-bind="click: nextHoaDon, visible: hasNextHD">
                                <i class="glyphicon glyphicon-menu-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="w301 flex flex-between" id="thanhtoan">
                <div class="dropdown ">
                    <button title="Chi nhánh" data-toggle="dropdown" class="btn btn-link black" style="text-decoration:none" id="divChiNhanh0" data-bind="click: showChiNhanh_byUser" hidden>
                        <i class="fa fa-map-marker font-14"></i>
                        <span data-bind="text:titleChinhanh"></span>
                    </button>
                    <div class="dropdown-menu" style="padding:5px">
                        <div class="op-search">
                            <input type="text" class="input-simple" data-bind="value: filterChiNhanh,  valueUpdate: 'afterkeydown'" placeholder="Tìm kiếm chi nhánh">
                            <i class="fa fa-search op-search-icon"></i>
                        </div>
                        <ul style="max-height:200px;overflow-y:auto" id="lstChiNhanh" data-bind="foreach: arrChiNhanhs_byUser">
                            <li data-bind="click: $parent.ChangeChiNhanh" class="flex flex-between">
                                <a data-bind="text: TenDonVi, attr:{id: ID}"></a>
                                <span data-bind="attr:{id: 'spanCheckChiNhanh_'+ ID}">
                                </span>
                            </li>
                        </ul>
                        <div class="text-center padding-10" data-bind="visible: arrChiNhanhs_byUser().length==0">
                            <i>Không tìm thấy chi nhánh</i>
                        </div>
                    </div>
                </div>
                <div class="bill-control-right">
                    <div class="flex flex-row op-banle-function">

                        @*<a class="main-keys" href="javascript:void(0)" data-toggle="tooltip" title="Ảnh khách hàng"
                           data-bind="click: $root.showModalAnhKH">
                            <i class="fal fa-camera"></i>
                        </a>*@

                        <a href="javascript:void(0)" title="Trả hàng" class="pay-return aReturn"
                           data-bind="click: $root.showpopuptrahangHD" data-toggle="tooltip">
                            <i class="fal fa-reply-all"></i>
                        </a>
                        <a data-bind="click: showHoaDonOffline" title="Đồng bộ dữ liệu" class="synchronous" data-toggle="tooltip">
                            <i class="fal fa-cloud-upload"> </i>
                            <span class="synchronousspan" data-bind="text: countHDoffilne, visible: countHDoffilne() > 0" style="display: none; color:var(--color-primary)">0</span>
                        </a>
                        <a class="bill-print" data-bind="click: function(){ BindSettingPrint(false)} " data-toggle="tooltip" title="Thiết lập in" onclick="showpanel(2)">
                            <i class="fal fa-print"></i>
                        </a>
                        <a href="javascript:void(0)" aria-haspopup="true" aria-expanded="false" onclick="showpanel(3)">
                            <i class="fal fa-cog" data-toggle="tooltip" title="Chức năng"></i>
                        </a>
                        <a id="divNhanVien0" data-bind="click: CheckRole_ChangeNVien">
                            <i class="fal fa-user" title="" data-bind="attr: { title: titleNhanvien }" data-toggle="tooltip"></i>
                            <span data-bind="text:titleNhanvien" style="display:none"></span>
                        </a>
                    </div>
                    <style>
                        .op-function-box {
                            position: absolute;
                            width: 400px;
                            right: 0px;
                            padding: 15px;
                            background: white;
                            z-index: 2;
                            display: none;
                            top: 50px;
                            border: 1px solid var(--color-primary);
                            box-shadow: 3px 3px 10px rgba(0,0,0,0.2);
                        }

                            .op-function-box:before, .op-function-box:after {
                                position: absolute;
                                width: 0;
                                height: 0;
                                top: -10px;
                                right: 15px;
                                border-left: 10px solid transparent;
                                border-right: 10px solid transparent;
                                border-bottom: 10px solid var(--color-primary);
                                transition: right 0.4s ease;
                                content: '';
                            }

                            .op-function-box:after {
                                top: -9px;
                                border-bottom: 10px solid white;
                            }

                            .op-function-box.active-4:after, .op-function-box.active-4:before {
                                right: 15px;
                            }

                            .op-function-box.active-3:after, .op-function-box.active-3:before {
                                right: 45px;
                            }

                            .op-function-box.active-2:after, .op-function-box.active-2:before {
                                right: 75px;
                            }

                            .op-function-box.active-1:after, .op-function-box.active-1:before {
                                right: 170px;
                            }

                        div#op_js_function > ul > li {
                            width: 100%;
                            margin: 3px;
                            height: 30px;
                            padding: 3px;
                            line-height: 24px;
                            display: flex;
                            align-items: center;
                        }
                    </style>
                    <div class="op-function-box" hidden>
                        <div id="op_js_function" hidden>
                            <ul class="flex flex-column op-popup-shortkey">
                                <li>
                                    <label>
                                        Chức năng
                                    </label>
                                </li>
                                <!--ko if: RoleInsert_Return()-->
                                <li class="aReturn">
                                    <a href="javascript:void(0)" data-toggle="modal" data-bind="click: showpopuptrahangHD">
                                        <i class="fal fa-share-square"></i>
                                        <span id="aReturn">Chọn hóa đơn trả hàng</span>
                                    </a>
                                </li>
                                <!--/ko-->
                                <li>
                                    <a href="javascript:void(0)" data-toggle="modal" data-bind="click: $root.showPopupBaoHanh">
                                        <i class="fas fa-shield-alt"></i> Chọn hóa đơn bảo hành
                                    </a>
                                </li>
                                <!--ko if: $root.roleCustomer_ThanhToanNo()-->
                                <li id="aCash">
                                    <a href="javascript:void(0)" data-toggle="modal" data-bind="click: showPopupLapPhieuThu">
                                        <i class="fal fa-file-alt"></i> Lập phiếu thu
                                    </a>
                                </li>
                                <!--/ko-->
                                <li id="aImport" hidden>
                                    <a href="javascript:void(0)" data-toggle="modal" data-bind="click: ShowmyModalinport">
                                        <i class="fas fa-upload"></i> Import hóa đơn
                                    </a>
                                </li>
                                <li>
                                    <a href="/#/Invoices" class="btn-gray"><i class="fal fa-list-alt"></i> Quản lý</a>
                                </li>
                                <li>
                                    <a href="javascript:void(0)" onclick="showpanel(1)">
                                        <i class="fal fa-question-circle"></i> Phím tắt
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div id="op_js_nhanvien" hidden>
                            <div class="flex flex-row flex-center" style="align-items:center; padding-bottom:10px">
                                <i class="fa fa-user"></i>
                                <h5 data-bind="text:titleNhanvien"></h5>
                            </div>
                            <div class="op-search">
                                <input placeholder="Tìm kiếm nhân viên" type="text" class="input-simple" id="txtChoseNVien" data-bind="value: filterNVien, valueUpdate: 'afterkeydown'" />
                                <i class="fa fa-search op-search-icon"></i>
                            </div>
                            <ul class="list-name-staff " id="lstNVien" style="margin-bottom:5px;">
                                <!--ko foreach: arrFilterNhanVien-->
                                <li data-bind="click: $parent.ChangeNVienBan">
                                    <a href="javascript:void(0)" data-bind="text: TenNhanVien, attr:{id: ID}" style="color:#686868 !important"></a>
                                    <span style="color:var(--color-primary)" data-bind="attr:{id: 'spanCheckNV_'+ ID}">
                                    </span>
                                </li>
                                <!--/ko -->
                            </ul>
                            <div style="margin-top:15px;">
                                <a href="/home/logout" class="flex flex-row" style="align-items:center;">
                                    <i class="fa fa-sign-out"></i>
                                    <span>Đăng xuất</span>
                                </a>
                            </div>
                        </div>
                        <div id="op_js_mauin" hidden>
                            @Html.Partial("_ThietLapMauIn")
                        </div>
                        @Html.Partial("_Shortcut_Keys")
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-content " style="padding:5px 0" id="bill-content">
            <div class="tab-pane active" id="banhangsodo" style="display:none">
                <div class="height-fix" id="bill-listed">
                    @Html.Partial("_SoDoPhong")
                </div>
            </div>
            <div class="tab-pane " id="banhanghanghoa">
                <div class="flex flex-row">
                    <div class="w701">
                        <div class="height-fix" id="mainlist">
                            <div class="name-title-table floatleft op-hoadon-header op-hoadon-item">
                                <div class="op-hoadon-text">
                                    <div class="hoadon-stt" data-bind="visible: showHeader_STT">
                                    </div>
                                    <div class="op-hoadon-id" data-bind="visible: showHeader_ProductCode">
                                        Mã SP
                                        <span id="onlineUsers"></span>
                                    </div>
                                    <div class="op-hoadon-name" data-bind="visible: showHeader_ProductName">
                                        Tên sản phẩm
                                        <span data-bind="text: SumProduct() ===0?'':'(' + formatNumber(SumProduct()) + ')'" style="display:inline"></span>
                                    </div>
                                </div>
                                <div class="op-hoadon-number">
                                    <div class="list-price" data-bind="visible: showHeader_ProductCount">
                                        Số lượng
                                        <span data-bind="text: SumQuantity() ===0?'':'(' +formatNumber3Digit(SumQuantity()) + ')' "></span>
                                    </div>
                                    <div class="warning" style="width:9px">
                                    </div>
                                    <div class=" list-price text-right" data-bind="visible: showHeader_ProductPrice">
                                        Đơn giá
                                    </div>
                                    <div class="list-price text-right " data-bind="visible: showHeader_ProductSale">
                                        Chiết khấu
                                    </div> 
                                    <div class="list-price text-right ">
                                        CK tổng
                                    </div>
                                    <div class="list-totle-price text-right" data-bind="visible: showHeader_SumPrice">
                                        Thành tiền
                                    </div>
                                </div>
                                <div class="op-hoadon-function"></div>
                            </div>
                            <div class="bill-listchoose floatleft op-hoadon-body" id="CTHDView" hidden>
                                <div id="shownostock" data-bind="visible : HangHoaAfterAdds().length==0 ">
                                    <div style="    display: inline-block;    width: min-content;">
                                        <svg style="    height: 200px;    width: 200px;    fill: #717171;" height="512pt" viewBox="0 -12 512.00032 512" width="512pt" xmlns="http://www.w3.org/2000/svg"><path d="m455.074219 172.613281 53.996093-53.996093c2.226563-2.222657 3.273438-5.367188 2.828126-8.480469-.441407-3.113281-2.328126-5.839844-5.085938-7.355469l-64.914062-35.644531c-4.839844-2.65625-10.917969-.886719-13.578126 3.953125-2.65625 4.84375-.890624 10.921875 3.953126 13.578125l53.234374 29.230469-46.339843 46.335937-166.667969-91.519531 46.335938-46.335938 46.839843 25.722656c4.839844 2.65625 10.921875.890626 13.578125-3.953124 2.660156-4.839844.890625-10.921876-3.953125-13.578126l-53.417969-29.335937c-3.898437-2.140625-8.742187-1.449219-11.882812 1.695313l-54 54-54-54c-3.144531-3.144532-7.988281-3.832032-11.882812-1.695313l-184.929688 101.546875c-2.757812 1.515625-4.644531 4.238281-5.085938 7.355469-.445312 3.113281.601563 6.257812 2.828126 8.480469l53.996093 53.996093-53.996093 53.992188c-2.226563 2.226562-3.273438 5.367187-2.828126 8.484375.441407 3.113281 2.328126 5.839844 5.085938 7.351562l55.882812 30.6875v102.570313c0 3.652343 1.988282 7.011719 5.1875 8.769531l184.929688 101.542969c1.5.824219 3.15625 1.234375 4.8125 1.234375s3.3125-.410156 4.8125-1.234375l184.929688-101.542969c3.199218-1.757812 5.1875-5.117188 5.1875-8.769531v-102.570313l55.882812-30.683594c2.757812-1.515624 4.644531-4.242187 5.085938-7.355468.445312-3.113282-.601563-6.257813-2.828126-8.480469zm-199.074219 90.132813-164.152344-90.136719 164.152344-90.140625 164.152344 90.140625zm-62.832031-240.367188 46.332031 46.335938-166.667969 91.519531-46.335937-46.335937zm-120.328125 162.609375 166.667968 91.519531-46.339843 46.339844-166.671875-91.519531zm358.089844 184.796875-164.929688 90.5625v-102.222656c0-5.523438-4.476562-10-10-10s-10 4.476562-10 10v102.222656l-164.929688-90.5625v-85.671875l109.046876 59.878907c1.511718.828124 3.167968 1.234374 4.808593 1.234374 2.589844 0 5.152344-1.007812 7.074219-2.929687l54-54 54 54c1.921875 1.925781 4.484375 2.929687 7.074219 2.929687 1.640625 0 3.296875-.40625 4.808593-1.234374l109.046876-59.878907zm-112.09375-46.9375-46.339844-46.34375 166.667968-91.515625 46.34375 46.335938zm0 0" /><path d="m404.800781 68.175781c2.628907 0 5.199219-1.070312 7.070313-2.933593 1.859375-1.859376 2.929687-4.4375 2.929687-7.066407 0-2.632812-1.070312-5.210937-2.929687-7.070312-1.859375-1.863281-4.441406-2.929688-7.070313-2.929688-2.640625 0-5.210937 1.066407-7.070312 2.929688-1.871094 1.859375-2.929688 4.4375-2.929688 7.070312 0 2.628907 1.058594 5.207031 2.929688 7.066407 1.859375 1.863281 4.441406 2.933593 7.070312 2.933593zm0 0" /><path d="m256 314.925781c-2.628906 0-5.210938 1.066407-7.070312 2.929688-1.859376 1.867187-2.929688 4.4375-2.929688 7.070312 0 2.636719 1.070312 5.207031 2.929688 7.078125 1.859374 1.859375 4.441406 2.921875 7.070312 2.921875s5.210938-1.0625 7.070312-2.921875c1.859376-1.871094 2.929688-4.441406 2.929688-7.078125 0-2.632812-1.070312-5.203125-2.929688-7.070312-1.859374-1.863281-4.441406-2.929688-7.070312-2.929688zm0 0" /></svg>
                                    </div>
                                    <div style="    font-size: 14px;    font-weight: bold;    color: #686868;">Không có hàng hóa nào trong giỏ hàng này!</div>
                                    <div style="margin-top:5px">Chọn <i class="material-icons sub-icon">menu</i> để thêm mới hàng hóa,  </div>
                                    <div style="margin-top:5px"> Chọn <i class="material-icons sub-icon">more_vert</i> để chuyển tiếp giữa hóa đơn</div>
                                    <div class="container-fluid nopadding" style="   height: 30px;    margin-top: 12px;">
                                        <a class="btn-link" data-bind="click: $root.showpopuptrahangHD">Trả hàng</a>
                                        <a class="btn-link" data-bind="click: showHoaDonOffline">Đồng bộ hóa</a>
                                    </div>
                                </div>
                                <ul data-bind="foreach: HangHoaAfterAdds" class="floatleft" id="mainlistHH">
                                    <li data-bind="css:$index()%2!==0?'li-info':''" class="li-show">
                                        <div class="op-hoadon-item">
                                            <div class="op-hoadon-text" onclick="push30(this)">
                                                <div class="op-hoadon-stt">
                                                    <span data-bind="text: SoThuTu"></span>
                                                </div>
                                                <div class="op-hoadon-id">
                                                    <b data-bind="text: commonStatisJs.SubStringContent(MaHangHoa,13)"></b>
                                                </div>
                                                <div class="op-hoadon-name">
                                                    <div class="">
                                                        <div class="op-hoadon-productname" data-bind="style: { width: ( TenDonViTinh=='' || TenDonViTinh ==null)? '100%' : 'calc(100% - 75px)' }">
                                                            <label data-bind="text: TenHangHoa, attr:{title: TenHangHoa}" class="hdhh-name"></label>
                                                        </div>
                                                        <div class="dropdown "
                                                             data-bind="visible: TenDonViTinh!=='' && TenDonViTinh !==null">
                                                            <button class="btn btn-link" type="button" data-toggle="dropdown" aria-expanded="true">
                                                                <span data-bind="text: TenDonViTinh"></span>
                                                                <i class="fal fa-angle-down notshow" aria-hidden="true" data-bind="style: { opacity:  ListDonViTinh.length > 1 ? 1 : 0 }"></i>
                                                            </button>
                                                            <ul class="dropdown-menu right-0" data-bind="foreach: ListDonViTinh">
                                                                <li data-bind="click: function (){ $root.ChangeDVT_HangHoa($data, $parent, false)} , css: {focusLot: ID_DonViQuiDoi == $parent.ID_DonViQuiDoi}">
                                                                    <a href="javascript:void(0);" data-bind="text: TenDonViTinh">Thùng</a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-item-khuyenmai" data-toggle="modal"
                                                         data-bind="visible: IsKhuyenMai && ChatLieu !=='4', click: $parent.GetListKM_ofHangHoa,attr:{id: 'promotion_'+ ID_DonViQuiDoi}">
                                                        <span data-bind="text: TenKhuyenMai, attr:{id: 'noteKM_'+ID_DonViQuiDoi }">
                                                        </span>
                                                        <span>
                                                            <i class="fa fa-gift bg-pink"></i>
                                                        </span>
                                                        <span class="bg-pink" data-bind="visible: TangKem">
                                                            (KM)
                                                        </span>
                                                    </div>
                                                    <div class="op-hoadon-item-chietkhauNV">
                                                        <p class="p-note" data-bind="text: GhiChu_NVThucHien"></p>
                                                        <p class="p-note" data-bind="text: GhiChu_NVTuVan"></p>
                                                    </div>
                                                    @*ghi chu cho lô*@
                                                    <div class="op-hoadon-ghichu" data-bind="visible: (QuanLyTheoLoHang !== true && LotParent !== true)">
                                                        <input autocomplete="off" type="text" placeholder="Ghi chú.." data-bind="value: GhiChu, event:{keyup: function(){$parent.UpdateCTHD_GhiChu ($data,false)}}" required>
                                                        <i class="fa fa-pencil"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="op-hoadon-number">
                                                <div class="list-price input-sl">
                                                    <div class="list-price input-sl">
                                                        <a href="javascript:void(0)" class="quy-cach-edit-left btn-gray">
                                                            <i class="fa fa-pencil-square-o" aria-hidden="true"
                                                               data-bind="click: function() {$root.ShowDivNhapQuyCach ($data,false)}, visible:QuyCach !== 1"></i>
                                                        </a>
                                                        <div class="call-quy-cach" style="display: none;  top:32px" data-bind="attr: {id: 'call-quy-cach_'+ IDRandom }">
                                                            <div class="callprice-left" style="width:40%">
                                                                Nhập quy cách:
                                                            </div>
                                                            <div class="callprice-right " style="width:60%">
                                                                <input type="text" class="number-price text-right"
                                                                       onkeypress="return keypressNumber(event)" onclick="this.select()"
                                                                       data-bind="event: {keyup: $root.EditQuyCach,
                                                           function:{mouseout: $root.MouseOutQuyCach ($data,false)}}">
                                                            </div>
                                                        </div>
                                                        <a href="javascript:void(0)" class="bill-plus" title="Giảm số lượng"
                                                           data-bind="event:{click: $parent.giamSoLuong }">
                                                            <i class="fal fa-angle-down"></i>
                                                        </a>
                                                        <div class="input-sl-quy-cach">
                                                            <input type="text" class=" input-simple" maxlength="9" autocomplete="off" 
                                                                   data-bind="value: formatNumber3Digit(SoLuong), attr:{id:'munber_' + IDRandom},
                                                   event:{keyup: $parent.editSoluong }, enable: $root.HoaDons().StatusOffline() == false"
                                                                   onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()">
                                                            <span data-bind="attr:{id: 'quycach_'+ IDRandom}, visible: SoLuongQuyCach > 0,
                                                 text: formatNumber3Digit(SoLuongQuyCach) " style="left:0;display:block; max-width:85px; text-align:center ;width:100%; position:absolute; top:25px;"></span>
                                                        </div>
                                                        <a href="javascript:void(0)" class="bill-plus bill-plusnext" title="Tăng số lượng"
                                                           data-bind="event:{click: $parent.tangSoLuong }">
                                                            <i class="fal fa-angle-up"></i>
                                                        </a>
                                                        <a href="javascript:void(0)" class="quy-cach-edit-right" title="Số lượng sản phẩm quá nhỏ" style="display:none"
                                                           data-bind="attr:{id: 'WrQuycach_' + IDRandom}">
                                                            <i class="fa fa-warning"></i>
                                                        </a>
                                                    </div>
                                                    <div class="bill-returns" data-bind="text: '/' + formatNumber3Digit(SoLuongDaMua), visible: SoLuongDaMua > 0">
                                                    </div>
                                                    <div class="bill-returns" data-bind="text: '/' + formatNumber3Digit(SoLuongConLai), visible: ChatLieu ==='4'">
                                                    </div>
                                                </div>
                                                <div class="warning" data-bind=" visible: CssWarning">
                                                    <div class="floatleft"
                                                         data-bind="attr:{id: 'show_wr_'+ IDRandom}, visible: CssWarning ">
                                                        <div class="main-warning" data-bind="click: $parent.ShowinforTon_Dat">
                                                            <i class="fa fa-warning red"></i>
                                                        </div>
                                                        <div class="content-warning" data-bind="attr:{id: 'wr_' + IDRandom }">
                                                            Tồn:&nbsp;<span data-bind="text: TonKho"></span>&nbsp;-&nbsp;
                                                            Đặt:&nbsp;<span data-bind="text: SoLuong"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-price">
                                                    <!--ko if: $root.roleChangePriceProduct()  -->
                                                    <input type="text" class="text-right effect-1" autocomplete="off"
                                                           onkeypress="keypressNumber_limitNumber(event,this)"
                                                           onclick="focustextBox(this)" maxlength="12"
                                                           data-bind="value: formatNumber3Digit(GiaBan,2) , attr:{id: IDRandom},
                                                           event:{keyup: $parent.editPrice}" />
                                                    <!-- /ko-->
                                                    <!-- ko if: !$root.roleChangePriceProduct()-->
                                                    <label class="text-right lbl-input" data-bind="text: formatNumber3Digit(GiaBan)
                                                           attr:{id:IDRandom}"></label>
                                                    <!-- /ko-->
                                                </div>
                                                <div class="list-price">
                                                    <button class="input-simple"
                                                            data-bind="text: formatNumber3Digit(TienChietKhau,2), attr:{id: 'btn_sale_' + IDRandom},
                                                                        click: $parent.showDivSale_CTHD"></button>
                                                    <!--bind callprice_'+ID_DonViQuiDoi used to toggle when enter sale-->
                                                    <div class="callprice" style="display: none; width:300px;right: 0; top:40px"
                                                         data-bind="attr:{id:'callprice_'+IDRandom}">
                                                        <div class="callprice-left" style="width:40%">
                                                            Nhập chiết khấu:
                                                        </div>
                                                        <div class="callprice-right" style="width:60%">
                                                            <input type="text" class=" number-price text-right" maxlength="12"
                                                                   onclick="this.select()"
                                                                   onkeypress="return getNumber(event,this)"
                                                                   data-bind="attr:{id:'pri-g_' + IDRandom}, event:{keyup: $parent.editSale}">

                                                            <div class="toogle toogle-report Ptram"
                                                                 data-bind="attr:{id: 'vnd_'+ IDRandom}">
                                                                <span class="poison" data-bind="click: $parent.clickVND">VNĐ</span>
                                                                <span class="transverse" data-bind="click: $parent.clickVND">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-price" data-bind="click: function (){ $root.showPopChietKhauTong_CTHD($data, false)}">
                                                    <label class="text-right" 
                                                           data-bind="text: formatNumber3Digit(SoLuong * TienChietKhau),
                                                           attr:{id: 'lblckTong_'+ IDRandom},
                                                           "></label>
                                                </div>
                                                <div class="list-totle-price">
                                                    <!--ko if: $root.roleChangePriceProduct() -->
                                                    <input type="text" class="text-right effect-1"
                                                           onkeypress="keypressNumber_limitNumber(event,this)"
                                                           onclick="this.select()" maxlength="12"
                                                           data-bind="value: formatNumber3Digit(ThanhTien,2), attr:{id: 'sum-f_' + IDRandom},
                                                                         event:{keyup: $parent.editSumPrice}" />
                                                    <!--/ko-->
                                                    <!--ko if: !$root.roleChangePriceProduct()-->
                                                    <label class="text-right" data-bind="text: formatNumber3Digit(ThanhTien),
                                                           attr:{id: 'sum-f_'+ IDRandom}"></label>
                                                    <!--/ko-->
                                                </div>
                                            </div>
                                            <div class="op-hoadon-function">
                                                <!--ko if: LoaiHoaDon !== 6 -->
                                                <a href="javascript:void(0)" data-bind="click: $parent.addLot, visible: LoaiHangHoa !==3" class="btn-gray" title="Thêm hàng cùng loại">
                                                    <i class="material-icons md-24 ">add</i>
                                                </a>
                                                <!--/ko-->
                                                <a href="javascript:void(0)" title="Chi tiết chiết khấu nhân viên"
                                                   data-bind="click:function(){$root.showPopupUserDiscount($data, false)} , visible: LoaiHoaDon ==1 || LoaiHoaDon === 2" class="btn-gray">
                                                    <i class="fa fa-user" aria-hidden="true"></i>
                                                </a>
                                                <a href="javascript:void(0)" title="Thay đổi thành phần định lượng"
                                                   data-bind="click: function () {$root.ShowPop_ChangeTPDinhLuong ($data, false)},
                                                     visible: LoaiHangHoa === 3 || (LoaiHangHoa == 2 && (LoaiHoaDon == 1 || LoaiHoaDon == 2))" class="btn-gray">
                                                    <i class="fa fa-list-alt"></i>
                                                </a>
                                                <a href="javascript:void(0)" data-bind="event:{click: $parent.xoaHangHoa}" class="btn-gray" title="Xóa hàng">
                                                    <i class="material-icons md-18" style="color:#B60201;">close</i>
                                                </a>
                                            </div>
                                        </div>
                                        <!--hide GhiChu if QuanLyTheoLo = true & LotParent = true-->
                                        <div class="seach-nhomhang _ghi-chu-nhap-hang _ghi-chu-nhap-hang-no-lo"
                                             data-bind="visible: (QuanLyTheoLoHang !== true && LotParent !== true)">
                                            <a href="javascript:void(0)" class="change-vi-tri "
                                               data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                           css:{'active': ID_ViTri !== null},
                                           click: function(){$root.ChangeViTri_CTHD($data, false)},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')">Chọn vị trí</a>
                                            <div class="room-view-vi-tri"
                                                 data-bind="visible: ID_ViTri !== null && LoaiHoaDon ==1 && (QuanLyTheoLoHang !== true && LotParent !== true)">
                                                <div class="room-position">
                                                    <label>Vị trí</label>
                                                    <div> <span data-bind="text: TenViTri"></span></div>
                                                </div>
                                                <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                    <label>Thời gian</label>
                                                    <div>
                                                        <span class="timeUse" data-bind="text: ThoiGianThucHien +' phút'"></span>
                                                    </div>
                                                </div>
                                                <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                    <label>Giờ bắt đầu</label>
                                                    <div>
                                                        <input type="text" class="time-room"
                                                               data-bind="visible: TimeStart !== 0, value: TimeStart,
                                                       click: function(){$root.ChangeTime_CTHD($data, false)} , event:{keyup: function(){$root.EditTime_CTHD ($data, false)}},
                                                       attr: {id: 'timeFirst_'+ IDRandom}">
                                                        <a href="javascript:void(0)" class="play-start-room" data-bind="visible: TimeStart == 0, click: function(){$root.ClickTimeStart($data, false)} ">
                                                            <i class="fa fa-play" aria-hidden="true"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="room-position overtime" data-bind="visible: QuaThoiGian > 0">
                                                    <label>Quá giờ</label>
                                                    <div>
                                                        <span class="timeOver" data-bind="text: QuaThoiGian + ' phút'"></span>
                                                    </div>
                                                </div>
                                                <div class="room-position" data-bind="visible: LoaiHangHoa == 2 && TimeRemain > 0">
                                                    <label>Còn lại</label>
                                                    <div>
                                                        <span class="timeRemain" data-bind="text: TimeRemain + ' phút'"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div data-bind="visible: HangHoa_KM.length > 0, foreach: HangHoa_KM, attr:{id: 'kmHH_'+ID_DonViQuiDoi }">
                                            <div class="op-hoadon-item">
                                                <div class="op-hoadon-text">
                                                    <div class="op-hoadon-stt" style="border:none"></div>
                                                    <div class="op-hoadon-id">
                                                    </div>
                                                    <div class="op-hoadon-name">
                                                        <div class="flex">
                                                            <div>
                                                                <span data-bind="text: TenHangHoa" class="hdhh-name"></span>
                                                                <span style="color: #ff6a00;vertical-align:top;" data-bind="text: ThuocTinh_GiaTri"></span>
                                                            </div>
                                                            <div data-bind="visible: TenDonViTinh!=='' && TenDonViTinh !==null">
                                                                (
                                                                <span data-bind="text: TenDonViTinh"></span>
                                                                )
                                                            </div>
                                                            <span class="bg-pink">
                                                                (KM)
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="op-hoadon-number">
                                                    <div class="list-number-edit text-center flex flex-center">
                                                        <div class=" input-simple width-80 text-right" data-bind="text: SoLuong">
                                                        </div>
                                                    </div>
                                                    <div class="warning">
                                                    </div>
                                                    <div class="list-price">
                                                        <button class=" text-right input-simple" data-bind="text:formatNumber3Digit(GiaBan)"></button>
                                                    </div>
                                                    <div class="list-price">
                                                        <button class=" text-right input-simple"
                                                                data-bind="text: formatNumber3Digit(TienChietKhau,2)"></button>
                                                    </div>
                                                    <div class="list-totle-price text-right input-simple" style="text-align:right">
                                                        <span data-bind="text: formatNumber3Digit(ThanhTien)"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--bind id= ID_DonViQuiDoi: used hide/show row when getAllHangHoas, update again DM_LoHang-->
                                        <div class="floatleft item-lot item-lothd op-hoadon-item flex flex-column" data-bind="visible: QuanLyTheoLoHang, attr:{id: ID_DonViQuiDoi},style:{ borderBottom: DM_LoHang.length > 1? '1px dotted #ccc':'none'}">
                                            <div class="op-hoadon-stt" style="border-color:transparent"></div>
                                            @*<div class="op-hoadon-id">

                                            </div>*@
                                            <div class="_solo-top  flex flex-column op-hoadon-text">
                                                <div class="import-option-lohang">
                                                    <div class="name-lot1">
                                                        <!--IDRandom: used to check when add Lot (multiple Lot = null)-->
                                                        <span data-bind="attr: {id: IDRandom}" hidden></span>
                                                        <span class="numberlot">Số lô</span>
                                                        <div class="lotsolo">
                                                            <div class="outselect">
                                                                <div class="floatleft " data-toggle="dropdown" aria-expanded="false" style="width:90px">
                                                                    <input type="text" class="form-control"
                                                                           data-bind="value: DM_LoHang.length > 0? DM_LoHang[0].MaLoHang:'',
                                                 click: $root.LoadListLot_ofProduct,
                                                event:{keyup: $root.SearchLot_ofProduct}" placeholder="Số lô" />
                                                                </div>
                                                                <div class="selec-person dropdown-menu divlist-LoHang">
                                                                    <ul data-bind="foreach: $parent.ListLot_ofProduct">
                                                                        <li data-bind="click: $root.ClickChoseLot, attr:{id:ID}">
                                                                            @*<a class="thongtinlo">*@
                                                                            <div class="flex flex-row flex-between">
                                                                                <span data-bind="text: MaLoHang" class="bold"></span>
                                                                                <span>
                                                                                    Tồn: <span class="bold" data-bind="text: formatNumber3Digit(TonKho)"></span>
                                                                                </span>
                                                                            </div>
                                                                            <small class="flex flex-row flex-between">
                                                                                <span data-bind="visible: NgaySanXuat" style="font-style:italic">
                                                                                    NSX:<span style="color:green" data-bind="text: moment(NgaySanXuat).format('DD/MM/YYYY')!='Invalid date'? moment(NgaySanXuat).format('DD/MM/YYYY'):''"></span>
                                                                                </span>
                                                                                <span data-bind="visible: NgayHetHan" style="font-style:italic">
                                                                                    HSD:<span style="color:red" data-bind="text: moment(NgayHetHan).format('DD/MM/YYYY')!='Invalid date'? moment(NgayHetHan).format('DD/MM/YYYY'):''"></span>
                                                                                </span>
                                                                            </small>
                                                                            @*</a>*@
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="name-lot">
                                                        <span>Ngày sx</span>
                                                        <input type="text" class="form-control ngaysx-empty width-80 height-24"
                                                               data-bind="visible: DM_LoHang.length > 0 && (DM_LoHang[0].NgaySanXuat =='' || DM_LoHang[0].NgaySanXuat == null)" placeholder="Ngày SX">
                                                        <div class="date-lot bglot1"
                                                             data-bind="text: DM_LoHang.length > 0? DM_LoHang[0].NgaySanXuat:'', visible: DM_LoHang.length > 0 && DM_LoHang[0].NgaySanXuat !='' && DM_LoHang[0].NgaySanXuat !== null"></div>
                                                    </div>
                                                    <div class="name-lot">
                                                        <span>Hạn sd</span>
                                                        <input type="text" class="form-control exp-empty width-80 height-24"
                                                               data-bind="visible: DM_LoHang.length > 0 && (DM_LoHang[0].NgayHetHan =='' || DM_LoHang[0].NgayHetHan == null)" placeholder="Hạn SD">
                                                        <div class="date-lot bglot2"
                                                             data-bind="text: DM_LoHang.length > 0? DM_LoHang[0].NgayHetHan:'', visible: DM_LoHang.length > 0 && DM_LoHang[0].NgayHetHan !='' && DM_LoHang[0].NgayHetHan !== null"></div>
                                                    </div>
                                                </div>
                                                <div class="op-hoadon-ghichu">
                                                    <input autocomplete="off" type="text" placeholder="Ghi chú.."
                                                           data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,false)}}" required />
                                                    <i class="fa fa-pencil"></i>
                                                </div>
                                            </div>
                                            <div class="seach-nhomhang _ghi-chu-nhap-hang ">
                                                <a href="javascript:void(0)" class="change-vi-tri pull-left"
                                                   data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                               css:{'active': ID_ViTri !== null},
                                           click: function(){$root.ChangeViTri_CTHD($data, false)},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')" style="margin-left: 25px;display:inline-block">Chọn vị trí</a>
                                                <div class="room-view-vi-tri" data-bind="visible: ID_ViTri !== null && LoaiHoaDon ==1">
                                                    <div class="room-position">
                                                        <label>Vị trí</label>
                                                        <div> <span data-bind="text: TenViTri">B3</span></div>
                                                    </div>
                                                    <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                        <label>Thời gian</label>
                                                        <div>
                                                            <span class="timeUse" data-bind="text: ThoiGianThucHien +' phút'">120 phút</span>
                                                        </div>
                                                    </div>
                                                    <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                        <label>Giờ bắt đầu</label>
                                                        <div>
                                                            <input type="text" class="time-room" data-bind="visible: TimeStart !== 0, value: TimeStart,
                                                         @*click: function(){$root.ChangeTime_CTHD($data, false)},*@ attr: { id:'timeParent_' +  IDRandom}">
                                                            <a href="javascript:void(0)" class="play-start-room"
                                                               data-bind="visible: TimeStart == 0, click: function(){$root.ClickTimeStart($data, false)} "><i class="fa fa-play" aria-hidden="true"></i></a>
                                                        </div>
                                                    </div>
                                                    <div class="room-position overtime" data-bind="visible: QuaThoiGian > 0">
                                                        <label>Quá giờ</label>
                                                        <div>
                                                            <span class="timeOver" data-bind="text: QuaThoiGian"></span>
                                                        </div>
                                                    </div>
                                                    <div class="room-position" data-bind="visible: LoaiHangHoa == 2 && TimeRemain > 0">
                                                        <label>Còn lại</label>
                                                        <div>
                                                            <span class="timeRemain" data-bind="text: TimeRemain + ' phút'"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--ko foreach: DM_LoHang-->
                                        <!--ko if: $index() != 0-->
                                        <div class=" item-lot item-lothd item-lothdend op-hoadon-item"
                                             data-bind="attr:{id: ID_DonViQuiDoi}">
                                            <div class="op-hoadon-text">
                                                <div class="op-hoadon-stt" style="border-color:transparent"></div>
                                                @*<div class="op-hoadon-id">
                                                </div>*@
                                                <div class="flex flex-column ">
                                                    <div class="flex flex-row import-option-lohang">
                                                        <div class="name-lot1">
                                                            <!--IDRandom: used to check when add Lot (multiple Lot = null)-->
                                                            <span data-bind="attr: {id: IDRandom}" hidden></span>
                                                            <span class="numberlot">Số lô</span>
                                                            <div class="lotsolo">
                                                                <div class="outselect">
                                                                    <div class="floatleft " data-toggle="dropdown" aria-expanded="false">
                                                                        <input type="text" class="form-control"
                                                                               data-bind="value: MaLoHang, click: $root.LoadListLot_ofProduct,
                                                   event:{keyup: $root.SearchLot_ofProduct}" placeholder="Số lô" />
                                                                    </div>
                                                                    <div class="selec-person dropdown-menu divlist-LoHang">
                                                                        <ul data-bind="foreach: $root.ListLot_ofProduct">
                                                                            <li data-bind="click: $root.ClickChoseLot, attr:{id:ID}">
                                                                                @*<a class="thongtinlo">*@
                                                                                <div class="flex flex-row flex-between">
                                                                                    <span data-bind="text: MaLoHang" class="bold"></span>
                                                                                    <span>
                                                                                        Tồn: <span class="bold" data-bind="text: formatNumber3Digit(TonKho)"></span>
                                                                                    </span>
                                                                                </div>
                                                                                <small class="flex flex-row flex-between">
                                                                                    <span data-bind="visible: NgaySanXuat" style="font-style:italic">
                                                                                        NSX:<span style="color:green" data-bind="text: moment(NgaySanXuat).format('DD/MM/YYYY')!='Invalid date'? moment(NgaySanXuat).format('DD/MM/YYYY'):''"></span>
                                                                                    </span>
                                                                                    <span data-bind="visible: NgayHetHan" style="font-style:italic">
                                                                                        HSD:<span style="color:red" data-bind="text: moment(NgayHetHan).format('DD/MM/YYYY')!='Invalid date'? moment(NgayHetHan).format('DD/MM/YYYY'):''"></span>
                                                                                    </span>
                                                                                </small>
                                                                                @*</a>*@
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="name-lot">
                                                            <span>Ngày sx</span>
                                                            <input type="text" class="form-control ngaysx-empty width-80 height-24"
                                                                   data-bind="visible: NgaySanXuat =='' || NgaySanXuat == null" placeholder="Ngày SX">
                                                            <div class="date-lot bglot1"
                                                                 data-bind="text: NgaySanXuat, visible: NgaySanXuat !=='' && NgaySanXuat !== null"></div>
                                                        </div>
                                                        <div class="name-lot">
                                                            <span>Hạn sd</span>
                                                            <input type="text" class="form-control exp-empty width-80 height-24"
                                                                   data-bind="visible: NgayHetHan =='' || NgayHetHan == null" placeholder="Hạn SD">
                                                            <div class="date-lot bglot2"
                                                                 data-bind="text: NgayHetHan, visible: NgayHetHan !=='' && NgayHetHan !== null"></div>
                                                        </div>
                                                        <div class="name-lot ">
                                                            <a href="javascript:void(0)" class="delete-lot" hidden>
                                                                <i class="fa fa-close  "></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-item-chietkhauNV">
                                                        <p class="p-note" data-bind="text: GhiChu_NVThucHien"></p>
                                                        <p class="p-note" data-bind="text: GhiChu_NVTuVan"></p>
                                                    </div>
                                                    <div class="op-hoadon-ghichu">
                                                        <input autocomplete="off" type="text" placeholder="Ghi chú" required
                                                               data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,false)}}">
                                                        <i class="fa fa-pencil" style="display:inline-block"></i>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="op-hoadon-number">
                                                <div class="list-price input-sl" >
                                                    <div class="list-price input-sl">
                                                        <a href="javascript:void(0)" class="quy-cach-edit-left nopadding btn-gray pull-left">
                                                            <i class="fa fa-pencil-square-o" aria-hidden="true"
                                                               data-bind="click: function() {$root.ShowDivNhapQuyCach ($data,false)},visible:  QuyCach !== 1"></i>
                                                        </a>
                                                        <div class="call-quy-cach pull-left" style="display: none;  top:32px" data-bind="attr: {id: 'call-quy-cach_'+ IDRandom }">
                                                            <div class="callprice-left" style="width:40%">
                                                                Nhập quy cách:
                                                            </div>
                                                            <div class="callprice-right " style="width:60%">
                                                                <input type="text" class="number-price text-right"
                                                                       onkeypress="return keypressNumber(event)" onclick="this.select()"
                                                                       data-bind="event: {keyup: $root.EditQuyCach,
                                                       function:{mouseout: $root.MouseOutQuyCach ($data,false)}}">
                                                            </div>
                                                        </div>
                                                        <a href="javascript:void(0)" class="bill-plus nopadding pull-left" title="Giảm số lượng" data-bind="click: $root.giamSoLuong">
                                                            <i class="fal fa-angle-down"></i>
                                                        </a>
                                                        <div class="input-sl-quy-cach pull-left">
                                                            <input type="text" class=" input-simple" onclick="this.select()"
                                                                   data-bind="value: formatNumber3Digit(SoLuong),
                                           attr:{id:'munber_'+ IDRandom},
                                           event:{keyup: $root.editSoluong}" />
                                                            <span data-bind="attr:{id: 'quycach_'+ IDRandom}, text: formatNumber3Digit(SoLuongQuyCach), visible: SoLuongQuyCach > 0" style="display:block;max-width:85px; text-align:center"></span>
                                                        </div>
                                                        <a href="javascript:void(0)" class="bill-plus bill-plusnext nopadding pull-left" title="Tăng số lượng" data-bind="click:  $root.tangSoLuong">
                                                            <i class="fal fa-angle-up"></i>
                                                        </a>
                                                        <a href="javascript:void(0)" class="quy-cach-edit-right col-md-1 nopadding pull-right" style="display:none">
                                                            <i class="fa fa-warning"></i>
                                                        </a>
                                                    </div>
                                                    <div class="bill-returns" data-bind="text: '/' + formatNumber3Digit(SoLuongDaMua), visible: SoLuongDaMua > 0">
                                                    </div>
                                                    <div class="bill-returns" data-bind="text: '/' + formatNumber3Digit(SoLuongConLai), visible: ChatLieu ==='4'">
                                                    </div>
                                                </div>
                                                <div class="warning" data-bind=" visible: CssWarning">
                                                    <i class="fa fa-warning red"
                                                       data-bind="attr:{id: 'show_wr_'+ IDRandom},
                                       click: $root.ShowinforTon_Dat">
                                                    </i>
                                                    <div class="content-warning" data-bind="attr:{id: 'wr_'+IDRandom }">
                                                        Tồn:&nbsp;<span data-bind="text: TonKho"></span>&nbsp;-&nbsp;
                                                        Đặt:&nbsp;<span data-bind="text: SoLuong"></span>
                                                    </div>
                                                </div>
                                                <div class="list-price">
                                                    <!-- ko if: $root.roleChangePriceProduct() -->
                                                    <input class="price-fist price-fist2" onclick="this.select()"
                                                           data-bind="value: formatNumber3Digit(GiaBan,2), attr:{id: IDRandom}, event:{keyup: $root.editPrice}" />
                                                    <!-- /ko-->
                                                    <!-- ko if: !$root.roleChangePriceProduct()-->
                                                    <label class="price-fist price-fist2" data-bind="text: formatNumber3Digit(GiaBan),
                                                           attr:{id: IDRandom}"></label>
                                                    <!-- /ko-->
                                                </div>
                                                <div class="list-price">
                                                    <button class="input-simple"
                                                            data-bind="text: formatNumber3Digit(TienChietKhau,2),
                                            attr:{id: 'btn_sale_'+ IDRandom},
                                            click: $root.showDivSale_CTHD"></button>
                                                    <div class="callprice" style="display: none; width:300px;right: -19%; top:32px"
                                                         data-bind="attr:{id:'callpriceTH_'+ IDRandom}">
                                                        <div class="callprice-left" style="width:40%">
                                                            Nhập chiết khấu:
                                                        </div>
                                                        <div class="callprice-right" style="width:60%">
                                                            <input type="text" class=" number-price text-right" maxlength="12"
                                                                   onclick="this.select()"
                                                                   onkeypress="return getNumber(event,this)"
                                                                   data-bind="attr:{id:'pri-g_' + IDRandom},
                                                   event:{keyup: $root.editSale}">
                                                            <div class="toogle toogle-report Ptram"
                                                                 data-bind="attr:{id: 'vnd_' + IDRandom}">
                                                                <span class="poison" data-bind="click: $root.clickVND">VNĐ</span>
                                                                <span class="transverse" data-bind="click:  $root.clickVND">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-price" data-bind="click: function (){ $root.showPopChietKhauTong_CTHD($data, false)}">
                                                    <label data-bind="text: formatNumber3Digit(SoLuong * TienChietKhau),
                                                           attr:{id: 'lblckTong_' + IDRandom}"></label>
                                                </div>
                                                <div class="list-totle-price">
                                                    <!-- ko if: $root.roleChangePriceProduct() -->
                                                    <input type="text" class="text-right effect-1"
                                                           onkeypress="keypressNumber_limitNumber(event,this)"
                                                           onclick="this.select()" maxlength="12"
                                                           data-bind="value: formatNumber3Digit(ThanhTien,2), attr:{id: 'sum-f_' + IDRandom},
                                                                       event:{keyup: $root.editSumPrice}" />
                                                    <!-- /ko-->
                                                    <!-- ko if: !$root.roleChangePriceProduct()-->
                                                    <label data-bind="text: formatNumber3Digit(ThanhTien), attr:{id: 'sum-f_' + IDRandom}"></label>
                                                    <!-- /ko-->
                                                </div>
                                            </div>
                                            <div class="op-hoadon-function">
                                                <button data-bind="click: $root.addLot, visible: LoaiHangHoa !==3" title="Thêm hàng cùng loại">
                                                    <i class="material-icons ">add</i>
                                                </button>
                                                <button title="Chi tiết chiết khấu nhân viên"
                                                        data-bind="click:function(){$root.showPopupUserDiscount($data, false)} , visible: LoaiHoaDon ==1 || LoaiHoaDon === 2" class="btn-gray">
                                                    <i class="fa fa-user" aria-hidden="true"></i>
                                                </button>
                                                <!--DMLo: not change TPDinhLuong-->
                                                <button data-bind="event:{click: $root.xoaHangHoa}" class="btn-gray" title="Xóa hàng">
                                                    <i class="material-icons md-18" style="color:#B60201;">close</i>
                                                </button>
                                            </div>
                                            <div class="seach-nhomhang _ghi-chu-nhap-hang ">
                                                <a href="javascript:void(0)" class="change-vi-tri"
                                                   data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                               css:{'active': ID_ViTri !== null},
                                           click: function(){$root.ChangeViTri_CTHD($data, false)},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')" style="margin-left:25px">Chọn vị trí</a>
                                                <div class="room-view-vi-tri" data-bind="visible: ID_ViTri !== null && LoaiHoaDon ==1">
                                                    <div class="room-position">
                                                        <label>Vị trí</label>
                                                        <div> <span data-bind="text: TenViTri"> B3</span></div>
                                                    </div>
                                                    <!--don't need bind Time for LoHang, beacause only DichVu have ThoiGianThucHien -->
                                                </div>
                                            </div>
                                        </div>
                                        <!--/ko-->
                                        <!--/ko-->
                                    </li>
                                    <!--ko foreach: HangCungLoais-->
                                    <li data-bind="css:$index()%2!==0?'li-info':''" class="li-show li-sub" style=" padding-left:0">
                                        <div class="op-hoadon-item ">
                                            <div class="op-hoadon-text" onclick="push30(this)">
                                                <div class="op-hoadon-stt" style="border-color:transparent"></div>
                                                <div class="op-hoadon-id">
                                                    <span data-bind="text: commonStatisJs.SubStringContent(MaHangHoa,13)"></span>
                                                </div>
                                                <div class="op-hoadon-name">
                                                    <div class="">
                                                        <div class="op-hoadon-productname" data-bind="style: { width: ( TenDonViTinh=='' || TenDonViTinh ==null)? '100%' : 'calc(100% - 75px)' }">
                                                            <label data-bind="text: TenHangHoa,  attr:{title: TenHangHoa}" class="hdhh-name"></label>
                                                        </div>
                                                        <div class="dropdown " data-bind="visible: TenDonViTinh!=='' && TenDonViTinh !==null">
                                                            <button class=" btn btn-link" type="button" data-toggle="dropdown" aria-expanded="true">
                                                                <span class="notshow" data-bind="text: TenDonViTinh"></span>
                                                                <i class="fal fa-angle-down notshow" aria-hidden="true" data-bind="style: { opacity:  ListDonViTinh.length > 1 ? 1 : 0 }"></i>
                                                            </button>
                                                            <ul class="dropdown-menu right-0" data-bind="foreach: ListDonViTinh, visible: LaConCungLoai == false">
                                                                <li data-bind="click: function (){ $root.ChangeDVT_HangHoa($data, $parent, false)} ,
                                                        css: {focusLot: ID_DonViQuiDoi == $parent.ID_DonViQuiDoi}">
                                                                    <a data-bind="text: TenDonViTinh"></a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-item-chietkhauNV">
                                                        <p class="p-note" data-bind="text: GhiChu_NVThucHien"></p>
                                                        <p class="p-note" data-bind="text: GhiChu_NVTuVan"></p>
                                                    </div>
                                                    <div class="op-hoadon-ghichu">
                                                        <input autocomplete="off" type="text" placeholder="Ghi chú"
                                                               data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,false)}}">
                                                        <i class="fa fa-pencil" style="display:inline-block"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="op-hoadon-number">
                                                <div class="list-price input-sl">
                                                    <div class="list-price input-sl">
                                                        <a href="javascript:void(0)" class="quy-cach-edit-left btn-gray">
                                                            <i class="fa fa-pencil-square-o" aria-hidden="true"
                                                               data-bind="click: function() {$root.ShowDivNhapQuyCach ($data,false)}, visible: QuyCach !== 1"></i>
                                                        </a>
                                                        <div class="call-quy-cach" style="display: none;  top:32px" data-bind="attr: {id: 'call-quy-cach_'+ IDRandom }">
                                                            <div class="callprice-left" style="width:40%">
                                                                Nhập quy cách:
                                                            </div>
                                                            <div class="callprice-right " style="width:60%">
                                                                <input type="text" class="number-price text-right"
                                                                       onkeypress="return keypressNumber(event)" onclick="this.select()"
                                                                       data-bind="event: {keyup: $root.EditQuyCach,
                                                           function:{mouseout: $root.MouseOutQuyCach ($data,false)}}">
                                                            </div>
                                                        </div>
                                                        <a href="javascript:void(0)" class="bill-plus" title="Giảm số lượng"
                                                           data-bind="event:{click: $root.giamSoLuong }" style="width:20px">
                                                            <i class="fal fa-angle-down"></i>
                                                        </a>
                                                        <div class="input-sl-quy-cach">
                                                            <input type="text" class=" input-simple" maxlength="9" autocomplete="off" 
                                                                   data-bind="value: formatNumber3Digit(SoLuong), attr:{id:'munber_' + IDRandom},
                                                   event:{keyup: $root.editSoluong }"
                                                                   onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()">
                                                            <span data-bind="attr:{id: 'quycach_'+ IDRandom}, visible: SoLuongQuyCach > 0,
                                                 text: formatNumber3Digit(SoLuongQuyCach) " style="display:block; max-width:85px; text-align:center"></span>
                                                        </div>
                                                        <a href="javascript:void(0)" class="bill-plus bill-plusnext" title="Tăng số lượng"
                                                           data-bind="event:{click: $root.tangSoLuong }" style="width:20px">
                                                            <i class="fal fa-angle-up"></i>
                                                        </a>
                                                        <a href="javascript:void(0)" class="quy-cach-edit-right" title="Số lượng sản phẩm quá nhỏ" style="display:none"
                                                           data-bind="attr:{id: 'WrQuycach_' + IDRandom}">
                                                            <i class="fa fa-warning"></i>
                                                        </a>
                                                    </div>
                                                    <div class="bill-returns" data-bind="text: '/' + formatNumber3Digit(SoLuongDaMua), visible: SoLuongDaMua > 0">
                                                    </div>
                                                    <div class="bill-returns" data-bind="text: '/' + formatNumber3Digit(SoLuongConLai), visible: ChatLieu ==='4'">
                                                    </div>
                                                </div>
                                                <div class="warning" data-bind=" visible: CssWarning">
                                                    <div class="floatleft"
                                                         data-bind="attr:{id: 'show_wr_'+ IDRandom} ">
                                                        <div class="main-warning" data-bind="click: $root.ShowinforTon_Dat">
                                                            <i class="fa fa-warning red"></i>
                                                        </div>
                                                        <div class="content-warning" data-bind="attr:{id: 'wr_' + IDRandom }">
                                                            Tồn:&nbsp;<span data-bind="text: TonKho"></span>&nbsp;-&nbsp;
                                                            Đặt:&nbsp;<span data-bind="text: SoLuong"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-price">
                                                    <!--ko if: $root.roleChangePriceProduct()-->
                                                    <input type="text" class="text-right effect-1" autocomplete="off" title="Giá bán"
                                                           onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                                           data-bind="value: formatNumber3Digit(GiaBan,2) , attr:{id: IDRandom},
                                                           event:{keyup: $root.editPrice}" />
                                                    <!-- /ko-->
                                                    <!-- ko if: !$root.roleChangePriceProduct()-->
                                                    <label class="text-right lbl-input" data-bind="text: formatNumber3Digit(GiaBan),
                                                           attr:{id: IDRandom}"></label>
                                                    <!-- /ko-->
                                                </div>
                                                <div class="list-price">
                                                    <button class="input-simple" data-bind=" attr:{id: 'btn_sale_' + IDRandom}, click: $root.showDivSale_CTHD" title="Chiết khấu">
                                                        <span data-bind="text: formatNumber3Digit(TienChietKhau,2)"></span>
                                                    </button>
                                                    <!--bind callprice_'+ID_DonViQuiDoi used to toggle when enter sale-->
                                                    <div class="callprice" style="display: none; width:300px;right: -19%; top:32px"
                                                         data-bind="attr:{id:'callprice_'+IDRandom}">
                                                        <div class="callprice-left" style="width:40%">
                                                            Nhập chiết khấu:
                                                        </div>
                                                        <div class="callprice-right" style="width:60%">
                                                            <input type="text" class=" number-price text-right" maxlength="12"
                                                                   onclick="this.select()"
                                                                   onkeypress="return getNumber(event,this)"
                                                                   data-bind="attr:{id:'pri-g_' + IDRandom}, event:{keyup: $root.editSale}">
                                                            <div class="toogle toogle-report Ptram"
                                                                 data-bind="attr:{id: 'vnd_'+ IDRandom}">
                                                                <span class="poison" data-bind="click: $root.clickVND">VNĐ</span>
                                                                <span class="transverse" data-bind="click: $root.clickVND">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-price" data-bind="click: function (){ $root.showPopChietKhauTong_CTHD($data, false)}">
                                                    <label class="text-right"
                                                           data-bind="text: formatNumber3Digit(SoLuong * TienChietKhau),
                                                           attr:{id: 'lblckTong_'+ IDRandom}"></label>
                                                </div>
                                                <div class="list-totle-price">
                                                    <!--ko if: $root.roleChangePriceProduct()-->
                                                    <input type="text" class="text-right effect-1"
                                                           onkeypress="keypressNumber_limitNumber(event,this)"
                                                           onclick="this.select()" maxlength="12"
                                                           data-bind="value: formatNumber3Digit(ThanhTien,2), attr:{id: 'sum-f_' + IDRandom},
                                                                         event:{keyup: $root.editSumPrice}," />
                                                    <!--/ko-->
                                                    <!--ko if: !$root.roleChangePriceProduct()-->
                                                    <label class="text-right" data-bind="text: formatNumber3Digit(ThanhTien),
                                                           attr:{id: 'sum-f_'+ IDRandom}"></label>
                                                    <!--/ko-->
                                                </div>
                                            </div>
                                            <div class="op-hoadon-function">
                                                <button data-bind="click: $root.addLot, visible: LoaiHangHoa !==3" class="btn-gray" title="Thêm hàng cùng loại">
                                                    <i class="material-icons ">add</i>
                                                </button>
                                                <button title="Chi tiết chiết khấu nhân viên"
                                                        data-bind="click:function(){$root.showPopupUserDiscount($data, false)} , visible: LoaiHoaDon ==1 || LoaiHoaDon === 2" class="btn-gray">
                                                    <i class="fa fa-user" aria-hidden="true"></i>
                                                </button>
                                                <button title="Thay đổi thành phần định lượng"
                                                        data-bind="click: function () {$root.ShowPop_ChangeTPDinhLuong ($data, false)},
                                                             visible: LoaiHangHoa === 3 || (LoaiHangHoa == 2 && (LoaiHoaDon == 1 || LoaiHoaDon == 2))" class="btn-gray">
                                                    <i class="fa fa-list-alt"></i>
                                                </button>
                                                <button data-bind="event:{click: $root.xoaHangHoa}" class="btn-gray" title="Xóa hàng">
                                                    <i class="material-icons md-18" style="color:#B60201;">close                                                    </i>
                                                </button>
                                            </div>
                                        </div>
                                        <!--hide GhiChu if QuanLyTheoLo = true & LotParent = true-->
                                        <div class="op-banle-item-vitri"
                                             data-bind="visible: (QuanLyTheoLoHang === false && LotParent === false)">
                                            <a href="javascript:void(0)" class="change-vi-tri "
                                               data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                           css:{'active': ID_ViTri !== null},
                                           click: function(){$root.ChangeViTri_CTHD($data, false)},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')">Chọn vị trí</a>
                                            <div class="room-view-vi-tri"
                                                 data-bind="visible: ID_ViTri !== null && LoaiHoaDon ==1 && (QuanLyTheoLoHang === false && LotParent === false)">
                                                <div class="room-position">
                                                    <label>Vị trí</label>
                                                    <div> <span data-bind="text: TenViTri"></span></div>
                                                </div>
                                                <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                    <label>Thời gian</label>
                                                    <div>
                                                        <span class="timeUse" data-bind="text: ThoiGianThucHien +' phút'"></span>
                                                    </div>
                                                </div>
                                                <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                    <label>Giờ bắt đầu</label>
                                                    <div>
                                                        <input type="text" class="time-room"
                                                               data-bind="visible: TimeStart !== 0, value: TimeStart,
                                                       click: function(){$root.ChangeTime_CTHD($data, false)} , event:{keyup: function(){$root.EditTime_CTHD ($data, false)}},
                                                       attr: {id:'timeCungLoai_' + IDRandom}">
                                                        <a href="javascript:void(0)" class="play-start-room" data-bind="visible: TimeStart == 0, click: function(){$root.ClickTimeStart($data, false)} ">
                                                            <i class="fa fa-play" aria-hidden="true"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="room-position overtime" data-bind="visible: QuaThoiGian > 0">
                                                    <label>Quá giờ</label>
                                                    <div>
                                                        <span class="timeOver" data-bind="text: QuaThoiGian + ' phút'"></span>
                                                    </div>
                                                </div>
                                                <div class="room-position" data-bind="visible: LoaiHangHoa == 2 && TimeRemain > 0">
                                                    <label>Còn lại</label>
                                                    <div>
                                                        <span class="timeRemain" data-bind="text: TimeRemain + ' phút'"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <!--/ko-->
                                    <!--ko foreach: ThanhPhanComBo-->
                                    <li data-bind="css:$index()%2!==0?'li-info':'',
                                        visible: LoaiHoaDon !==6"
                                        class="li-show li-sub" style=" padding-left:0">
                                        <div class="op-hoadon-item ">
                                            <div class="op-hoadon-text">
                                                <div class="op-hoadon-stt" style="border-color:transparent"></div>
                                                <div class="op-hoadon-id">
                                                    <span data-bind="text: commonStatisJs.SubStringContent(MaHangHoa,13)"></span>
                                                </div>
                                                <div class="op-hoadon-name">
                                                    <div class="">
                                                        <div class="op-hoadon-productname" data-bind="style: { width: ( TenDonViTinh=='' || TenDonViTinh ==null)? '100%' : 'calc(100% - 75px)' }">
                                                            <label data-bind="text: TenHangHoa,  attr:{title: TenHangHoa}" class="hdhh-name"></label>
                                                        </div>
                                                        <div class="dropdown " data-bind="visible: TenDonViTinh!=='' && TenDonViTinh !==null">
                                                            <button class=" btn btn-link" type="button" data-toggle="dropdown" aria-expanded="true">
                                                                <span class="notshow" data-bind="text: TenDonViTinh"></span>
                                                                <i class="fal fa-angle-down notshow" aria-hidden="true" data-bind="style: { opacity:  ListDonViTinh.length > 1 ? 1 : 0 }"></i>
                                                            </button>
                                                            <ul class="dropdown-menu right-0" data-bind="foreach: ListDonViTinh, visible: LaConCungLoai == false">
                                                                <li data-bind="click: function (){ $root.ChangeDVT_HangHoa($data, $parent, false)} ,
                                                        css: {focusLot: ID_DonViQuiDoi == $parent.ID_DonViQuiDoi}">
                                                                    <a data-bind="text: TenDonViTinh"></a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-item-chietkhauNV">
                                                        <p class="p-note" data-bind="text: GhiChu_NVThucHien"></p>
                                                        <p class="p-note" data-bind="text: GhiChu_NVTuVan"></p>
                                                    </div>
                                                    <div class="op-hoadon-ghichu">
                                                        <input autocomplete="off" type="text" placeholder="Ghi chú"
                                                               data-bind="value: GhiChu, event:{keyup: function(){$root.Combo_UpdateGhiChu ($data,$parent,false)}}">
                                                        <i class="fa fa-pencil" style="display:inline-block"></i>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="op-hoadon-number">
                                                <div class="list-price input-sl">
                                                    <div class="list-price input-sl">
                                                        <a href="javascript:void(0)" class="bill-plus" title="Giảm số lượng"
                                                           data-bind="click: function(){$root.Combo_giamSoLuong($data,$parent,false)}" style="width:20px">
                                                            <i class="fal fa-angle-down"></i>
                                                        </a>
                                                        <div class="input-sl-quy-cach">
                                                            <input type="text" class=" input-simple" maxlength="9" autocomplete="off" 
                                                                   data-bind="value: formatNumber3Digit(SoLuong),
                                                                   attr:{id:'munber_' + IDRandom},
                                                                     event:{keyup: function(){$root.Combo_editSoluong($data,$parent,false)}}"
                                                                   onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()">
                                                        </div>
                                                        <a href="javascript:void(0)" class="bill-plus bill-plusnext" title="Tăng số lượng"
                                                           data-bind="click: function(){$root.Combo_tangSoLuong($data,$parent,false)}" style="width:20px">
                                                            <i class="fal fa-angle-up"></i>
                                                        </a>

                                                    </div>
                                                    <div class="bill-returns" data-bind="text: '/' + formatNumber3Digit(SoLuongDaMua), visible: SoLuongDaMua > 0">
                                                    </div>
                                                    <div class="bill-returns" data-bind="text: '/' + formatNumber3Digit(SoLuongConLai), visible: ChatLieu ==='4'">
                                                    </div>
                                                </div>
                                                <div class="warning" data-bind=" visible: CssWarning">
                                                    <div class="floatleft"
                                                         data-bind="attr:{id: 'show_wr_'+ IDRandom} ">
                                                        <div class="main-warning">
                                                            <i class="fa fa-warning red"></i>
                                                        </div>
                                                        <div class="content-warning" data-bind="attr:{id: 'wr_' + IDRandom }">
                                                            Tồn:&nbsp;<span data-bind="text: TonKho"></span>&nbsp;-&nbsp;
                                                            Đặt:&nbsp;<span data-bind="text: SoLuong"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-price">
                                                    <!--ko if: $root.roleChangePriceProduct() -->
                                                    <input type="text" class="text-right effect-1" autocomplete="off" title="Giá bán"
                                                           onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                                           data-bind="value: formatNumber3Digit(GiaBan,2) , attr:{id: IDRandom},
                                                           event:{keyup: function(){$root.Combo_editPrice($data,$parent,false)}}" />
                                                    <!-- /ko-->
                                                    <!-- ko if: !$root.roleChangePriceProduct()-->
                                                    <label class="text-right lbl-input" data-bind="text: formatNumber3Digit(GiaBan),
                                                           attr:{id: IDRandom}"></label>
                                                    <!-- /ko-->
                                                </div>
                                                <div class="list-price">
                                                    <button class="input-simple"
                                                            data-bind=" attr:{id: 'btn_sale_' + IDRandom},
                                                            click: function(){ $root.Combo_ShowDivSale ($data,$parent,false )}" title="Chiết khấu">
                                                        <span data-bind="text: formatNumber3Digit(TienChietKhau,2)"></span>
                                                    </button>
                                                    <!--bind callprice_'+ID_DonViQuiDoi used to toggle when enter sale-->
                                                    <div class="callprice" style="display: none; width:300px;right: -19%; top:32px"
                                                         data-bind="attr:{id:'callprice_'+IDRandom}">
                                                        <div class="callprice-left" style="width:40%">
                                                            Nhập chiết khấu:
                                                        </div>
                                                        <div class="callprice-right" style="width:60%">
                                                            <input type="text" class=" number-price text-right" maxlength="12"
                                                                   onclick="this.select()"
                                                                   onkeypress="return getNumber(event,this)"
                                                                   data-bind="attr:{id:'pri-g_' + IDRandom},
                                                                   event:{keyup: function(){$root.Combo_editSale($data, $parent,false)}}">
                                                            <div class="toogle toogle-report Ptram"
                                                                 data-bind="attr:{id: 'vnd_'+ IDRandom}">
                                                                <span class="poison" data-bind="click: function(){$root.Combo_clickVND($data, $parent,false)}">VNĐ</span>
                                                                <span class="transverse" data-bind="click: function(){$root.Combo_clickVND($data, $parent,false)}">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-price">
                                                    <label class="text-right" data-bind="text: formatNumber3Digit(SoLuong * TienChietKhau),
                                                           attr:{id: 'lblckTong_'+ IDRandom}"></label>
                                                </div>
                                                <div class="list-totle-price">
                                                    <!--ko if: $root.roleChangePriceProduct()-->
                                                    <input type="text" class="text-right effect-1"
                                                           onkeypress="keypressNumber_limitNumber(event,this)"
                                                           onclick="this.select()" maxlength="12"
                                                           data-bind="value: formatNumber3Digit(ThanhTien,2), attr:{id: 'sum-f_' + IDRandom},
                                                                         event:{keyup: function(){$root.Combo_editSumPrice($data,$parent,false)}}, " />
                                                    <!--/ko-->
                                                    <!--ko if: !$root.roleChangePriceProduct()-->
                                                    <label class="text-right" data-bind="text: formatNumber3Digit(ThanhTien),
                                                           attr:{id: 'sum-f_'+ IDRandom}"></label>
                                                    <!--/ko-->
                                                </div>
                                            </div>
                                            <div class="op-hoadon-function">
                                                <button title="Chi tiết chiết khấu nhân viên"
                                                        data-bind="click:function(){$root.Combo_showPopupUserDiscount($data, $parent,false)}  ,
                                                        visible: LoaiHoaDon ==1  || LoaiHoaDon === 2" class="btn-gray">
                                                    <i class="fa fa-user" aria-hidden="true"></i>
                                                </button>
                                                <button title="Thay đổi thành phần định lượng"
                                                        data-bind="click: function(){ $root.Combo_ShowPopChangeTPDinhLuong ($data,$parent,false )},
                                                            visible: LoaiHangHoa ==3 || (LoaiHangHoa == 2 && LoaiHoaDon === 1) " class="btn-gray">
                                                    <i class="fa fa-list-alt"></i>
                                                </button>
                                                <button data-bind="click: function(){$root.Combo_xoaHangHoa($data, $parent,false)}" class="btn-gray" title="Xóa hàng">
                                                    <i class="material-icons md-18" style="color:#B60201;">close                                                    </i>
                                                </button>
                                            </div>
                                        </div>
                                        <!--hide GhiChu if QuanLyTheoLo = true & LotParent = true-->
                                        <div class="op-banle-item-vitri"
                                             data-bind="visible: (QuanLyTheoLoHang === false && LotParent === false)">
                                            <a href="javascript:void(0)" class="change-vi-tri "
                                               data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                           css:{'active': ID_ViTri !== null},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')">Chọn vị trí</a>
                                            <div class="room-view-vi-tri"
                                                 data-bind="visible: ID_ViTri !== null && LoaiHoaDon ==1 && (QuanLyTheoLoHang === false && LotParent === false)">
                                                <div class="room-position">
                                                    <label>Vị trí</label>
                                                    <div> <span data-bind="text: TenViTri"></span></div>
                                                </div>
                                                <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                    <label>Thời gian</label>
                                                    <div>
                                                        <span class="timeUse" data-bind="text: ThoiGianThucHien +' phút'"></span>
                                                    </div>
                                                </div>
                                                <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                    <label>Giờ bắt đầu</label>
                                                    <div>
                                                        <input type="text" class="time-room">
                                                        <a href="javascript:void(0)" class="play-start-room">
                                                            <i class="fa fa-play" aria-hidden="true"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="room-position overtime" data-bind="visible: QuaThoiGian > 0">
                                                    <label>Quá giờ</label>
                                                    <div>
                                                        <span class="timeOver" data-bind="text: QuaThoiGian + ' phút'"></span>
                                                    </div>
                                                </div>
                                                <div class="room-position" data-bind="visible: LoaiHangHoa == 2 && TimeRemain > 0">
                                                    <label>Còn lại</label>
                                                    <div>
                                                        <span class="timeRemain" data-bind="text: TimeRemain + ' phút'"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <!--/ko-->
                                </ul>
                                <div class="title-kmhd floatleft" data-bind="visible: HoaDons().ID_KhuyenMai() !== undefined && HoaDons().ID_KhuyenMai()!==null">
                                    Khuyến mại hóa đơn <i class="fa fa-gift bg-pink" data-bind="click: GetListKM_HoaDon"></i>
                                </div>
                                <div class="title-kmhd floatleft" data-bind="visible: HoaDons().KhuyenMai_GhiChu() !=='' && HoaDons().ID_KhuyenMai() !== undefined && HoaDons().ID_KhuyenMai()!==null">
                                    <h5 class="blue" id="lblGhiChuKMHD" data-bind="text:  HoaDons().KhuyenMai_GhiChu()"></h5>
                                </div>
                                <ul class="kmhd" data-bind="foreach: HHTang_HoaDon, visible: HHTang_HoaDon().length > 0">
                                    <li data-bind="">
                                        <div class="floatleft">
                                            <div class="hoadon-stt"></div>
                                            <div class="op-hoadon-id" data-bind="text:MaHangHoa">HH00036</div>
                                            <div class="inner-listchoose ">
                                                <div class="floatleft ">
                                                    <div class="list-nameproduct">
                                                        <div class="floatleft ">
                                                            <div class="op-hoadon-productname">
                                                                <span data-bind="text:TenHangHoa" class="hdhh-name"></span>
                                                                <span style="color: #ff6a00;vertical-align:top;" data-bind="text: ThuocTinh_GiaTri"></span>
                                                            </div>
                                                            <em style="display: none;">
                                                                <a>
                                                                    <span>&nbsp;(</span>
                                                                    <span></span>
                                                                    <span>)</span>
                                                                </a>
                                                            </em>
                                                            <span class="bg-pink">
                                                                (KM)
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <div class="list-munber-edit text-right" data-bind="text:SoLuong">1</div>
                                                    <div class="warning">
                                                    </div>
                                                    <div class="list-price">
                                                        <div class="floatleft text-right">
                                                            <button class="price-fist price-fist2" data-bind="text: formatNumber3Digit(GiaBan)" title="Giá bán"></button>
                                                        </div>
                                                    </div>
                                                    <div class="list-price">
                                                        <div class="floatleft text-right">
                                                            <button class="input-simple" title="CHiết khấu"
                                                                    data-bind="text: formatNumber3Digit(TienChietKhau,2)"></button>
                                                        </div>
                                                    </div>
                                                    <div class="list-totle-price">
                                                        <span data-bind="text: formatNumber3Digit(ThanhTien)"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            <div hidden id="backgroud_black"></div>
                            <div class="slide-goods slide-goods1" id="HangHoaView" data-bind="visible: HoaDons().LoaiHoaDon() !== 6">
                                <div class="main-slide floatleft" id="divSort_NextHH" hidden>
                                    <a class="btn-link hidechonhanghoa" onclick="hideview()" hidden style="color:#686868"> <i class="material-icons" style="font-size:24px">arrow_back_ios</i></a>
                                    <div class="main-slideleft">
                                        <a data-bind="click: SortProduct" title="Thay đổi thứ tự hàng hóa">
                                            <i class="fas fa-sort-alpha-down"></i>
                                        </a>
                                        <a data-bind="click: ShowListNhomHH">
                                            <i class="fal fa-copy"></i>
                                        </a>
                                    </div>
                                    <div id="lstNhomHHChosed">
                                        <ul data-bind="foreach: NhomHHChosed">
                                            <li>
                                                <span data-bind="text: text"></span>
                                                <span>
                                                    <i class="fa fa-times" data-bind="click: $parent.RemoveChoseNhomHH"></i>
                                                </span>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="main-slideright">
                                        <div>
                                            <a href="javascript:void(0)" class="next-page" title="Trang trước" data-bind="click: previous, visible: hasPrevious">
                                                <i class="material-icons">chevron_left</i>
                                            </a>
                                            <span data-bind="text: currentPage() + 1 +'/'+ (PageCount() + 1)" style="letter-spacing:2px">
                                            </span>
                                            <a href="javascript:void(0)" title="Trang sau" data-bind="click: next, visible: hasNext" class="next-page">
                                                <i class="material-icons">chevron_right</i>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="up-slide" data-bind="click: $root.UpDown_FullProduct">
                                        <a class="dow-sli">
                                            <i class="fal fa-angle-down"></i>
                                        </a>
                                        <a class="up1-sli">
                                            <i class="fal fa-angle-up"></i>
                                        </a>
                                    </div>
                                </div>
                                <div class="slide-bill">
                                    <div class="bill-listmenu floatleft">
                                        <ul class="floatleft" data-bind="foreach: PageResults">
                                            <li data-bind=" click: $parent.addHangHoa, attr: {id: ID_DonViQuiDoi},css: CssImg" class="items_HH" tabindex="-1">
                                                <div class="img-bill">
                                                    <a href="javascript:void(0)">
                                                        <img data-bind="attr:{src: SrcImage ==null || SrcImage == '' ?'/Content/images/iconbepp18.9/gg-37.png': Open24FileManager.hostUrl + SrcImage}" alt="Ảnh hàng hóa">
                                                    </a>
                                                </div>
                                                <div class="group-quantity-serrvice" data-bind="visible: SoGoiDV > 0">
                                                    <label data-bind="text: SoGoiDV +' gói'"></label>
                                                </div>
                                                <div class="group-detail-serrvice" hidden>
                                                    <p class="title-p"> Gói đã mua</p>
                                                    <p>Số lượng: 10</p>
                                                    <p>Đã dùng: 5</p>
                                                </div>
                                                <div class="name-bill-hh ">
                                                    <a href="javascript:void(0)" data-bind="html: formatNumber3Digit(GiaBan)+' Đ'"></a>
                                                </div>
                                                <div class="name-menu " @*data-bind="style:{background: BackgroundColor}"*@ style="background:var(--color-primary)">
                                                    <div class="floatleft">
                                                        <a href="javascript:void(0)" data-bind="html: TenHangHoa"></a>
                                                        <span style="color:#fcf4f4" data-bind="text: ThuocTinh_GiaTri"></span>
                                                        <em data-bind="visible: TenDonViTinh!=='' && TenDonViTinh !==null">
                                                            <a style="color:white!important">
                                                                <span>&nbsp;&#40;</span>
                                                                <span data-bind="text: TenDonViTinh"></span>
                                                                <span>&#41;</span>
                                                            </a>
                                                        </em>
                                                        <span style="color:white" data-bind="text: MaLoHang==''?'':'(Lô: '+ MaLoHang +')', visible: MaLoHang"></span>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <!-- Start: Tra Hang-->
                            <div class="slide-goods slide-goods2" id="TraHangView"
                                 data-bind="visible: HoaDons().LoaiHoaDon() === 6 && $root.CountDoiTra() < 6 && HoaDons().IsTraGDV() == true">
                                <div class="seach-product floatleft">
                                    <a id="m_hideviewTH" onclick="hideviewTH()" style="    height: 30px;   display: inline-block;    text-align: center;    padding: 3px;"><i class="material-icons">arrow_back_ios</i></a>
                                    <div class="seach-productinput" id="divSearchTH">
                                        <input type="text" id="txtSearchDoiTra" autocomplete="off"
                                               v-model="query_TH" v-on:keyup="submit" onfocusout="HideLostFocust()" placeholder="Tìm hàng đổi (F7)">
                                        <i class="fa fa-search"></i>
                                        <div id="showseach_TH" hidden>
                                            <ul>
                                                <li v-for="item of SearchTraHang" v-on:click="click(item)" v-bind:id="item.ID_DonViQuiDoi +'_'+ item.ID_LoHang">
                                                    <a>
                                                        <span class="tit-seach">{{ item.TenHangHoa }}</span>
                                                        <i>
                                                            <span style="color:#ff6a00">{{item.ThuocTinh_GiaTri}}</span>
                                                            <span>{{ item.TenDonViTinh }}</span>
                                                        </i><br />
                                                        <span style="color: #c4814e" v-if="item.MaLoHang">
                                                            Lô: <span class="bold">{{ item.MaLoHang }}</span>
                                                            <span>
                                                                <i v-if="item.NgaySanXuat">
                                                                    .NSX:<span>
                                                                        {{ item.NgaySanXuat==null?'': moment(item.NgaySanXuat).format('DD/MM/YYYY')}}
                                                                    </span> -
                                                                </i>
                                                            </span>
                                                            <span v-if="item.NgayHetHan">
                                                                <i>  HSD:<span>{{ item.NgayHetHan==null?'': moment(item.NgayHetHan).format('DD/MM/YYYY') }}</span></i>
                                                            </span>
                                                            <br />
                                                        </span>
                                                        <span class="seach-hh"> {{ item.MaHangHoa }}</span>
                                                        Giá: <span>
                                                            {{ formatNumber3Digit(item.GiaBan) }}
                                                        </span>
                                                        <span>
                                                            Tồn kho:<span>{{ formatNumber3Digit(item.TonKho) }}</span>
                                                        </span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div>
                                        <a class="btn btn-link pull-right" onclick=showdoitramenu() id="btndoitra"> <i class="glyphicon glyphicon-menu-up "></i></a>
                                    </div>
                                    <input type="text" class="seachnumber" />
                                    <div class="number-fast-banle " id="pressNormal-DT">
                                        <input type="text" class="form-control text-right"
                                               id="txtSoLuong_DT"
                                               data-bind="value: $root.txtSoLuongDT, valueUpdate:'afterkeydown', event:{keyup: editSoLuongDoiTra_NhapThuong}" placeholder="Số lượng">
                                        <input type="text" class="form-control text-right"
                                               id="txtDonGia_DT" placeholder="Đơn giá"
                                               onkeypress="return keypressNumber(event)"
                                               data-bind="event:{keyup: editDonGiaDoiTra_NhapThuong},
                                               value: $root.txtDonGiaDT, valueUpdate:'afterkeydown',">
                                    </div>
                                    <a href="javascript:void(0)" class="box-barcode" data-bind="click: NhapThuong_Nhanh_DoiTra" style=" margin-top:0">
                                        <img src="/Content/images/print-min.png" alt="Nhập nhanh" />
                                    </a>
                                </div>
                                <div class="slide-bill bill-listchoose  bill-listchoose-newss">
                                    <div class="floatleft " id="divCTDoiTra">
                                        <ul data-bind="foreach: NewProducts">
                                            <li data-bind="css:$index()%2!==0?'li-info':''" class="li-return">
                                                <div class=" op-hoadon-item">
                                                    <div class="op-hoadon-text" onclick="push30(this)">
                                                        <div class="op-hoadon-stt" data-bind="text: SoThuTu, "></div>
                                                        <div data-bind="text: commonStatisJs.SubStringContent(MaHangHoa,13), " class="op-hoadon-id"></div>
                                                        <div class="op-hoadon-name">
                                                            <div class="">
                                                                <div class="op-hoadon-productname" data-bind="style: { width: ( TenDonViTinh=='' || TenDonViTinh ==null)? '100%' : 'calc(100% - 75px)' }">
                                                                    <label data-bind="text: TenHangHoa" class="hdhh-name"></label>
                                                                </div>
                                                                <div class="dropdown proDropdown blue notshow don-vi-tinh" style="float:right"
                                                                     data-bind="visible: TenDonViTinh!=='' && TenDonViTinh !==null">
                                                                    <button class="notshow btn" type="button" data-toggle="dropdown" aria-expanded="true">
                                                                        <span class="notshow" data-bind="text: TenDonViTinh"></span>
                                                                        <i class="fal fa-angle-down notshow" aria-hidden="true" data-bind="style: { opacity:  ListDonViTinh.length > 1 ? 1 : 0 }"></i>
                                                                    </button>
                                                                    <ul class="dropdown-menu right-0 " data-bind="foreach: ListDonViTinh">
                                                                        <li data-toggle="dropdown"
                                                                            data-bind="click: function (){ $root.ChangeDVT_HangHoa($data, $parent, true)} ,
                                                        css: {focusLot: ID_DonViQuiDoi == $parent.ID_DonViQuiDoi}">
                                                                            <a class="notshow" href="javascript:void(0);"
                                                                               data-bind="text: TenDonViTinh">Thùng</a>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                            <div class="op-hoadon-item-chietkhauNV">
                                                                <p class="p-note" data-bind="text: GhiChu_NVThucHien"></p>
                                                                <p class="p-note" data-bind="text: GhiChu_NVTuVan"></p>
                                                            </div>
                                                            <div class="op-hoadon-ghichu" data-bind="visible: (QuanLyTheoLoHang === false && LotParent === false)" style="margin:0">
                                                                <input autocomplete="off" type="text" placeholder="Ghi chú"
                                                                       data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,true)}}">
                                                                <i class="fa fa-pencil" style="display:inline-block"></i>
                                                            </div>
                                                        </div>

                                                    </div>
                                                    <div class="op-hoadon-number">
                                                        <div class="list-price input-sl" >
                                                            <div class="list-price input-sl">
                                                                <a href="javascript:void(0)" title="Số lượng quy cách" class="quy-cach-edit-left btn-gray">
                                                                    <i class="fa fa-pencil-square-o" aria-hidden="true"
                                                                       data-bind=" click: function() {$root.ShowDivNhapQuyCach ($data,true)},visible: QuyCach !== 1 "></i>
                                                                </a>
                                                                <div class="call-quy-cach" style="display: none;  top:32px" data-bind="attr: {id: 'call-quy-cach_'+ IDRandom }">
                                                                    <div class="callprice-left" style="width:40%">
                                                                        Nhập quy cách:
                                                                    </div>
                                                                    <div class="callprice-right " style="width:60%">
                                                                        <input type="text" class="number-price text-right"
                                                                               onkeypress="return keypressNumber(event)" onclick="this.select()"
                                                                               data-bind="event: {keyup: $root.EditQuyCach_DoiTra,
                                                               function:{mouseout: $root.MouseOutQuyCach ($data,true)} }">
                                                                    </div>
                                                                </div>
                                                                <a href="javascript:void(0)" class="bill-plus" title="Giảm số lượng"
                                                                   data-bind="event:{click: $parent.giamSolLuong_DoiTra }">
                                                                    <i class="fal fa-angle-down"></i>
                                                                </a>
                                                                <div class="input-sl-quy-cach">
                                                                    <input type="text" class=" input-simple" maxlength="9" title="Số lượng" 
                                                                           data-bind="value: formatNumber3Digit(SoLuong),
                                                   attr:{id:'numberTH_'+ IDRandom},
                                                   event:{keyup: $parent.editSoLuong_DoiTra}"
                                                                           onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()">
                                                                    <span data-bind="attr:{id: 'quycach_'+ IDRandom}, visible: SoLuongQuyCach > 0,
                                                 text: formatNumber3Digit(SoLuongQuyCach) " style="display:block;max-width:85px; text-align:center"></span>
                                                                </div>
                                                                <a href="javascript:void(0)" class="bill-plus bill-plusnext" title="Tăng số lượng"
                                                                   data-bind="event:{click: $parent.tangSolLuong_DoiTra }">
                                                                    <i class="fal fa-angle-up"></i>
                                                                </a>
                                                                <a href="javascript:void(0)" class="quy-cach-edit-right" title="Số lượng sản phẩm quá nhỏ" style="display:none"
                                                                   data-bind="attr:{id: 'WrQuycach_' + IDRandom}">
                                                                    <i class="fa fa-warning"></i>
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div class="warning" data-bind=" visible: CssWarning">
                                                            <div class="floatleft"
                                                                 data-bind="attr:{id: 'show_wrDT_'+ IDRandom}">
                                                                <div class="main-warning" data-bind="click: $parent.ShowinforTon_Dat">
                                                                    <i class="fa fa-warning red"></i>
                                                                </div>
                                                                <div class="content-warning" data-bind="attr:{id: 'wr_'+IDRandom }">
                                                                    Tồn:&nbsp;<span data-bind="text: TonKho"></span>&nbsp;-&nbsp;
                                                                    Đặt:&nbsp;<span data-bind="text: SoLuong"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-price">
                                                            <div class="floatleft text-right">
                                                                <!--ko if: $root.roleChangePriceProduct()-->
                                                                <input type="text" class="form-control text-right" onclick="this.select()" maxlength="12"
                                                                       data-bind="value: formatNumber3Digit(GiaBan,2), attr:{id:'priceTH_'+ IDRandom},
                                                                      event:{keyup: $root.editPrice_DoiTra}" onkeypress="return keypressNumber(event)" />
                                                                <!--/ko-->
                                                                <!--ko if: !$root.roleChangePriceProduct()-->
                                                                <label class="lbl-input" data-bind="text:formatNumber3Digit(GiaBan), attr:{id:'priceTH_'+ IDRandom}"></label>
                                                                <!--/ko-->
                                                            </div>
                                                        </div>
                                                        <div class="list-price">
                                                            <button class="input-simple"
                                                                    data-bind="text: formatNumber3Digit(TienChietKhau,2), attr:{id: 'btn_saleDT_'+ IDRandom},
                                                                                click: $parent.showDivSale_CTHD_DoiTra"></button>
                                                            <div class="callprice" style="display: none; width:300px;right: -19%; top:32px"
                                                                 data-bind="attr:{id:'callpriceTH_'+IDRandom}">
                                                                <div class="callprice-left" style="width:40%">
                                                                    Nhập chiết khấu:
                                                                </div>
                                                                <div class="callprice-right" style="width:60%">
                                                                    <input type="text" class="form-control number-price" onclick="this.select()"
                                                                           onkeypress="return getNumber(event,this)"
                                                                           data-bind="attr:{id:'pri-gTH_'+ IDRandom}, event:{keyup: $parent.editSale_DoiTra}">
                                                                    <div class="toogle toogle-report Ptram"
                                                                         data-bind="attr:{id: 'vndTH_'+ IDRandom}">
                                                                        <span class="poison" data-bind="click: $parent.clickVND_DoiTra">VNĐ</span>
                                                                        <span class="transverse" data-bind="click: $parent.clickVND_DoiTra">%</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-price" data-bind="click: function (){ $root.showPopChietKhauTong_CTHD($data, true)}">
                                                            <label data-bind="text:formatNumber3Digit(SoLuong * TienChietKhau), 
                                                                   attr:{id: 'lblckTong_' + IDRandom}
                                                                   "></label>
                                                        </div>
                                                        <div class="list-totle-price">
                                                            <!--ko if: $root.roleChangePriceProduct()-->
                                                            <input type="text" class="text-right effect-1"
                                                                   onkeypress="keypressNumber_limitNumber(event,this)"
                                                                   onclick="this.select()" maxlength="12"
                                                                   data-bind="value: formatNumber3Digit(ThanhTien,2),attr:{id: 'sumTH_' + IDRandom},
                                                                        event:{keyup: $parent.editSumPrice_DoiTra}" />
                                                            <!--/ko-->
                                                            <!--ko if: !$root.roleChangePriceProduct()-->
                                                            <label data-bind="text:formatNumber3Digit(ThanhTien), attr:{id: 'sumTH_' + IDRandom}"></label>
                                                            <!--/ko-->
                                                        </div>
                                                    </div>

                                                    <div class="op-hoadon-function">
                                                        <a href="javascript:void(0)"
                                                           data-bind="click: $parent.addLot_DoiTra, visible: LoaiHangHoa !==3" class="btn-gray" title="Thêm hàng cùng loại">
                                                            <i class="material-icons ">add</i>
                                                        </a>
                                                        <a href="javascript:void(0)" title="Chi tiết chiết khấu nhân viên"
                                                           data-bind="click: function(){$root.showPopupUserDiscount($data, true)}, visible: LoaiHoaDon ==1  || LoaiHoaDon === 2" class="btn-gray">
                                                            <i class="fa fa-user" aria-hidden="true"></i>
                                                        </a>
                                                        @*<a href="javascript:void(0)" title="Thay đổi thành phần định lượng" class="btn-gray"
                                                           data-bind="click: function () {$root.ShowPop_ChangeTPDinhLuong ($data, true)},
                                       visible: LoaiHangHoa !== 1">
                                                            <i class="fa fa-list-alt"></i>
                                                        </a>*@
                                                        <a href="javascript:void(0)" data-bind="event:{click: $parent.xoaHangHoa_DoiTra}" class="btn-gray" title="Xóa hàng">
                                                            <i class="material-icons md-18" style="color:#B60201;">close</i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="seach-nhomhang _ghi-chu-nhap-hang _ghi-chu-nhap-hang-no-lo"
                                                     data-bind="visible: (QuanLyTheoLoHang === false && LotParent === false)">
                                                    <a href="javascript:void(0)" class="change-vi-tri "
                                                       data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                           css:{'active': ID_ViTri !== null},
                                           click: function(){$root.ChangeViTri_CTHD($data, true)},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')">Chọn vị trí</a>
                                                </div>

                                                <div class="floatleft item-lot item-lothd op-hoadon-item"
                                                     data-bind="visible: QuanLyTheoLoHang, attr:{id: ID_DonViQuiDoi}, style:{ borderBottom: DM_LoHang.length > 1? '1px dotted #ccc':'none'}">
                                                    <div class="op-hoadon-text">
                                                        <div class="op-hoadon-stt" style="border-color:transparent"></div>
                                                        <div class="_solo-top flex op-hoadon-name">
                                                            <div class="import-option-lohang flex">
                                                                <div class="name-lot1">
                                                                    <span data-bind="attr: {id: IDRandom}" hidden></span>
                                                                    <span class="numberlot">Số lô</span>
                                                                    <div class="lotsolo">
                                                                        <div class="outselect">
                                                                            <div class="floatleft " data-toggle="dropdown" aria-expanded="false">
                                                                                <input type="text" class="form-control"
                                                                                       data-bind="value: DM_LoHang.length > 0? DM_LoHang[0].MaLoHang:'',
                                                    click: $root.LoadListLot_ofProduct,
                                                   event:{keyup: $root.SearchLot_ofProduct}" placeholder="Số lô" />
                                                                            </div>
                                                                            <div class="selec-person dropdown-menu divlist-LoHang">
                                                                                <ul data-bind="foreach: $parent.ListLot_ofProduct">
                                                                                    <li data-bind="click: $root.ClickChoseLot_DoiTra, attr:{id:ID}">
                                                                                        @*<a class="thongtinlo">*@
                                                                                        <div class="flex flex-row flex-between">
                                                                                            <span data-bind="text: MaLoHang" class="bold"></span>
                                                                                            <span>
                                                                                                Tồn: <span class="bold" data-bind="text: formatNumber3Digit(TonKho)"></span>
                                                                                            </span>
                                                                                        </div>
                                                                                        <small class="flex flex-row flex-between">
                                                                                            <span data-bind="visible: NgaySanXuat" style="font-style:italic">
                                                                                                NSX:<span style="color:green" data-bind="text: moment(NgaySanXuat).format('DD/MM/YYYY')!='Invalid date'? moment(NgaySanXuat).format('DD/MM/YYYY'):''"></span>
                                                                                            </span>
                                                                                            <span data-bind="visible: NgayHetHan" style="font-style:italic">
                                                                                                HSD:<span style="color:red" data-bind="text: moment(NgayHetHan).format('DD/MM/YYYY')!='Invalid date'? moment(NgayHetHan).format('DD/MM/YYYY'):''"></span>
                                                                                            </span>
                                                                                        </small>
                                                                                        @*</a>*@
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="name-lot">
                                                                    <span>Ngày sx</span>
                                                                    <input type="text" class="form-control ngaysx-empty width-80 height-24"
                                                                           data-bind="visible: DM_LoHang.length > 0 && (DM_LoHang[0].NgaySanXuat =='' || DM_LoHang[0].NgaySanXuat == null)" placeholder="Ngày SX">
                                                                    <div class="date-lot bglot1"
                                                                         data-bind="text: DM_LoHang.length > 0? DM_LoHang[0].NgaySanXuat:'', visible: DM_LoHang.length > 0 && DM_LoHang[0].NgaySanXuat !='' && DM_LoHang[0].NgaySanXuat !== null"></div>
                                                                </div>
                                                                <div class="name-lot">
                                                                    <span>Hạn sd</span>
                                                                    <input type="text" class="form-control exp-empty width-80 height-24"
                                                                           data-bind="visible: DM_LoHang.length > 0 && (DM_LoHang[0].NgayHetHan =='' || DM_LoHang[0].NgayHetHan == null)" placeholder="Hạn SD">
                                                                    <div class="date-lot bglot2"
                                                                         data-bind="text: DM_LoHang.length > 0? DM_LoHang[0].NgayHetHan:'', visible: DM_LoHang.length > 0 && DM_LoHang[0].NgayHetHan !='' && DM_LoHang[0].NgayHetHan !== null"></div>
                                                                </div>
                                                            </div>
                                                            <div class="op-hoadon-ghichu">
                                                                <i class="fa fa-pencil" style="display:inline-block"></i>
                                                                <input autocomplete="off" type="text" class="nofocus" placeholder="Ghi chú"
                                                                       data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,true)}}">
                                                            </div>
                                                        </div>
                                                        <div class="seach-nhomhang _ghi-chu-nhap-hang ">
                                                            <a href="javascript:void(0)" class="change-vi-tri"
                                                               data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                               css:{'active': ID_ViTri !== null},
                                           click: function(){$root.ChangeViTri_CTHD($data, false)},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')">Chọn vị trí</a>
                                                            <div class="room-view-vi-tri" data-bind="visible: ID_ViTri !== null && LoaiHoaDon ==1">
                                                                <div class="room-position">
                                                                    <label>Vị trí</label>
                                                                    <div> <span data-bind="text: TenViTri"> </span></div>
                                                                </div>
                                                                <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                                    <label>Thời gian</label>
                                                                    <div>
                                                                        <span class="timeUse" data-bind="text: ThoiGianThucHien +' phút'"></span>
                                                                    </div>
                                                                </div>
                                                                <div class="room-position" data-bind="visible: ThoiGianThucHien !== 0">
                                                                    <label>Giờ bắt đầu</label>
                                                                    <div>
                                                                        <input type="text" class="time-room" data-bind="visible: TimeStart !== 0, value: TimeStart,
                                                                  click: function(){$root.ChangeTime_CTHD($data, true)}, attr: {id: 'timneDT_'+ IDRandom}">
                                                                        <a href="javascript:void(0)" class="play-start-room"
                                                                           data-bind="visible: TimeStart == 0, click: function(){$root.ClickTimeStart($data, false)} "><i class="fa fa-play" aria-hidden="true"></i></a>
                                                                    </div>
                                                                </div>
                                                                <div class="room-position overtime" data-bind="visible: QuaThoiGian !==0">
                                                                    <label>Quá giờ</label>
                                                                    <div>
                                                                        <span class="timeOver" data-bind="text: QuaThoiGian"></span>
                                                                    </div>
                                                                </div>
                                                                <div class="room-position" data-bind="visible: LoaiHangHoa == 2 && TimeRemain > 0">
                                                                    <label>Còn lại</label>
                                                                    <div>
                                                                        <span class="timeRemain" data-bind="text: TimeRemain + ' phút'"></span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--ko foreach: DM_LoHang-->
                                                <!--ko if: $index() != 0-->

                                                <div class=" item-lot item-lothd item-lothdend op-js-hoadon-lohang op-hoadon-item" data-bind="attr:{id: ID_DonViQuiDoi}">
                                                    <div class="op-hoadon-text">
                                                        <div class="op-hoadon-stt" style="border-color:transparent"></div>
                                                        <div class="name-lot1">
                                                            <!--IDRandom: used to check when add Lot (multiple Lot = null)-->
                                                            <span data-bind="attr: {id: IDRandom}" hidden></span>
                                                            <span class="numberlot">Số lô</span>
                                                            <div class="lotsolo">
                                                                <div class="outselect">
                                                                    <div class="hoose-person floatleft " data-toggle="dropdown" aria-expanded="false">
                                                                        <input type="text" class="form-control"
                                                                               data-bind="value: MaLoHang,
                                                           click: $root.LoadListLot_ofProduct,
                                                           event:{keyup: $root.SearchLot_ofProduct}" placeholder="Số lô" />
                                                                    </div>
                                                                    <div class="selec-person dropdown-menu divlist-LoHang">
                                                                        <ul data-bind="foreach: $root.ListLot_ofProduct">
                                                                            <li data-bind="click: $root.ClickChoseLot_DoiTra, attr:{id:ID}">
                                                                                @*<a class="thongtinlo">*@
                                                                                <div class="flex flex-row flex-between">
                                                                                    <span data-bind="text: MaLoHang" class="bold"></span>
                                                                                    <span>
                                                                                        Tồn: <span class="bold" data-bind="text: formatNumber3Digit(TonKho)"></span>
                                                                                    </span>
                                                                                </div>
                                                                                <small class="flex flex-row flex-between">
                                                                                    <span data-bind="visible: NgaySanXuat" style="font-style:italic">
                                                                                        NSX:<span style="color:green" data-bind="text: moment(NgaySanXuat).format('DD/MM/YYYY')!='Invalid date'? moment(NgaySanXuat).format('DD/MM/YYYY'):''"></span>
                                                                                    </span>
                                                                                    <span data-bind="visible: NgayHetHan" style="font-style:italic">
                                                                                        HSD:<span style="color:red" data-bind="text: moment(NgayHetHan).format('DD/MM/YYYY')!='Invalid date'? moment(NgayHetHan).format('DD/MM/YYYY'):''"></span>
                                                                                    </span>
                                                                                </small>
                                                                                @*</a>*@
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="name-lot ">
                                                            <span>Ngày sx</span>
                                                            <input type="text" class="form-control ngaysx-empty width-80 height-24 "
                                                                   data-bind="visible: NgaySanXuat =='' || NgaySanXuat == null" placeholder="Ngày SX">
                                                            <div class="date-lot bglot1"
                                                                 data-bind="text: NgaySanXuat, visible: NgaySanXuat !=='' && NgaySanXuat !== null"></div>
                                                        </div>
                                                        <div class="name-lot ">
                                                            <span>Hạn sd</span>
                                                            <input type="text" class="form-control exp-empty width-80 height-24"
                                                                   data-bind="visible: NgayHetHan =='' || NgayHetHan == null" placeholder="Hạn SD">
                                                            <div class="date-lot bglot2"
                                                                 data-bind="text: NgayHetHan, visible: NgayHetHan !=='' && NgayHetHan !== null"></div>
                                                        </div>
                                                        <div class="op-hoadon-ghichu">
                                                            <i class="fa fa-pencil" style="display:inline-block"></i>
                                                            <input autocomplete="off" type="text" placeholder="Ghi chú"
                                                                   data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,true)}}">
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-number" style=" border-bottom: none;">
                                                        <div class="list-price input-sl">
                                                            <div class="list-price input-sl" style="border-bottom: none;">
                                                                <a href="javascript:void(0)" class="quy-cach-edit-left btn-gray">
                                                                    <i class="fa fa-pencil-square-o" aria-hidden="true"
                                                                       data-bind="click: function() {$root.ShowDivNhapQuyCach ($data,true)},visible:  QuyCach !== 1"></i>
                                                                </a>
                                                                <div class="call-quy-cach" style="top: 32px;" data-bind="attr: {id: 'call-quy-cach_'+ IDRandom } ">
                                                                    <div class="callprice-left" style="width:40%">
                                                                        Nhập quy cách:
                                                                    </div>
                                                                    <div class="callprice-right " style="width: 60%; border-bottom: none;">
                                                                        <input type="text" class="number-price text-right" onkeypress="return keypressNumber(event)" onclick="this.select()" data-bind="event: {keyup: $root.EditQuyCach_DoiTra,
                                                               function:{mouseout: $root.MouseOutQuyCach ($data,true)} }">
                                                                    </div>
                                                                </div>
                                                                <a href="javascript:void(0)" class="bill-plus" title="Giảm số lượng" data-bind="click: $root.giamSolLuong_DoiTra">
                                                                    <i class="fal fa-angle-down"></i>
                                                                </a>
                                                                <div class="pull-left nopadding input-sl-quy-cach">
                                                                    <input type="text" class=" input-simple" onclick="this.select()"
                                                                           data-bind="value: formatNumber3Digit(SoLuong),
                                                                attr:{id:'numberTH_' + IDRandom},
                                                                event:{keyup: $root.editSoLuong_DoiTra}" />
                                                                    <span data-bind="attr:{id: 'quycach_'+ IDRandom}, text: formatNumber3Digit(SoLuongQuyCach), visible: SoLuongQuyCach > 0" style="display:block;max-width:85px; text-align:center"></span>
                                                                </div>
                                                                <a href="javascript:void(0)" class="bill-plus bill-plusnext" title="Tăng số lượng" data-bind="click: $root.tangSolLuong_DoiTra">
                                                                    <i class="fal fa-angle-up"></i>
                                                                </a>
                                                            </div>
                                                            <div class="bill-returns">
                                                            </div>
                                                        </div>
                                                        <div class="warning" data-bind=" visible: CssWarning">
                                                            <i class="fa fa-warning red"
                                                               data-bind="attr:{id: 'show_wrDT_'+ IDRandom}, click: $root.ShowinforTon_Dat">
                                                            </i>
                                                            <div class="content-warning" data-bind="attr:{id: 'wr_'+IDRandom }">
                                                                Tồn:&nbsp;<span data-bind="text: TonKho"></span>&nbsp;-&nbsp;
                                                                Đặt:&nbsp;<span data-bind="text: SoLuong"></span>
                                                            </div>
                                                        </div>
                                                        <div class="list-price">
                                                            <!-- ko if: $root.roleChangePriceProduct() -->
                                                            <input class="input-simple" onclick="this.select()"
                                                                   data-bind="value: formatNumber3Digit(GiaBan,2), attr:{id:'priceTH_'+ IDRandom},
                                                                                event:{keyup: $root.editPrice_DoiTra}" style="margin-left: 5px;" />
                                                            <!-- /ko-->
                                                            <!-- ko if: !$root.roleChangePriceProduct()-->
                                                            <label class="input-simple" data-bind="text: formatNumber3Digit(GiaBan), attr:{id:'priceTH_'+ IDRandom}"></label>
                                                            <!-- /ko-->
                                                        </div>
                                                        <div class="list-price">
                                                            <button class="input-simple"
                                                                    data-bind="text: formatNumber3Digit(TienChietKhau,2), attr:{id: 'btn_saleDT_' + IDRandom},
                                                                         click: $root.showDivSale_CTHD_DoiTra"></button>
                                                            <div class="callprice" style="display: none; width:300px;right: -19%; top:32px"
                                                                 data-bind="attr:{id:'callprice_' + IDRandom}">
                                                                <div class="callprice-left" style="width:40%">
                                                                    Nhập chiết khấu:
                                                                </div>
                                                                <div class="callprice-right" style="width:60%">
                                                                    <input type="text" class=" number-price text-right" maxlength="12"
                                                                           onclick="this.select()"
                                                                           onkeypress="return getNumber(event,this)"
                                                                           data-bind="attr:{id:'pri-gTH_'+ IDRandom},
                                                                                         event:{keyup: $root.editSale_DoiTra}">
                                                                    <div class="toogle toogle-report Ptram"
                                                                         data-bind="attr:{id: 'vndTH_' + IDRandom}">
                                                                        <span class="poison" data-bind="click: $root.clickVND_DoiTra">VNĐ</span>
                                                                        <span class="transverse" data-bind="click:  $root.clickVND_DoiTra">%</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-price" data-bind="click: function (){ $root.showPopChietKhauTong_CTHD($data, true)}">
                                                            <label data-bind="text: formatNumber3Digit(SoLuong * TienChietKhau), 
                                                                   attr:{id: 'lblckTong_' + IDRandom}"></label>
                                                        </div>
                                                        <div class="list-totle-price">
                                                            <!-- ko if: $root.roleChangePriceProduct()-->
                                                            <input type="text" class="text-right effect-1"
                                                                   onkeypress="keypressNumber_limitNumber(event,this)"
                                                                   onclick="this.select()" maxlength="12"
                                                                   data-bind="value: formatNumber3Digit(ThanhTien,2),  attr:{id: 'sumTH_' + IDRandom},
                                                                               event:{keyup: $root.editSumPrice_DoiTra}" />
                                                            <!-- /ko-->
                                                            <!-- ko if: !$root.roleChangePriceProduct()-->
                                                            <label data-bind="text: formatNumber3Digit(ThanhTien), attr:{id: 'sumTH_' + IDRandom}"></label>
                                                            <!-- /ko-->
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-function">
                                                        <a href="javascript:void(0)" class="btn-gray" data-bind="click: $root.addLot_DoiTra, visible: LoaiHangHoa !==3" title="Thêm hàng cùng loại">
                                                            <i class="material-icons ">add</i>
                                                        </a>
                                                        <a href="javascript:void(0)" title="Chi tiết chiết khấu nhân viên"
                                                           data-bind="click:function(){$root.showPopupUserDiscount($data, true)} , visible: LoaiHoaDon === 1 || LoaiHoaDon === 2" class="btn-gray">
                                                            <i class="fa fa-user" aria-hidden="true"></i>
                                                        </a>
                                                        <!--DMLo: not change TPDinhLuong-->
                                                        <a href="javascript:void(0)" data-bind="event:{click: $root.xoaHangHoa_DoiTra}" class="btn-gray" title="Xóa hàng">
                                                            <i class="material-icons md-18" style="color:#B60201;">close</i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="seach-nhomhang _ghi-chu-nhap-hang ">
                                                    <a href="javascript:void(0)" class="change-vi-tri"
                                                       data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                               css:{'active': ID_ViTri !== null},
                                           click: function(){$root.ChangeViTri_CTHD($data, false)},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')">Chọn vị trí</a>
                                                    <div class="room-view-vi-tri" data-bind="visible: ID_ViTri !== null && LoaiHoaDon ==1">
                                                        <div class="room-position">
                                                            <label>Vị trí</label>
                                                            <div> <span data-bind="text: TenViTri"> B3</span></div>
                                                        </div>
                                                        <!--don't need bind Time for LoHang, beacause only DichVu have ThoiGianThucHien -->
                                                    </div>
                                                </div>
                                                <!--/ko-->
                                                <!--/ko-->
                                            </li>
                                            <!--ko foreach: HangCungLoais-->
                                            <li data-bind="css:$index()%2!==0?'li-info':''" class="li-return">
                                                <div class=" op-hoadon-item">
                                                    <div class="op-hoadon-text" onclick="push30(this)">
                                                        <div class="op-hoadon-stt" style="border-color:transparent"></div>
                                                        <div data-bind="text: commonStatisJs.SubStringContent(MaHangHoa,13)," class="op-hoadon-id"></div>
                                                        <div class="op-hoadon-name">
                                                            <div class="">
                                                                <div class="op-hoadon-productname" data-bind="style: { width: ( TenDonViTinh=='' || TenDonViTinh ==null)? '100%' : 'calc(100% - 75px)' }">
                                                                    <span data-bind="text: TenHangHoa" class="hdhh-name"></span>
                                                                </div>
                                                                <div class="dropdown proDropdown blue notshow don-vi-tinh" style="float:right"
                                                                     data-bind="visible: TenDonViTinh!=='' && TenDonViTinh !==null">
                                                                    <button class="notshow btn" type="button" data-toggle="dropdown" aria-expanded="true">
                                                                        <span class="notshow" data-bind="text: TenDonViTinh"></span>
                                                                        <i class="fal fa-angle-down notshow" aria-hidden="true" data-bind="style: { opacity:  ListDonViTinh.length > 1 ? 1 : 0 }"></i>
                                                                    </button>
                                                                    <ul class="dropdown-menu right-0" data-bind="foreach: ListDonViTinh">
                                                                        <li data-toggle="dropdown"
                                                                            data-bind="click: function (){ $root.ChangeDVT_HangHoa($data, $parent, true)} ,
                                                        css: {focusLot: ID_DonViQuiDoi == $parent.ID_DonViQuiDoi}">
                                                                            <a class="notshow" href="javascript:void(0);"
                                                                               data-bind="text: TenDonViTinh">Thùng</a>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                            <div class="op-hoadon-item-chietkhauNV">
                                                                <p class="p-note" data-bind="text: GhiChu_NVThucHien"></p>
                                                                <p class="p-note" data-bind="text: GhiChu_NVTuVan"></p>
                                                            </div>
                                                            <div class="op-hoadon-ghichu">
                                                                <i class="fa fa-pencil" style="display:inline-block"></i>
                                                                <input autocomplete="off" type="text" placeholder="Ghi chú"
                                                                       data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,true)}}">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-number">
                                                        <div class="list-price input-sl">
                                                            <div class="list-price input-sl">
                                                                <a href="javascript:void(0)" class="quy-cach-edit-left btn-gray">
                                                                    <i class="fa fa-pencil-square-o" aria-hidden="true"
                                                                       data-bind=" click: function() {$root.ShowDivNhapQuyCach ($data,true)},visible: QuyCach !== 1 "></i>
                                                                </a>
                                                                <div class="call-quy-cach" style="display: none;  top:32px" data-bind="attr: {id: 'call-quy-cach_'+ IDRandom }">
                                                                    <div class="callprice-left" style="width:40%">
                                                                        Nhập quy cách:
                                                                    </div>
                                                                    <div class="callprice-right " style="width:60%">
                                                                        <input type="text" class="number-price text-right"
                                                                               onkeypress="return keypressNumber(event)" onclick="this.select()"
                                                                               data-bind="event: {keyup: $root.EditQuyCach_DoiTra,
                                                               function:{mouseout: $root.MouseOutQuyCach ($data,true)} }">
                                                                    </div>
                                                                </div>
                                                                <a href="javascript:void(0)" class="bill-plus" title="Giảm số lượng"
                                                                   data-bind="event:{click: $root.giamSolLuong_DoiTra }">
                                                                    <i class="fal fa-angle-down"></i>
                                                                </a>
                                                                <div class="input-sl-quy-cach">
                                                                    <input type="text" class=" input-simple" maxlength="9"
                                                                           data-bind="value: formatNumber3Digit(SoLuong),
                                                   attr:{id:'numberTH_'+ IDRandom},
                                                   event:{keyup: $root.editSoLuong_DoiTra}"
                                                                           onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()">
                                                                    <span data-bind="attr:{id: 'quycach_'+ IDRandom}, visible: SoLuongQuyCach > 0,
                                                 text: formatNumber3Digit(SoLuongQuyCach) " style="display:block; max-width:85px; text-align:center"></span>
                                                                </div>
                                                                <a href="javascript:void(0)" class="bill-plus bill-plusnext" title="Tăng số lượng"
                                                                   data-bind="event:{click: $root.tangSolLuong_DoiTra }">
                                                                    <i class="fal fa-angle-up"></i>
                                                                </a>
                                                                <a href="javascript:void(0)" class="quy-cach-edit-right" title="Số lượng sản phẩm quá nhỏ" style="display:none"
                                                                   data-bind="attr:{id: 'WrQuycach_' + IDRandom}">
                                                                    <i class="fa fa-warning"></i>
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div class="warning" data-bind=" visible: CssWarning">
                                                            <div class="floatleft"
                                                                 data-bind="attr:{id: 'show_wrDT_'+ IDRandom}">
                                                                <div class="main-warning" data-bind="click: $root.ShowinforTon_Dat">
                                                                    <i class="fa fa-warning red"></i>
                                                                </div>
                                                                <div class="content-warning" data-bind="attr:{id: 'wr_'+IDRandom }">
                                                                    Tồn:&nbsp;<span data-bind="text: TonKho"></span>&nbsp;-&nbsp;
                                                                    Đặt:&nbsp;<span data-bind="text: SoLuong"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-price">
                                                            <div class="floatleft text-right">
                                                                <!--ko if: $root.roleChangePriceProduct()-->
                                                                <input type="text" class="form-control text-right" onclick="this.select()" maxlength="12"
                                                                       data-bind="value: formatNumber3Digit(GiaBan,2), attr:{id:'priceTH_'+ IDRandom},
                                                                      event:{keyup: $root.editPrice_DoiTra}" onkeypress="return keypressNumber(event)" />
                                                                <!--/ko-->
                                                                <!--ko if: !$root.roleChangePriceProduct()-->
                                                                <label class="lbl-input" data-bind="text:formatNumber3Digit(GiaBan), attr:{id:'priceTH_'+ IDRandom}"></label>
                                                                <!--/ko-->
                                                            </div>
                                                        </div>
                                                        <div class="list-price">
                                                            <button class="input-simple"
                                                                    data-bind="text: formatNumber3Digit(TienChietKhau,2), attr:{id: 'btn_saleDT_'+ IDRandom},
                                                                                click: $root.showDivSale_CTHD_DoiTra"></button>
                                                            <div class="callprice" style="display: none; width:300px;right: -19%; top:32px"
                                                                 data-bind="attr:{id:'callpriceTH_'+IDRandom}">
                                                                <div class="callprice-left" style="width:40%">
                                                                    Nhập chiết khấu:
                                                                </div>
                                                                <div class="callprice-right" style="width:60%">
                                                                    <input type="text" class="form-control number-price" onclick="this.select()"
                                                                           onkeypress="return getNumber(event,this)"
                                                                           data-bind="attr:{id:'pri-gTH_'+ IDRandom}, event:{keyup: $root.editSale_DoiTra}">
                                                                    <div class="toogle toogle-report Ptram"
                                                                         data-bind="attr:{id: 'vndTH_'+ IDRandom}">
                                                                        <span class="poison" data-bind="click: $root.clickVND_DoiTra">VNĐ</span>
                                                                        <span class="transverse" data-bind="click: $root.clickVND_DoiTra">%</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-price" data-bind="click: function (){ $root.showPopChietKhauTong_CTHD($data, true)}">
                                                            <label data-bind="text:formatNumber3Digit(SoLuong * TienChietKhau), 
                                                                   attr:{id: 'lblckTong_' + IDRandom}"></label>
                                                        </div>
                                                        <div class="list-totle-price">
                                                            <!--ko if: $root.roleChangePriceProduct()-->
                                                            <input type="text" class="text-right effect-1"
                                                                   onkeypress="keypressNumber_limitNumber(event,this)"
                                                                   onclick="this.select()" maxlength="12"
                                                                   data-bind="value: formatNumber3Digit(ThanhTien,2),attr:{id: 'sumTH_' + IDRandom},
                                                                        event:{keyup: $root.editSumPrice_DoiTra}" />
                                                            <!--/ko-->
                                                            <!--ko if: !$root.roleChangePriceProduct()-->
                                                            <label data-bind="text:formatNumber3Digit(ThanhTien), attr:{id: 'sumTH_' + IDRandom}"></label>
                                                            <!--/ko-->
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-function">
                                                        @*<a href="javascript:void(0)" title="Chi tiết chiết khấu nhân viên"
                                                           data-bind="click: function(){$root.showPopupUserDiscount($data, true)}, visible: LoaiHoaDon !== 3 " class="btn-gray">
                                                            <i class="fa fa-user" aria-hidden="true"></i>
                                                        </a>*@
                                                        @*<a href="javascript:void(0)" title="Thay đổi thành phần định lượng" class="btn-gray"
                                                           data-bind="click: function () {$root.ShowPop_ChangeTPDinhLuong ($data, true)},
                                                        visible: LoaiHangHoa !== 1">
                                                            <i class="fa fa-list-alt"></i>
                                                        </a>*@
                                                        <a href="javascript:void(0)" data-bind="event:{click: $root.xoaHangHoa_DoiTra}" class="btn-gray" title="Xóa hàng">
                                                            <i class="material-icons md-18" style="color:#B60201;">close</i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="seach-nhomhang _ghi-chu-nhap-hang ">
                                                    <a href="javascript:void(0)" class="change-vi-tri"
                                                       data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                               css:{'active': ID_ViTri !== null},
                                           click: function(){$root.ChangeViTri_CTHD($data, true)},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')">Chọn vị trí</a>
                                                </div>
                                            </li>
                                            <!--/ko-->
                                            <!--ko foreach: ThanhPhanComBo-->
                                            <li class="li-return">
                                                <div class=" op-hoadon-item">
                                                    <div class="op-hoadon-text" onclick="push30(this)">
                                                        <div class="op-hoadon-stt" style="border-color:transparent"></div>
                                                        <div data-bind="text: commonStatisJs.SubStringContent(MaHangHoa,13)" class="op-hoadon-id"></div>
                                                        <div class="op-hoadon-name">
                                                            <div class="">
                                                                <div class="op-hoadon-productname" data-bind="style: { width: ( TenDonViTinh=='' || TenDonViTinh ==null)? '100%' : 'calc(100% - 75px)' }">
                                                                    <span data-bind="text: TenHangHoa" class="hdhh-name"></span>
                                                                </div>
                                                                <div class="dropdown proDropdown blue notshow don-vi-tinh" style="float:right"
                                                                     data-bind="visible: TenDonViTinh!=='' && TenDonViTinh !==null">
                                                                    <button class="notshow btn" type="button" data-toggle="dropdown" aria-expanded="true">
                                                                        <span class="notshow" data-bind="text: TenDonViTinh"></span>
                                                                        <i class="fal fa-angle-down notshow" aria-hidden="true" data-bind="style: { opacity:  ListDonViTinh.length > 1 ? 1 : 0 }"></i>
                                                                    </button>
                                                                    <ul class="dropdown-menu right-0" data-bind="foreach: ListDonViTinh">
                                                                        <li data-toggle="dropdown"
                                                                            data-bind="click: function (){ $root.ChangeDVT_HangHoa($data, $parent, true)} ,
                                                        css: {focusLot: ID_DonViQuiDoi == $parent.ID_DonViQuiDoi}">
                                                                            <a class="notshow" href="javascript:void(0);"
                                                                               data-bind="text: TenDonViTinh">Thùng</a>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                            <div class="op-hoadon-item-chietkhauNV">
                                                                <p class="p-note" data-bind="text: GhiChu_NVThucHien"></p>
                                                                <p class="p-note" data-bind="text: GhiChu_NVTuVan"></p>
                                                            </div>
                                                            <div class="op-hoadon-ghichu">
                                                                <i class="fa fa-pencil" style="display:inline-block"></i>
                                                                <input autocomplete="off" type="text" placeholder="Ghi chú"
                                                                       data-bind="value: GhiChu, event:{keyup: function(){$root.Combo_UpdateGhiChu ($data,$parent,true)}}">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-number">
                                                        <div class="list-price input-sl" >
                                                            <div class="list-price input-sl">
                                                                <a href="javascript:void(0)" class="quy-cach-edit-left btn-gray">
                                                                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                                                </a>
                                                                <div class="call-quy-cach" style="display: none;  top:32px">
                                                                    <div class="callprice-left" style="width:40%">
                                                                        Nhập quy cách:
                                                                    </div>
                                                                    <div class="callprice-right " style="width:60%">
                                                                        <input type="text" class="number-price text-right">
                                                                    </div>
                                                                </div>
                                                                <a href="javascript:void(0)" class="bill-plus" title="Giảm số lượng"
                                                                   data-bind="click: function(){$root.Combo_giamSoLuong($data,$parent,true)}">
                                                                    <i class="fal fa-angle-down"></i>
                                                                </a>
                                                                <div class="input-sl-quy-cach">
                                                                    <input type="text" class=" input-simple" maxlength="9" 
                                                                           data-bind="value: formatNumber3Digit(SoLuong),
                                                                           attr:{id:'numberTH_'+ IDRandom},
                                                                           event:{keyup: function(){$root.Combo_editSoluong($data,$parent,true)}}"
                                                                           onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()">
                                                                </div>
                                                                <a href="javascript:void(0)" class="bill-plus bill-plusnext" title="Tăng số lượng"
                                                                   data-bind="click: function(){$root.Combo_tangSoLuong($data,$parent,true)}">
                                                                    <i class="fal fa-angle-up"></i>
                                                                </a>
                                                                <a href="javascript:void(0)" class="quy-cach-edit-right" title="Số lượng sản phẩm quá nhỏ" style="display:none"
                                                                   data-bind="attr:{id: 'WrQuycach_' + IDRandom}">
                                                                    <i class="fa fa-warning"></i>
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div class="warning" data-bind=" visible: CssWarning">
                                                            <div class="floatleft"
                                                                 data-bind="attr:{id: 'show_wrDT_'+ IDRandom}">
                                                                <div class="main-warning">
                                                                    <i class="fa fa-warning red"></i>
                                                                </div>
                                                                <div class="content-warning">
                                                                    Tồn:&nbsp;<span data-bind="text: TonKho"></span>&nbsp;-&nbsp;
                                                                    Đặt:&nbsp;<span data-bind="text: SoLuong"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-price">
                                                            <div class="floatleft text-right">
                                                                <!--ko if: $root.roleChangePriceProduct()-->
                                                                <input type="text" class="form-control text-right" onclick="this.select()" maxlength="12"
                                                                       data-bind="value: formatNumber3Digit(GiaBan,2), attr:{id:'priceTH_'+ IDRandom},
                                                                      event:{keyup: function(){$root.Combo_editPrice($data,$parent,true)}}"
                                                                       onkeypress="return keypressNumber(event)" />
                                                                <!--/ko-->
                                                                <!--ko if: !$root.roleChangePriceProduct()-->
                                                                <label class="lbl-input" data-bind="text:formatNumber3Digit(GiaBan), attr:{id:'priceTH_'+ IDRandom}"></label>
                                                                <!--/ko-->
                                                            </div>
                                                        </div>
                                                        <div class="list-price">
                                                            <button class="input-simple"
                                                                    data-bind="text: formatNumber3Digit(TienChietKhau,2), attr:{id: 'btn_saleDT_'+ IDRandom},
                                                                                "></button>
                                                            <div class="callprice" style="display: none; width:300px;right: -19%; top:32px"
                                                                 data-bind="attr:{id:'callpriceTH_'+IDRandom}">
                                                                <div class="callprice-left" style="width:40%">
                                                                    Nhập chiết khấu:
                                                                </div>
                                                                <div class="callprice-right" style="width:60%">
                                                                    <input type="text" class="form-control number-price" onclick="this.select()"
                                                                           onkeypress="return getNumber(event,this)"
                                                                           data-bind="attr:{id:'pri-gTH_'+ IDRandom},">
                                                                    <div class="toogle toogle-report Ptram"
                                                                         data-bind="attr:{id: 'vndTH_'+ IDRandom}">
                                                                        <span class="poison">VNĐ</span>
                                                                        <span class="transverse">%</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-price">
                                                            <label data-bind="text:formatNumber3Digit(SoLuong * TienChietKhau), 
                                                                   attr:{id: 'lblckTong_' + IDRandom}"></label>
                                                        </div>
                                                        <div class="list-totle-price">
                                                            <!--ko if: $root.roleChangePriceProduct()-->
                                                            <input type="text" class="text-right effect-1"
                                                                   onkeypress="keypressNumber_limitNumber(event,this)"
                                                                   onclick="this.select()" maxlength="12"
                                                                   data-bind="value: formatNumber3Digit(ThanhTien,2),attr:{id: 'sumTH_' + IDRandom},
                                                                        event:{keyup: function(){$root.Combo_editSumPrice($data,$parent,true)}}" />
                                                            <!--/ko-->
                                                            <!--ko if: !$root.roleChangePriceProduct()-->
                                                            <label data-bind="text:formatNumber3Digit(ThanhTien), attr:{id: 'sumTH_' + IDRandom}"></label>
                                                            <!--/ko-->
                                                        </div>
                                                    </div>
                                                    <div class="op-hoadon-function">
                                                        <a href="javascript:void(0)" title="Chi tiết chiết khấu nhân viên"
                                                           data-bind="click:function(){$root.Combo_showPopupUserDiscount($data, $parent,true)} ,
                                                           visible: LoaiHoaDon !== 3 " class="btn-gray">
                                                            <i class="fa fa-user" aria-hidden="true"></i>
                                                        </a>
                                                        <a href="javascript:void(0)" title="Thay đổi thành phần định lượng" class="btn-gray"
                                                           data-bind="click: function(){ $root.Combo_ShowPopChangeTPDinhLuong ($data,$parent,true )},
                                                            visible: LoaiHangHoa !==1">
                                                            <i class="fa fa-list-alt"></i>
                                                        </a>
                                                        <a href="javascript:void(0)"
                                                           data-bind="click: function(){$root.Combo_xoaHangHoa($data, $parent,true)}" class="btn-gray" title="Xóa hàng">
                                                            <i class="material-icons md-18" style="color:#B60201;">close</i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="seach-nhomhang _ghi-chu-nhap-hang ">
                                                    <a href="javascript:void(0)" class="change-vi-tri"
                                                       data-bind="text: ID_ViTri == null?'Chọn vị trí':'Đổi vị trí',
                                               css:{'active': ID_ViTri !== null},
                                           click: function(){$root.ChangeViTri_CTHD($data, true)},
                                           visible: LoaiHoaDon ==1 && $root.setViewSoDoPhong() && ('@ViewBag.shopCookies' =='AC9DF2ED-FF08-488F-9A64-08433E541020' || '@ViewBag.shopCookies'=='83894499-AEFA-4F58-96B4-5EC1A0B16A76')">Chọn vị trí</a>
                                                </div>

                                            </li>
                                            <!--/ko-->
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <!--End Tra Hang-->
                        </div>
                    </div>
                    <div class="w301  " id="billwidown">
                        <a id="pullrightbtn" onclick=pullright()>
                            <i class="fal fa-angle-right"></i>
                            <i class="fal fa-angle-left" style="display:none"></i>
                        </a>
                        <div id="floatpayment" data-bind="click: function() {saveHoaDonTraHang(false)}" style="display:none; background: #eb4a24">
                            <span> Thanh toán:</span>
                            <span data-bind="text: formatNumber3Digit(HoaDons().PhaiThanhToan(),2)"></span>
                        </div>
                        <div class="height-fix">
                            <div class="inner-w30 floatleft divMenuRight" id="divMenuRight">
                                <div class="flex flex-column flex-between" style="height:100%; flex-wrap:nowrap">
                                    <div class="flex flex-column" style="height:calc(100% - 100px); width:100% ">
                                        <!--Loại hóa đơn-->
                                        <div class="title-bill-total floatleft container-fluid" id="lblHoaDon">
                                            <ul>
                                                <!--ko if: RoleInsert_Invoice () && $root.HoaDons().LoaiHoaDon() !== 6-->
                                                <!--ko if: !(
                                              $root.HoaDons().ID()!=='00000000-0000-0000-0000-000000000000'
                                            && ($root.HoaDons().LoaiHoaDon() == 3 || $root.HoaDons().LoaiHoaDon() == 19)
                                               ) -->
                                                <li data-bind="css:{'active': $root.HoaDons().LoaiHoaDon() == 1},click: clickHoaDon">
                                                    <img hidden class="act-l" src="/Content/images/conner-white.png" alt="" tabindex="-1" />
                                                    <a href="javascript:void(0)">Hóa đơn</a>
                                                    <img hidden class="act-r" src="/Content/images/conner-white.png" alt="" tabindex="-1" />
                                                </li>
                                                <!--/ko-->
                                                <!--/ko-->
                                                <!--ko if: $root.HoaDons().LoaiHoaDon() !== 6 -->
                                                <!--ko if: !(
                                              $root.HoaDons().ID()!=='00000000-0000-0000-0000-000000000000'
                                            && ($root.HoaDons().LoaiHoaDon() == 3 || $root.HoaDons().LoaiHoaDon() == 1|| $root.HoaDons().LoaiHoaDon() == 25)
                                               ) -->
                                                <li data-bind="css:{'active': $root.HoaDons().LoaiHoaDon() == 19},click: clickGoiDichVu">
                                                    <img hidden class="act-l" src="/Content/images/conner-white.png" alt="" tabindex="-1" />
                                                    <a href="javascript:void(0)">Gói dịch vụ</a>
                                                    <img hidden class="act-r" src="/Content/images/conner-white.png" alt="" tabindex="-1" />
                                                </li>
                                                <!--/ko-->
                                                <!--/ko-->
                                                <!--ko if: $root.HoaDons().LoaiHoaDon() !== 6 -->
                                                <!--ko if: !(
                                                $root.HoaDons().ID()!=='00000000-0000-0000-0000-000000000000'
                                            &&  ($root.HoaDons().LoaiHoaDon() == 1 || $root.HoaDons().LoaiHoaDon() == 19)  ) -->
                                                <li data-bind="css:{'active': $root.HoaDons().LoaiHoaDon() == 2},click: Click_tabBaoHanh">
                                                    <img hidden class="act-l" src="/Content/images/conner-white.png" alt="" tabindex="-1" />
                                                    <a href="javascript:void(0)">Bảo hành</a>
                                                    <img hidden class="act-r" src="/Content/images/conner-white.png" alt="" tabindex="-1" />
                                                </li>
                                                <!--/ko-->
                                                <!--/ko-->
                                                <!--ko if: $root.HoaDons().LoaiHoaDon() === 6-->
                                                <li class="active">
                                                    <img hidden class="act-l" src="/Content/images/conner-white.png" alt="" tabindex="-1" />
                                                    <a href="javascript:void(0)">Trả hàng</a>
                                                    <img hidden class="act-r" src="/Content/images/conner-white.png" alt="" tabindex="-1" />
                                                </li>
                                                <!--/ko-->
                                            </ul>
                                        </div>
                                        <!--Thông tin khách hàng-->
                                        <div class="flex flex-column" style="position:relative; padding:7px;">
                                            <!--Tìm khiến khách hàng-->
                                            <jqauto-customer params="showDiv: $root.cusChosing().MaNguoiNop ==''
                                                          && (HoaDons().ID_HoaDon() == null || HoaDons().ID_HoaDon() =='00000000-0000-0000-0000-000000000000' ),
                                                          loaiDoiTuong :1,
                                                          roleAdd: roleCustomer_Insert(),
                                                          showDiary: true,
                                                          changeCus: ChangeCus,
                                                          addCustomer: showPopupAddKH"></jqauto-customer>
                                            <!--Khách lẻ-->
                                            <div class=" floatleft " id="divKhachLe"
                                                 data-bind="visible: HoaDons().ID_HoaDon()!= null && HoaDons().ID_HoaDon()!= '00000000-0000-0000-0000-000000000000' && $root.cusChosing().MaNguoiNop==''">
                                                <div class="op-banle-khachhang">
                                                    <i class="fa fa-user"></i>
                                                    <a>Khách Lẻ</a>
                                                </div>
                                            </div>
                                            <!--Khách chi tiết/ khách thường-->
                                            <div class=" floatleft" id="divChiTietKH"
                                                 data-bind="foreach: ChiTietDoiTuong, visible:  $root.cusChosing().MaNguoiNop !=''">
                                                <div class="flex flex-row flex-between op-banle-khachhang op-input-search-add" style="padding: 0 7px; height:30px;">
                                                    <div class="flex flex-row" style="align-items:center">
                                                        <i class="fal fa-user"></i>
                                                        <a href="javascript:void(0)" data-bind="text: TenDoiTuong, event:{click: $parent.showPopupEditKH}"></a>
                                                    </div>
                                                    <button class="btn btn-add" data-bind="click: $parent.deleteNCC" style="top:0">
                                                        <i class="fal fa-times red"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <!--ma + sdt khach -->
                                            <div class="title-bill floatleft" data-bind="visible: $root.cusChosing().MaNguoiNop != '' ">
                                                <div class=" customer-info">
                                                    <span href="javascript:void(0)">
                                                        <span data-bind="text: $root.cusChosing().MaNguoiNop"></span>
                                                    </span>
                                                    <span data-bind="visible: $root.cusChosing().SoDienThoai">
                                                        (<span data-bind="text: $root.cusChosing().SoDienThoai"></span>)
                                                    </span>
                                                </div>
                                            </div>
                                            <!--end -->
                                            <!--Điểm/Nợ khách hàng -->
                                            <div class="title-bill floatleft" id="search-place">
                                                <div class=" customer-info">
                                                    <a href="javascript:void(0)" data-bind="click: $root.showListHoaDon">
                                                        <span data-bind="text: $root.cusChosing().NoHienTai==0?'': 'Nợ :'+ formatNumber3Digit($root.cusChosing().NoHienTai)"></span>
                                                    </a>
                                                    <span data-bind=" visible: ThietLap().TinhNangTichDiem, text:' Điểm: ' + formatNumber3Digit($root.cusChosing().TongTichDiem)"></span>
                                                </div>
                                            </div>
                                            <!-- nHật ký , lịch hẹn Khách hàng-->
                                            <div class=" op-banle-khachhang-button flex flex-row" style="">
                                                @*<button data-bind="visible :(ChiTietDoiTuong().length !== 0 && ChiTietDoiTuong () !=='undefined'),click: ShowCalendar" class="btn btn-default" title="Lịch hẹn">
                                                    <i class="fal fa-calendar"></i>
                                                </button>*@
                                                <button data-bind="click: ShowPopListDiary_ofCustomer" class="btn btn-default" title="Nhật ký giao dịch">
                                                    <i class="fal fa-book"></i>
                                                    <span class="badge-baoduong" style="display:none"
                                                          data-bind="text: $root.TongGoiDV()">
                                                    </span>
                                                </button>

                                                <style>
                                                    .badge-baoduong {
                                                        height: 18px;
                                                        width: 22px;
                                                        background: #fff;
                                                        position: absolute;
                                                        top: 1px;
                                                        border-radius: 20px;
                                                        line-height: 19px;
                                                        text-align: center;
                                                        border: 1px solid #ccc;
                                                        font-weight: 700;
                                                        color: black;
                                                        background: pink;
                                                    }
                                                </style>

                                            </div>
                                        </div>
                                        <!--Bảng giá-->
                                        <div class="doi-tra-hang-new container-fluid nopadding">
                                            <div class="flex flex-between op-banle-bang-gia">
                                                <div class="title-bill  " id="divBangGia" style="position:relative">
                                                    <div class="name-bill2 " data-bind="click: HideShow_ListBangGia" tabindex="0">
                                                        <i class="glyphicon glyphicon-tags" tabindex="-1"></i>
                                                        <span data-bind="text:titleGiaban" tabindex="-1"></span>
                                                        <font class="icon-title" tabindex="-1">
                                                            <i class="fal fa-angle-down"></i>
                                                            <i class="fal fa-angle-up"></i>
                                                        </font>
                                                    </div>
                                                    <div class="select-user select-user2 dropbox">
                                                        <ul>
                                                            <li>
                                                                <input type="text" class="form-control" id="txtChoseGiaBan" data-bind="value: filterGiaBan, valueUpdate: 'afterkeydown'" />
                                                                <i class="fal fa-search"></i>
                                                            </li>
                                                        </ul>
                                                        <ul class="list-name-staff" id="lstBangGia">
                                                            <!--ko foreach: arrFilterGiaBan-->
                                                            <li data-bind="click: $parent.ChangeBangGia">
                                                                <a href="javascript:void(0)" data-bind="text: TenGiaBan, attr:{id: ID}"></a>
                                                                <span data-bind="attr:{id: 'spanCheck_'+ ID}">
                                                                </span>
                                                            </li>
                                                            <!--/ko -->
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="date-chang1 flex flex-between">
                                                    <input id="datepicker" onclick="this.select()"
                                                           data-bind="value: HoaDons().NgayLapHoaDon() == null?
                                                   DateHDDefault: moment(HoaDons().NgayLapHoaDon(),'YYYY-MM-DD HH:mm').format('DD/MM/YYYY HH:mm') .split(' ')[0],
                                                       event:{change: ChangeNgayLapHD}" tabindex="0" title="Nhập ngày" />
                                                    <span>/</span>
                                                    <input id="timepicker" onclick="this.select()"
                                                           data-bind="value: HoaDons().NgayLapHoaDon() == null? TimeHDDefault: HoaDons().NgayLapHoaDon().split(' ')[1],
                                                       event:{change: ChangeNgayLapHD}" tabindex="0" title="Nhập giờ" />
                                                </div>
                                            </div>
                                            <div class="delivery" hidden>
                                                <label>
                                                    <input type="checkbox" /> Giao hàng
                                                </label>
                                            </div>
                                            <div class="floatleft indebt">
                                            </div>
                                            <div class="bill-total  floatleft"
                                                 data-bind="visible: HoaDons().LoaiHoaDon()=== 6">
                                                <div class="title-bill-total bill-total-th floatleft"
                                                     style="background: rgb(214, 214, 214); height: 35px; width: 100%; padding: 5px;">
                                                    <span data-bind="visible: HoaDons().ID_HoaDon() === null">
                                                        Thông tin trả hàng
                                                    </span>
                                                    <span data-bind="visible: HoaDons().ID_HoaDon()!=='00000000-0000-0000-0000-000000000000'">
                                                        <span>  Trả hàng từ hóa đơn&nbsp;&nbsp;</span>
                                                        <span data-bind="text: HoaDons().MaHoaDonTraHang()"></span>
                                                    </span>
                                                </div>
                                                <div class="op-table-bill floatleft">
                                                    <table class="table">
                                                        <tr style="display:none">
                                                            <td style="width:40%">
                                                                Mã hóa đơn
                                                            </td>
                                                            <td></td>
                                                            <td class=" text-right bold">
                                                                <input style="height: 24px; border: none;  background-color: antiquewhite" type="text" class="text-right"
                                                                       data-bind="value: $root.HoaDons().MaHoaDonDB(), event:{keyup: $root.editMaHoaDon}" />
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Tổng gốc trả hàng</td>
                                                            <td></td>
                                                            <td class="text-right ">
                                                                <span data-bind="text: formatNumber3Digit(HoaDons().TongGiaGocHangTra(),2)"></span>
                                                            </td>
                                                        </tr>
                                                        <tr class="hasGiamGia" data-bind="visible: HoaDons().PTGiamDB > 0">
                                                            <td>Giảm giá</td>
                                                            <td></td>
                                                            <td class="text-right bold">
                                                                <span data-bind="text: formatNumber3Digit(HoaDons().TongGiamGiaDB(),2)"></span>
                                                            </td>
                                                        </tr>
                                                        <tr class="border-bottom">
                                                            <td>Phí trả hàng</td>
                                                            <td></td>
                                                            <td class="text-right ">
                                                                <input type="text" class="text-right effect-1"
                                                                       data-bind="value: formatNumber3Digit(HoaDons().TongChiPhiHangTra(),2), event:{keyup: editPhiTraHang}"
                                                                       onkeypress="return keypressNumber_limitNumber(event, this)" style="border-bottom:none" />
                                                            </td>
                                                        </tr>
                                                        <tr class="border-bottom " style="display:none">
                                                            <td>
                                                                Hoàn trả thu khác
                                                            </td>
                                                            <td></td>
                                                            <td class=" text-right ">
                                                                <input type="text" class="text-right effect-1"
                                                                       data-bind="value: formatNumber3Digit(HoaDons().HoanTraThuKhac())"
                                                                       onkeypress="return keypressNumber(event)" />
                                                            </td>
                                                        </tr>
                                                        <tr class="border-bottom " style="display:none">
                                                            <td>
                                                                Thuế (VAT)
                                                            </td>
                                                            <td></td>
                                                            <td class=" text-right ">
                                                                <span class="text-right"
                                                                      data-bind="text: formatNumber3Digit(HoaDons().TongThueDB(),2)"
                                                                      onkeypress="return keypressNumber(event)" />
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Tổng tiền trả</td>
                                                            <td></td>
                                                            <td class=" text-right">
                                                                <span id="lblTongTienTra" data-bind="text:formatNumber3Digit(HoaDons().TongTienTra(),2)">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                        <tr data-bind="visible: HoaDons().NoHDCu() > 0">
                                                            <td>Nợ hóa đơn cũ</td>
                                                            <td></td>
                                                            <td class=" text-right">
                                                                <span data-bind="text:formatNumber3Digit(HoaDons().NoHDCu())">
                                                                </span>
                                                            </td>
                                                        </tr>

                                                        <!--ko if: HoaDons().PhaiThanhToanDB() != 0  -->
                                                        <tr class="border-bottom"
                                                            data-bind="visible: HoaDons().PhaiThanhToanDB() != 0">
                                                            <td>
                                                                <span data-bind="visible: HoaDons().PhaiThanhToanDB() < 0">
                                                                    Khách cần trả
                                                                </span>
                                                                <span data-bind="visible: HoaDons().PhaiThanhToanDB() > 0">
                                                                    Cần trả khách
                                                                </span>
                                                            </td>
                                                            <td></td>
                                                            <td class="text-right">
                                                                <span class="price-pay"
                                                                      data-bind="text: formatNumber3Digit(Math.abs(HoaDons().PhaiThanhToanDB()))">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                        <!--/ko-->
                                                        <tr class="border-bottom  bold"
                                                            data-bind="visible: $root.NewProducts().length == 0 && HoaDons().PhaiThanhToanDB() < 0">
                                                            <td style="position:relative">
                                                                <span data-bind="click: function(){ThanhToanThe(3)}" tabindex="0">
                                                                    Tiền khách đưa <font>(F9)</font>
                                                                </span>
                                                                <span style="position:absolute;bottom: 1px;left: 5px;font-size: 12px;line-height: 12px;font-weight: normal;font-style: normal;">
                                                                    <small id="lblLoaiTienNoHDGoc">(Tiền mặt)</small>
                                                                </span>
                                                            </td>
                                                            <td></td>
                                                            <td class=" text-right bold">
                                                                <input style="height:24px" type="text" class="price-pay-end text-right"
                                                                       data-bind="value: formatNumber3Digit(HoaDons().DaThanhToan()),event:{keyup:editDaTra }"
                                                                       onkeypress="return keypressNumber(event)" tabindex="0" title="Nhập tiền mặt" />
                                                            </td>
                                                        </tr>

                                                        <tr class="border-bottom  bold  trahang_khongmua"
                                                            data-bind="visible: HoaDons().TongTienMua()==0 && HoaDons().PhaiThanhToan() <= 0">
                                                            <td>
                                                                <span data-bind="click: function(){ThanhToanThe(1)}">
                                                                    Tiền trả khách <font>(F9)</font><br />
                                                                </span>
                                                                <p class="money-face bottom14" style=" position: initial !important;">
                                                                    <small id="lblTienMat_THKM">(Tiền mặt)</small>
                                                                </p>
                                                            </td>
                                                            <td></td>
                                                            <td class=" text-right ">
                                                                <input type="text" class="text-right effect-1 " id="txtDaTraKhach_KM"
                                                                       readonly
                                                                       data-bind="value: formatNumber3Digit(HoaDons().DaTraKhach(),2),event:{keyup:editDaTraKhach }"
                                                                       onkeypress="return keypressNumber(event)" style="border-bottom:none;" />
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>

                                            <div class="bill-total floatleft"
                                                 data-bind="visible: HoaDons().LoaiHoaDon()!==6 || NewProducts().length > 0">
                                                <div class="title-bill-total bill-total-th floatleft"
                                                     data-bind="visible: NewProducts().length > 0"
                                                     style="background:#d6d6d6;height: 35px;width: 100%;padding: 5px;}">
                                                    <span style="background:transparent">Thông tin hàng mua</span>
                                                </div>
                                                <div class="op-table-bill">
                                                    <table class="">
                                                        <tr style="display:none">
                                                            <td style="width:40%">
                                                                Mã hóa đơn
                                                            </td>
                                                            <td></td>
                                                            <td class=" text-right bold">
                                                                <input style="height: 24px; border: none;  background-color: antiquewhite" type="text" class="text-right"
                                                                       data-bind="value: HoaDons().MaHoaDonDB(), event:{keyup: $root.editMaHoaDon}" />
                                                            </td>
                                                        </tr>
                                                        <tr class="">
                                                            <td class="sale-5 chiet-khau">
                                                                Chiết khấu hàng hóa
                                                            </td>
                                                            <td class="text-right">
                                                            </td>
                                                            <td class=" text-right td-parent-price-1">
                                                                <div data-bind="click: ShowDiv_ChietKhauHangHoa">
                                                                    <span data-bind="text: formatNumber3Digit(HoaDons().TongGiamGiaHang(),2)"></span>
                                                                </div>
                                                                <div class="arrow-left arrow-left2 fix-heightpp">
                                                                    <div class="price price_2 floatleft" style="display:flex; flex-direction:row; flex-wrap:nowrap">
                                                                        <span style="margin-top:8px">Chiết khấu:</span>
                                                                        <input type="text" class=" price-sa" style="margin-top:0px; margin-left:13px;width:106px"
                                                                               data-bind="value: HoaDons().PTChietKhauHH() > 0 ? formatNumber3Digit(HoaDons().PTChietKhauHH()):
                                               formatNumber3Digit(HoaDons().TongGiamGiaHang()),event:{keyup:ChietKhauHangHoa_Edit}" />
                                                                        <div class="plus vnd1" data-bind="click: ChietKhauHangHoa_ClickTaxVND">VNĐ</div>
                                                                        <div class="plus senter1" id="ckHang_Ptram" data-bind="click: ChietKhauHangHoa_ClickTaxPtram">%</div>
                                                                    </div>
                                                                    <div class="price price_2 floatleft flex flex-between" style="display:none">
                                                                        <span>Khuyến mại :</span>
                                                                        <div class="sumgiamgia">
                                                                            <input type="text" class=" text-right floatleft" readonly
                                                                                   data-bind="value: formatNumber3Digit(HoaDons().TongGiamGiaKhuyenMai_CT(),2) ">
                                                                        </div>
                                                                    </div>
                                                                    <div class="price price_2 floatleft flex flex-between">
                                                                        <span class="w93">Tổng chiết khấu :</span>
                                                                        <div style="padding-right:7px;border-bottom:1px solid #ccc"
                                                                             data-bind="text: formatNumber3Digit(HoaDons().TongGiamGiaHang() + HoaDons().TongGiamGiaKhuyenMai_CT(),2)" class="sumgiamgia"></div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                Thành tiền
                                                                <!--ko if: $root.roleHoaDonHoTro_Insert()-->
                                                                <span data-bind="visible: HoaDons().LoaiHoaDon() == 1 || HoaDons().LoaiHoaDon() == 2">
                                                                    <i class="fa fa-gift pa11 qua-tang-km" aria-hidden="true" title="Hỗ trợ"
                                                                       data-bind="click: GetListKM_HoaDon "></i>
                                                                </span>
                                                                <!--/ko-->
                                                                <span data-bind="visible: $root.Customer_GiaTriHoTro() && $root.Customer_GiaTriHoTro() != 0">
                                                                    <span data-bind="text: $root.Customer_GiaTriHoTro()"></span>
                                                                    <span data-bind="visible: $root.Customer_GiaTriHoTro() < '100'">%</span>
                                                                </span>
                                                            </td>
                                                            <td></td>
                                                            <td class="text-right bold">
                                                                <span class="sum-price" data-bind="text: formatNumber3Digit(HoaDons().TongTienHang(),2)"></span>
                                                            </td>
                                                        </tr>
                                                        <!--Thue-->
                                                        <tr style="display:none">
                                                            <td class="sale-5 chiet-khau">
                                                                Thuế <font>(F7)</font>
                                                            </td>
                                                            <td class="text-right">
                                                                <span id="ptTax" class="operation"
                                                                      data-bind="text: HoaDons().PTThueHoaDon()"></span>
                                                                <span id="dvtTax" class="operation"
                                                                      data-bind="text: HoaDons().PTThueHoaDon() != 0 ?'%':
                                                  (HoaDons().TongTienThue()!= 0)?'VND': '%'"></span>
                                                            </td>
                                                            <td class="text-right">
                                                                <div data-bind="click: ShowDivTax_HD" tabindex="0">
                                                                    <span data-bind="text: formatNumber3Digit(HoaDons().TongTienThue(),2)"></span>
                                                                </div>
                                                                <div class="arrow-left arrow-left2 fix-heightpp">
                                                                    <div class="price price_2 floatleft flex flex-row" style=" flex-wrap:nowrap">
                                                                        <span>Thuế:</span>
                                                                        <input type="text" class="input-simple" style="width:80px" autocomplete="off"
                                                                               onkeypress="return getNumber(event,this)"
                                                                               data-bind="value: HoaDons().PTThueHoaDon() > 0 ? formatNumber3Digit(HoaDons().PTThueHoaDon()): formatNumber3Digit(HoaDons().TongTienThue(),2),
                                                                           event:{keyup:editTax }," />
                                                                        <div class="plus vnd1" data-bind="click: clickVNDTax">VNĐ</div>
                                                                        <div class="plus senter1" id="hd_TaxPtram" data-bind="click: clickNoVNDTax">%</div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <!--end Thue-->
                                                        <tr style="display:none">
                                                            <td class="sale-5 chiet-khau">
                                                                Giảm giá <font>(F8)</font>
                                                            </td>
                                                            <td class="text-right">
                                                                <span id="ptGiam" class="operation"
                                                                      data-bind="text: HoaDons().TongChietKhau() > 0 ? formatNumber3Digit(HoaDons().TongChietKhau()): formatNumber3Digit(HoaDons().TongGiamGia(),2)"></span>
                                                                <span id="dvtGiamParent" class="operation"
                                                                      data-bind="text:HoaDons().DVTinhGiam()"></span>
                                                            </td>
                                                            <td class=" text-right td-parent-price-1 jsSalePr">
                                                                <div data-bind="click: ShowDivSale_HD" tabindex="0">
                                                                    <span id="ggHoaDon" class="operation" data-bind="text: formatNumber3Digit(HoaDons().TongGiamGia(),2)"></span>
                                                                    <span class="parent-price-1" data-bind="text: formatNumber3Digit(HoaDons().TongGiamGiaKM_HD(),2)"></span>
                                                                </div>
                                                                <div class="arrow-left arrow-left2 fix-heightpp">
                                                                    <div class="price price_2 floatleft" style="display:flex; flex-direction:row; flex-wrap:nowrap">
                                                                        <span style="margin-top:8px">Giảm giá:</span>
                                                                        <input type="text" class=" price-sa" style="margin-top:0px; margin-left:13px;width:106px"
                                                                               data-bind="value: HoaDons().TongChietKhau() > 0 ? formatNumber3Digit(HoaDons().TongChietKhau()): formatNumber3Digit(HoaDons().TongGiamGiaKM_HD()),event:{keyup:editSalePr } "
                                                                               onkeypress="return getNumber(event,this)" />
                                                                        <div class="plus gb vnd1" data-bind="click: clickVNDPr">VNĐ</div>
                                                                        <div class="plus senter1" id="hd_CKPtram" data-bind="click: clickNoVNDPr">%</div>
                                                                    </div>
                                                                    <!--ko foreach: ListGroupSale-->
                                                                    <div style=" padding-left:15px">
                                                                        <div class="choosenhom floatleft">
                                                                            <div data-bind="event:{change: $parent.ChangeID_NhomSale }">
                                                                                <div class="form-check">
                                                                                    <input type="radio" class="form-check-input" name="rdoGroupSale" style="border: none; margin: 5px 0 0 !important;"
                                                                                           data-bind="value:ID,checked: $parent.HoaDons().ID_NhomDTApplySale(), attr: {id: ID} " />
                                                                                    <label class="form-check-label" data-bind="attr: {for: ID}">
                                                                                        <!--ko text: TenNhomDoiTuong --><!--/ko-->
                                                                                        @*<span data-bind="text: TenNhomDoiTuong"></span>*@
                                                                                    </label>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!--/ko-->
                                                                    <div class="price price_2 floatleft flex flex-between">
                                                                        <span>Khuyến mại :</span>
                                                                        <!--KhuyeMai_GiamGia : bi sai ten truong trong DB-->
                                                                        <div class="sumgiamgia">
                                                                            <input type="text" class=" text-right floatleft" readonly
                                                                                   data-bind="value: formatNumber3Digit(HoaDons().KhuyeMai_GiamGia(),2) ">
                                                                        </div>
                                                                    </div>
                                                                    <div class="price price_2 floatleft flex flex-between">
                                                                        <span class="w93">Tổng giảm giá :</span>
                                                                        <div style="padding-right:7px;border-bottom:1px solid #ccc" data-bind="text: formatNumber3Digit(HoaDons().TongGiamGiaKM_HD(),2)" class="sumgiamgia"></div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <!--Khach Da Tra // DatHang-->
                                                        <tr class="border-bottom khachdatra" data-bind="visible: HoaDons().KhachDaTra() > 0 && HoaDons().LoaiHoaDon() !== 6">
                                                            <td>Khách đã trả</td>
                                                            <td></td>
                                                            <td class="text-right">
                                                                <span id="lblKhachDaTra" data-bind="text: formatNumber3Digit(HoaDons().KhachDaTra(),2)">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                        <!--end KhachDaTra-->
                                                        <tr class="border-bottom khachcantra" data-bind="visible: HoaDons().HoanTraTamUng() === 0">
                                                            <td>
                                                                <span>
                                                                    Khách cần trả
                                                                </span>
                                                            </td>
                                                            <td></td>
                                                            <td class="text-right">
                                                                <span class="price-pay" id="lblPhaiThanhToan"
                                                                      data-bind="text: formatNumber3Digit(HoaDons().PhaiThanhToan(),2)">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                        <tr class="border-bottom  bold khachcantra" data-bind="visible: HoaDons().HoanTraTamUng() === 0">
                                                            <td style="position:relative">
                                                                <span data-bind="click: function(){ThanhToanThe(3)}" tabindex="0">
                                                                    Tiền khách đưa <font>(F9)</font>
                                                                </span>
                                                                <span style="position:absolute;bottom: 1px;left: 5px;font-size: 12px;line-height: 12px;font-weight: normal;font-style: normal;">
                                                                    <small id="lblTienMat">(Tiền mặt)</small>
                                                                </span>
                                                            </td>
                                                            <td></td>
                                                            <td class=" text-right bold">
                                                                <input style="height:24px" type="text" class="price-pay-end text-right" id="txtDaThanhToan"
                                                                       data-bind="value: formatNumber3Digit(HoaDons().DaThanhToan()),event:{keyup:editDaTra }"
                                                                       onkeypress="return keypressNumber(event)" tabindex="0" title="Nhập tiền mặt" />
                                                            </td>
                                                        </tr>
                                                        <tr class="border-bottom hoantratamung" data-bind="visible: HoaDons().HoanTraTamUng() > 0">
                                                            <td>Phải trả khách</td>
                                                            <td></td>
                                                            <td class="text-right bold w100">
                                                                <span data-bind="text: formatNumber3Digit(HoaDons().HoanTraTamUng())"></span>
                                                            </td>
                                                        </tr>
                                                        <tr class="border-bottom bold hoantratamung" data-bind="visible: HoaDons().HoanTraTamUng() > 0">
                                                            <td>
                                                                <span data-bind="click: function(){ThanhToanThe(2)}">
                                                                    Tiền trả khách <font>(F9)</font><br />
                                                                </span>
                                                                <p class="money-face bottom14" style=" position: initial !important;">
                                                                    <small id="lblTienMat_TH">(Tiền mặt)</small>
                                                                </p>
                                                            </td>
                                                            <td></td>
                                                            <td class="text-right bold w100">
                                                                <input type="text" class="text-right w100" id="txtHoanTraTamUng"
                                                                       readonly
                                                                       data-bind="value: formatNumber3Digit(HoaDons().DaTraKhach()),event:{keyup:editDaTraKhach }"
                                                                       onkeypress="return keypressNumber(event)" />
                                                            </td>
                                                        </tr>
                                                        <tr style="border-bottom: 1px solid #ccc">
                                                            <td id="textTienThua"
                                                                data-bind="text: HoaDons().HoanTraTamUng() > 0? (HoaDons().DaTraKhach() >= HoaDons().HoanTraTamUng()?'Tiền thừa':'Đang thiếu khách'): (HoaDons().TienThua() >= 0?'Tiền thừa trả lại khách':'Tiền khách thiếu')"></td>
                                                            <td></td>
                                                            <td class="text-right">
                                                                <span id="lblTienThua" data-bind="text:formatNumber3Digit(Math.abs(HoaDons().TienThua()))">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                        <!--Start Cong no (Dat hang)-->
                                                        <tr id="tr-congnoDH" hidden>
                                                            <td>Tính vào công nợ</td>
                                                            <td></td>
                                                            <td class=" text-right">
                                                                <span data-bind="text:formatNumber3Digit(HoaDons().TienThua())">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                        <!--end cong no-->
                                                    </table>
                                                </div>
                                            </div>

                                            <div class="floatleft " id="divGhiChu">
                                                <textarea row="3" placeholder="Ghi chú" title="Nhập ghi chú"
                                                          data-bind="value: HoaDons().DienGiai(), event:{keyup: editNote}"></textarea>
                                            </div>
                                            <div class="floatleft container-fluid" hidden>
                                                <div class="form-group floatleft">
                                                    <label> Ngày áp dụng:</label>
                                                    <div class="form-news ">
                                                        <input class="form-control" id="dtNgayApDungGoiDV" autocomplete="off"
                                                               data-bind="click: formatDate, value: HoaDons().NgayApDungGoiDV(), event:{change: ChangeNgayApDung_GoiDV}">
                                                    </div>
                                                </div>
                                                <div class="form-group floatleft">
                                                    <label> Ngày hết hạn:</label>
                                                    <div class="form-news  ">
                                                        <input class="form-control" id="dtNgayHetHanGoiDV" autocomplete="off"
                                                               data-bind="click: formatDate, value: HoaDons().HanSuDungGoiDV(), event:{change: ChangeNgayHetHan_GoiDV}">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--nút chức năng-->
                                    <div id="divBtnThanhToan" class="floatleft ">
                                        <div class="flex flex-row" style="justify-content:space-evenly; padding:15px; padding-bottom:0px!important">
                                            <!--ko if: $root.isSaving()-->
                                            <button class="notifi-order">
                                                Đang lưu
                                            </button>
                                            <!--/ko-->
                                        </div>
                                        <!--ko if: !$root.isSaving()-->
                                        <div class="flex flex-row" style="justify-content:space-evenly; padding:15px">
                                            <!--ko if: HoaDons().LoaiHoaDon() === 3 -->
                                            <button class="notifi-order"
                                                    data-bind="click: function() {saveHoaDonTraHang(false)},
                                                    style:{width: $root.width_btnLuuBG()}">
                                                Lưu (F10)
                                            </button>
                                            <!--ko if: HoaDons().TrangThaiHD() ===6 -->
                                            <button class="notifi-order"
                                                    data-bind="click: TaoHDDatHang,
                                                    style:{width: $root.width_btnTaoHD()}">
                                                Tạo hóa đơn
                                            </button>
                                            <!--/ko-->
                                            <!--/ko-->
                                            <!--ko if: HoaDons().LoaiHoaDon() !== 3 -->
                                            <button class="notifi-order"
                                                    data-bind="click: function() {saveHoaDonTraHang(false)},
                                                    style:{width: $root.width_btnThanhToan()},
                                                    text: HoaDons().LoaiHoaDon()===6?'Trả hàng (F10)':'Thanh toán (F10)'">
                                            </button>
                                            <!--/ko-->
                                            <!--ko if: $root.setPrintDraft() -->
                                            <button class="notifi-order"
                                                    data-bind="click: printDraft,
                                                    style:{width: $root.width_btnInNhap()}">
                                                In nháp <br />
                                                (F11)
                                            </button>
                                            <!--/ko-->
                                        </div>
                                        <!--/ko-->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navbar chose1" id="mobile-nav">
                    <a id="dr_banhanghanghoa" class="using">
                        <i class="material-icons md-24">
                            shopping_cart
                        </i>
                        <small style="display:block"> Hàng hóa</small>
                    </a>
                    <a id="dr_divMenuRight">
                        <i class="material-icons md-24">
                            speaker_notes
                        </i>
                        <small style="display:block">Thanh toán</small>
                    </a>
                    <a class="mb-payment-button" onclick="focusback(), creatnewHD()" data-bind="click: function() {saveHoaDonTraHang(false)}">
                        <i class="material-icons md-36" style="color:white; font-weight:600"> done</i>
                    </a>
                </div>
                @*điều hướng page di động, các lện điều hướng được thực hiện thông quan ẩn hiện view*@
                <script>
                    $(document).ready(function () {
                        $("#showHH_r").click(function () {
                            if ($("#header1").is(":visible")) {
                                $("#bill-header").addClass("z9-front")
                            }
                            else {
                                $("#header1").show();
                            }
                            $("#divListHD").click(function () {
                                $("#bill-header").addClass("z9-front");
                                return false;
                            });
                            $(document).mouseup(function () {
                                $("#header1").show();
                                $("#bill-header").removeClass("z9-front")
                            })
                        });
                        $("#backgroud_black").click(function () {
                            $(this).hide();
                            hideview();
                        })
                        $("#showHH_m").click(function () {
                            $("#bill-header").addClass("z1-behind")
                            $("#backgroud_black").show()
                            $("#HangHoaView").removeClass("begone-250");
                            $("#HangHoaView").addClass("forceshow");
                        });
                        $("#showTH_m").click(function () {
                            $("#bill-header").addClass("z1-behind")
                            $("#backgroud_black").show()
                            $("#TraHangView").removeClass("begone-250");
                            $("#TraHangView").addClass("forceshow");
                        });
                        $("#txtSearchHH").focus(function () {
                            $("#bill-header").addClass("z1-behind")
                            $("#showseach").hide();
                        });
                        $("#dr_divMenuRight").click(function () {
                            $(".show_m").hide()
                            $("#showHH_b").show();
                            $("#mobile-nav").addClass("chose2");
                            $("#mobile-nav").removeClass("chose1");
                            $("#banhanghanghoa .w701").hide()
                            $("#banhanghanghoa .w301").show()
                            $(this).addClass("using")
                            $(this).siblings().removeClass("using");
                            $("#bill-header").addClass("op-menu-tab-2")
                        });
                        $("#dr_banhanghanghoa").click(function () {
                            $(".show_m").show()
                            $("#showHH_b").hide();
                            $("#mobile-nav").addClass("chose1");
                            $("#mobile-nav").removeClass("chose2");
                            $(this).addClass("using")
                            $(this).siblings().removeClass("using")
                            $("#banhanghanghoa .w701").show()
                            $("#banhanghanghoa .w301").hide();
                            $("#bill-header").removeClass("op-menu-tab-2")
                        });
                        $("#showHH_b").click(function () {
                            $(this).hide();
                            $(".show_m").show()
                            $("#mobile-nav").addClass("chose1");
                            $("#mobile-nav").removeClass("chose2");
                            $("#dr_banhanghanghoa").addClass("using")
                            $("#dr_banhanghanghoa").siblings().removeClass("using")
                            $("#banhanghanghoa .w701").show()
                            $("#banhanghanghoa .w301").hide()
                        }
                        );
                    });
                    function hideview() {
                        $("#HangHoaView").addClass("begone-250");
                        $("#backgroud_black").hide();
                        $("#bill-header").removeClass("z1-behind")
                    }
                    function hideviewTH() {
                        $("#TraHangView").addClass("begone-250");
                        $("#backgroud_black").hide();
                        $("#bill-header").removeClass("z1-behind")
                    }
                </script>
            </div>
        </div>
        <div class="modal fade in" id="mdFilterNhomHH">
            <div class="modal-dialog draggable fitter " role="document">
                <div class="title-fitter">
                    Nhóm hàng hóa
                </div>
                <div class="content-fitter tree-group-product col-md-12 " style="max-height: calc(100vh - 120px);overflow-x: hidden;">
                    <div class="floatleft tree-title-check-all">
                        <div class="seach-nhomhang col-md-12 nopadding">
                            <input type="text" id="txtSearchNhomHH" data-bind="value:querySearch" placeholder="Tìm kiếm nhóm hàng">
                            <i class="fal fa-search"></i>
                        </div>
                        <div class="col-md-5 nopadding">
                            <label>
                                <input type="checkbox" id="ckAllNhom" onclick="SetCheckAll(this)" /> Tất cả
                            </label>
                        </div>
                        <div class="col-md-7 nopadding tree-title-delete">
                            <a href="javascript:void(0)" class="pull-right" onclick="RemoveCheck()">Xóa chọn tất cả</a>
                        </div>
                    </div>
                    <div class="treeview-filter">
                        <div id="tree"></div>
                        <!--use tree2 to do get all ID_Child when check KMai-->
                        <div id="tree2" hidden></div>
                    </div>
                </div>
                <div class="choose-fitter btn-treeview">
                    <button type="button" class="btn btn-main" data-bind="click: getHangHoa_ByIDNhom"><i class="fa fa-check-square"></i>  Xong</button>
                    <button type="button" class="btn btn-cancel" data-dismiss="modal"><i class="fa fa-ban"></i> Bỏ qua</button>
                </div>
            </div>
        </div>

        <div class="modal fade bs-example-modal-md" id="getoffline">
            <div class="modal-dialog draggable   modal-lg " role="document">
                @Html.Partial("_getHoaDonOffline")
            </div>
        </div>
        <div class="modal fade printflast" id="print_HoaDonDraft">
            <div class="modal-dialog draggable   modal-lg " role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Hóa đơn</h4>
                    </div>
                    <div class="modal-body modal-bill" id="content-print">
                    </div>
                    <div class="footer-res floatleft">
                        <a href="javascript:void(0)" class="btn btn-main" data-bind="@*click: function () {InHoaDonOffline('HDBL')}*@ ">
                            <img src="/Content/images/iconbepp18.9/innhap.png" alt="In hóa đơn" />  In hóa đơn
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel">
                            <img src="/Content/images/iconbepp18.9/guiggmail.png" alt="Gửi email" />      Gửi email
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel" data-dismiss="modal">
                            <i class="fa fa-ban"></i> Bỏ qua
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade printflast" id="print_PhieuThu">
            <div class="modal-dialog draggable   modal-lg " role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Hóa đơn</h4>
                    </div>
                    <div class="modal-body modal-bill" id="content-print-PhieuThu">
                        @Html.Raw(Html.Action("LoadMauIn", "ThietLap", new { id = "K80_PhieuThu.txt" }))
                    </div>
                    <div class="footer-res floatleft">
                        <a href="javascript:void(0)" class="btn btn-main" data-bind="click: function () {InHoaDon('#content-print-PhieuThu')} ">
                            <img src="/Content/images/iconbepp18.9/innhap.png" alt="In hóa đơn" />  In hóa đơn
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel">
                            <img src="/Content/images/iconbepp18.9/guiggmail.png" alt="Gửi email" />      Gửi email
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel" data-dismiss="modal">
                            <i class="fa fa-ban"></i> Bỏ qua
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="trahanghoamodal">
            <div class="modal-dialog draggable   modal-lg " role="document">
                <div class="modal-content ">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title" id="lblTitleKH">Kiểm tra hàng hóa</h4>
                    </div>
                    <div class="modal-body">
                        <div class="seac-trahh add-icon-search-left">
                            <input type="text" class="form-control" id="txtTraCuuHH" placeholder="Mã hàng hóa, tên hàng hóa" />
                        </div>
                        <div class="floatleft">
                            <div class="table-res ov6">
                                <div class="titile-trahh floatleft">
                                </div>
                                <table class="table table-trahh">
                                    <thead>
                                        <tr>
                                            <th>Mã hàng hóa</th>
                                            <th>Tên hàng</th>
                                            <th>Chi nhánh</th>
                                            <th>Tồn kho</th>
                                            <th>Ghi chú</th>
                                        </tr>
                                    </thead>
                                    <tbody data-bind="foreach: $root.arrTraCuuHangHoa" class="table_TraCuu">
                                        <tr>
                                            <td data-bind="text: MaHangHoa"></td>
                                            <td>
                                                <span data-bind="text: TenHangHoa"></span>
                                                <span data-bind="visible: TenDonViTinh">
                                                    (<span data-bind="text: TenDonViTinh"></span>)
                                                </span>
                                                <span data-bind="text: ThuocTinh_GiaTri" style="color: #ff6a00;vertical-align:top;"></span>
                                            </td>
                                            <td data-bind="text: TenDonVi"></td>
                                            <td data-bind="text: TonKho"></td>
                                            <td data-bind="text: GhiChu"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="page ">
                                <div class="flex flex-end">
                                    <a href="javascript:void(0)" data-bind="click: $root.StartPageTheKho, visible: $root.VisibleStartPageTheKho"><i class="fa fa-step-backward" aria-hidden="true"></i></a>
                                    <a href="javascript:void(0)" data-bind="click: $root.BackPageTheKho, visible: $root.VisibleStartPageTheKho "><i class="fa fa-caret-left" aria-hidden="true"></i></a>
                                    <ul data-bind="foreach: $root.PageList_Display_TheKho">
                                        <li>
                                            <a href="javascript:void(0)" data-bind="text: pageNumberTK, click: $root.GoToPage, css: $root.GetClass($data)"></a>
                                        </li>
                                    </ul>
                                    <a href="javascript:void(0)" data-bind="click: $root.GoToNextPageTheKho, visible: $root.VisibleEndPageTheKho "><i class="fa fa-caret-right" aria-hidden="true"></i></a>
                                    <a href="javascript:void(0)" data-bind="click: $root.EndPageTheKho, visible: $root.VisibleEndPageTheKho "><i class="fa fa-step-forward" aria-hidden="true"></i></a>
                                    <div class="total-recos">Hiển thị <span data-bind="text: $root.fromitemtk"></span> - <span data-bind="text: $root.toitemtk"></span> trên tổng số <span data-bind="text: $root.TotalRecordTK"></span> mã hàng hóa.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="modalPopuplgDatHang">
            <div class="modal-dialog draggable   modal-lgmax " role="document">
                @Html.Partial("_xuliDatHang")
            </div>
        </div>
        <!--modal thanh toan when show LapPhieuThu-->
        <div class="modal fade" id="modalpopup_endDonDH">
            <div id="modalContainer_delete" class="modal-dialog draggable modal-sm" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="title-delete">
                            Kết thúc đơn đặt hàng
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        </div>
                        Bạn vừa tạo hóa đơn từ đơn đặt hàng. Kết thúc đơn đặt hàng ngay bây giờ?
                        <div class="modal-footer">
                            <button type="button" class="btn btn-main" data-dismiss="modal" data-bind="click: EndInvoice "><i class="fa fa-check"></i> Đồng ý</button>
                            <button type="button" class="btn btn-cancel" data-dismiss="modal" data-bind="click: NotEndInvoice"><i class="fa fa-ban"></i>Bỏ qua</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--modal KM HangHoa-->
        <div id="promotiont" class="modal fade">
            <div class="modal-dialog draggable   modal-lg " role="document">
                <div class="modal-content ">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title" id="titleKhuyenMai">Khuyến mại</h4>
                    </div>
                    <div class="modal-body">
                        <table class="table-responsive">
                            <tr>
                                <th>Chương trình khuyến mại</th>
                                <th>Hình thức khuyến mại</th>
                                <th>&nbsp;</th>
                            </tr>
                            <tbody data-bind="foreach: ListKM_ofHangHoa">
                                <tr>
                                    <td class="ver-top">
                                        <input type="radio" name="rdoKMai" data-bind="value: ID_KhuyenMai, checked: $parent.HH_KhuyenMai, event:{change: $parent.ChoseKhuyenMai}" />
                                        <span data-bind="text: TenKhuyenMai, attr:{id: ID_KhuyenMai}"></span>
                                    </td>
                                    <td class="ver-top" data-bind="text: HinhThucKhuyenMai"></td>
                                    <td>
                                        <div class="bill-seach" data-bind="visible: HinhThuc === 21 || HinhThuc === 22">
                                            <input type="text" class="form-control"
                                                   data-bind="click: $parent.LoadHangHoaTang,
                                                   jqAuto:{source: $parent.HangHoaTangs,value: $parent.ID_HHTang, inputProp:'MaHangHoa',
                                                   valueProp:'KM_IDRandom', labelProp:'MaHangHoa',template: 'tempHHMua'},
                                                    attr:{id:'txtAuto_'+ ID_KhuyenMai}"
                                                   placeholder="Tìm kiếm hàng hóa" autocomplete="off">
                                            <script type="text/html" id="tempHHMua">
                                                <a>
                                                    <span class="tit-seach" data-bind="text: TenHangHoa"></span>
                                                    <span style="color: #ff6a00" data-bind="text: ThuocTinh_GiaTri"></span>
                                                    <i><span></span></i><br />
                                                    <span data-bind="text: MaHangHoa" class="seach-hh bold"></span>
                                                    <span style="color: #c4814e" data-bind="visible: MaLoHang">
                                                        Lô: <span class="bold" data-bind="text: MaLoHang"></span>
                                                        <span data-bind="visible: NgaySanXuat">
                                                            <i>
                                                                .NSX:<span data-bind="text: NgaySanXuat==null?'': moment(NgaySanXuat).format('DD/MM/YYYY')">
                                                                </span> -
                                                            </i>
                                                        </span>
                                                        <span data-bind="visible: NgayHetHan">
                                                            <i>  HSD:<span data-bind="text: NgayHetHan==null?'': moment(NgayHetHan).format('DD/MM/YYYY')"></span></i>
                                                        </span>
                                                        <br />
                                                    </span>
                                                    Giá: <span data-bind="text: formatNumber3Digit(GiaBan)"></span>
                                                    <span>
                                                        Tồn kho:<span data-bind="text: TonKho"></span>
                                                    </span>
                                                </a>
                                            </script>
                                            <span data-bind="visible: HinhThuc === 21 || HinhThuc === 21">
                                                <img src="/Content/images/iconbepp18.9/timkiem.png" alt="Tìm kiếm" />
                                            </span>
                                            <span data-bind="visible: HinhThuc === 23 || HinhThuc === 24"></span>
                                        </div>
                                        <div class="text-left" data-bind="visible: HinhThuc === 23 || HinhThuc === 24, text: Note_HinhThuc">
                                        </div>
                                        <div data-bind="foreach: $data.HangHoaChoseTangs, visible: $data.HangHoaChoseTangs.length > 0">
                                            <div class="floatleft list-promotiont">
                                                <div class="code-sp" data-bind="text:MaHangHoa">
                                                </div>
                                                <div class="name-promotiont" data-bind="text: TenHangHoa">
                                                </div>
                                                <div class="list-munber-edit flex">
                                                    <a class="bill-plus" data-bind="click: $root.GiamSoluongHHTang">
                                                        <i class="material-icons ">add</i>
                                                    </a>
                                                    <input class="form-control input-simple width-75" type="text"
                                                           data-bind="value: SoLuong, attr:{id:'numberTang_'+ ID_DonViQuiDoi},
                                                   event:{keyup: $root.EditSoLuongHHTang}" onkeypress="return keypressNumber(event)" onclick="this.select()">
                                                    <a class="bill-plus bill-plusnext" data-bind="click: $root.TangSoluongHHTang">
                                                        <i class="material-icons ">add</i>
                                                    </a>
                                                </div>
                                                <a class="bill-de" data-bind="click: $root.XoaHangTang">
                                                    <i class="fa fa-times"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer">

                        <button type="button" class="btn btn-cancel" data-dismiss="modal">
                            <i class="fa fa-ban"></i> Bỏ qua
                        </button>
                        <button type="button" class="btn btn-save" data-bind="click: AddKhuyenMai_forHangHoa">
                            <i class=" fa fa-save"></i> Lưu
                        </button>

                    </div>
                </div>
            </div>
        </div>
        <div id="myModalinport" class="modal fade">
            <div class="modal-dialog draggable modal-lg " role="document">
                <div class="modal-content ">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Nhập danh sách hàng hóa từ File Excel</h4>
                    </div>
                    <div class="modal-body">
                        <div class="col-sm-12 printinport">
                            <div class="floatleft excel-file " id="importNhapHang">
                                <div data-bind="visible: visibleImport ">
                                    <h5>Nhập hàng hóa từ file Excel - <a href="#" class="link-text" style="float:none;"> Hướng dẫn </a></h5>
                                    <div class="title-inport "> Tải về File mẫu <span class="blue " data-bind="click: DownloadFileTeamplateXLS"> Excel 2003</span>  hoặc<span class="blue" data-bind="click: DownloadFileTeamplateXLSX"> bản cao hơn</span></div>
                                </div>
                                <div class="choose-file">
                                    <span class="btn btn-import ClickSelectFile btn-file form-control no-magrin" data-bind="visible: visibleImport ">
                                        Chọn file dữ liệu
                                        <input type='file' id="imageUploadForm" name="image" data-bind="event:{ change: SelectedFileImport }"
                                               accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
                                    </span>
                                    <div class="list-file flex flex-row" style="margin-bottom:15px">
                                        <ul class="" style="width:calc(100% - 50px)">
                                            <li class="filterFileSelect flex flex-between">
                                                <span data-bind="text: fileNameExcel"></span>
                                                <button class="btn btn-link height-24" data-bind="click: refreshFileSelect">
                                                    <i class="fa fa-close text-danger"></i>
                                                </button>
                                            </li>
                                        </ul>
                                        <button class="btn btn-main height-30 imgUploadClick" alt="Upload" data-bind="visible:notvisibleImport">
                                            <i class="material-icons">folder</i>
                                        </button>
                                    </div>
                                    <div class="flex flex-center">
                                        <button class="btn btn-main btnImportExcel" id="saveImageFolder" data-bind="click: insertArticleNews"><i class="fa fa-floppy-o"></i> Thực hiện</button>
                                    </div>
                                </div>
                            </div>
                            <div class="warning-content floatleft NoteImport " style="text-align:center">
                                <h5 class="title-alert" style="text-align:center"><i class="fa fa-warning"></i> Lưu ý</h5>
                                <p>Hệ thống hỗ trợ tối đa 10 trang tính (sheet) trên file dữ liệu trong mỗi lần import (mỗi trang tính tương đương một giao dịch)</p>
                            </div>
                        </div>
                        <div class="BangBaoLoi">
                            <div class="error-data">
                                <h4 class="pull-left title">Bảng thông báo lỗi</h4>
                            </div>
                            <div class="table-reponsive table_price table_error">
                                <table class="table  table-hover table-wh">
                                    <thead>
                                        <tr>
                                            <th>Tên Sheet Excel</th>
                                            <th>Vị trí</th>
                                            <th>Thuộc tính</th>
                                            <th>Diễn giải <span class="pull-right red " data-bind="click: ShowandHide"><i class="fa fa-refresh fa-lg" aria-hidden="true"></i></span></th>
                                        </tr>
                                    </thead>
                                    <tbody data-bind="foreach: loiExcel">
                                        <tr>
                                            <td data-bind="text: TenTruongDuLieu"></td>
                                            <td data-bind="text: ViTri"></td>
                                            <td data-bind="text: ThuocTinh"></td>
                                            <td data-bind="text: DienGiai"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--modal KM HoaDon-->
        <div id="promotiont_Parent" class="modal fade">
            <div class="modal-dialog draggable modal-lg " role="document">
                <div class="modal-content ">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Khuyến mại trên hóa đơn</h4>
                    </div>
                    <div class="modal-body" style="overflow-x:auto">
                        <table class="table floatleft ">
                            <thead>
                                <tr>
                                    <th>Chương trình khuyến mại</th>
                                    <th>Hình thức khuyến mại</th>
                                    <th>&nbsp;</th>
                                </tr>
                            </thead>
                            <tbody data-bind="foreach: ListKM_ofHoaDon">
                                <tr>
                                    <td class="ver-top">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="rdoKMaiHD" data-bind="value: ID_KhuyenMai, checked: $parent.HD_KhuyenMai, event:{change: $parent.ChoseKhuyenMai_HD}, attr:{id: ID_KhuyenMai}" />
                                            <label class="form-check-label" data-bind="attr: {for: ID_KhuyenMai}"><span data-bind="text: TenKhuyenMai"></span></label>
                                        </div>
                                    </td>
                                    <td class="ver-top" data-bind="text: HinhThucKhuyenMai"></td>
                                    <td>
                                        <div class="bill-seach" data-bind="visible: HinhThuc === 12 || HinhThuc === 13">
                                            <input type="text" class="form-control"
                                                   data-bind="click: $parent.LoadHangHoaTang_HoaDon,
                                               jqAuto:{source: $parent.HangHoaTang_HoaDons,value: $parent.ID_HHTangHoaDon, inputProp:'MaHangHoa',
                                               valueProp:'KMHD_IDRandom', labelProp:'MaHangHoa',template: 'tempHHMuaHD', filter: 'fiterHHTang'},
                                                attr:{id:'txtAuto_'+ ID_KhuyenMai}"
                                                   placeholder="Tìm kiếm giảm giá" autocomplete="off">
                                            <script type="text/html" id="tempHHMuaHD">
                                                <a>
                                                    <span class="tit-seach" data-bind="text: TenHangHoa"></span>
                                                    <span style="color: #ff6a00" data-bind="text: ThuocTinh_GiaTri"></span>
                                                    <i><span></span></i><br />
                                                    <span data-bind="text: MaHangHoa" class="seach-hh"></span>
                                                    <span style="color: #c4814e" data-bind="visible: MaLoHang">
                                                        Lô: <span class="bold" data-bind="text: MaLoHang"></span>
                                                        <span data-bind="visible: NgaySanXuat">
                                                            <i>
                                                                .NSX:<span data-bind="text: NgaySanXuat==null?'': moment(NgaySanXuat).format('DD/MM/YYYY')">
                                                                </span> -
                                                            </i>
                                                        </span>
                                                        <span data-bind="visible: NgayHetHan">
                                                            <i>  HSD:<span data-bind="text: NgayHetHan==null?'': moment(NgayHetHan).format('DD/MM/YYYY')"></span></i>
                                                        </span>
                                                        <br />
                                                    </span>
                                                    Giá: <span data-bind="text: formatNumber3Digit(GiaBan)"></span>
                                                    <span>
                                                        Tồn kho:<span data-bind="text: TonKho"></span>
                                                    </span>
                                                </a>
                                            </script>
                                            @*<span data-bind="visible: HinhThuc === 12 || HinhThuc === 13" class="icon-seachpp">
                                                <img src="/Content/images/iconbepp18.9/timkiem.png" alt="tìm kiếm">
                                            </span>
                                            <span data-bind="visible: HinhThuc === 11 || HinhThuc === 14"></span>*@
                                        </div>
                                        <div class="text-left" data-bind="visible: HinhThuc === 11 || HinhThuc === 14, text: Note_HinhThuc">
                                        </div>
                                        <div data-bind="foreach: $data.HangHoaChoseTangs, visible: $data.HangHoaChoseTangs.length > 0">
                                            <div class="floatleft list-promotiont">
                                                <div class="code-sp" data-bind="text:MaHangHoa">
                                                </div>
                                                <div class="name-promotiont" data-bind="text: TenHangHoa">
                                                </div>
                                                <div class="list-munber-edit">
                                                    <a class="bill-plus" data-bind="click: $root.GiamSoluongHHTang_HoaDon">
                                                        <i class="material-icons ">add</i>
                                                    </a>
                                                    <input class="form-control input-simple" type="text"
                                                           data-bind="value: SoLuong, attr:{id:'numberTangHD_'+ ID_DonViQuiDoi},
                                                   event:{keyup: $root.EditSoLuongHHTang_HoaDon}" onkeypress="return keypressNumber(event)" onclick="this.select()">
                                                    <a class="bill-plus bill-plusnext" data-bind="click: $root.TangSoluongHHTang_HoaDon">
                                                        <i class="material-icons ">add</i>
                                                    </a>
                                                </div>
                                                <a class="bill-de" data-bind="click: $root.XoaHangTang_HoaDon">
                                                    <i class="fa fa-times"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer ">

                        <button type="button" class="btn btn-cancel" data-dismiss="modal">
                            <i class="fa fa-ban"></i> Bỏ qua
                        </button>
                        <button type="button" class="btn btn-save" data-bind="click: AddKhuyenMai_forHoaDon">
                            <i class="fa fa-save"></i> Lưu
                        </button>

                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="modalPopuplgDelete">
            <div class="modal-dialog draggable modal-md " role="document">
                @Html.Action("_modalDelete", new { area = "", Controller = "GiaoDich" })
            </div>
        </div>
        <!--mode computer-->
        <div class="modal fade in" id="computersquer">
            <div class="modal-dialog draggable  modal-lg " role="document">
                <div class="computer">
                    @Html.Partial("_CaculatorPrice")
                </div>
            </div>
        </div>
        <!--increasing the number-->
        <div class="modal fade in" id="increasing">
            <div class="modal-dialog draggable  modal-lg " role="document">
                <div class="computer">
                    <div class="modal-content ">
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Số lượng:</label>
                                <div class="price-reduce bold">
                                    <div class=" pull-right">
                                        <div>
                                            <a href="javascript:void(0)" class="bill-plus" title="Giảm số lượng">
                                                <i class="fa fa-minus"></i>
                                            </a>
                                            <input type="text" class="form-control input-simple">
                                            <a href="javascript:void(0)" class="bill-plus bill-plusnext" title="Tăng số lượng">
                                                <i class="material-icons ">add</i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="main-munber">
                            <div class="main-munbertop">
                                <div class="munber-night">
                                    <button>7</button>
                                </div>
                                <div class="munber-night">
                                    <button>8</button>
                                </div>
                                <div class="munber-night">
                                    <button>9</button>
                                </div>
                            </div>
                            <div class="main-munbertop">
                                <div class="munber-night">
                                    <button>4</button>
                                </div>
                                <div class="munber-night">
                                    <button>5</button>
                                </div>
                                <div class="munber-night">
                                    <button>6</button>
                                </div>
                            </div>
                            <div class="main-munbertop">
                                <div class="munber-night">
                                    <button>1</button>
                                </div>
                                <div class="munber-night">
                                    <button>2</button>
                                </div>
                                <div class="munber-night">
                                    <button>3</button>
                                </div>
                            </div>
                            <div class="main-munbertop">
                                <div class="munber-night">
                                    <button>.</button>
                                </div>
                                <div class="munber-night">
                                    <button>0</button>
                                </div>
                                <div class="munber-night">
                                    <button>
                                        <img src="/Content/images/print/icccoo-11.png" alt="" />
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-main">
                                <i class="fa fa-check-square"></i> Xong
                            </button>
                            <button type="button" class="btn btn-cancel" data-dismiss="modal"><i class="fa fa-ban"></i>&nbsp;Bỏ qua</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        @*Hiện ẩn cột trên hóa đơn*@
        <div class="modal fade  xoadulieu" id="HienThi">
            <div class="modal-dialog draggable   modal-sm " role="document">
                @Html.Partial("_SettingHideShowColumnCTHD")
            </div>
        </div>

        <div class="modal fade printflast" id="print_HoaDonBL">
            <div class="modal-dialog draggable   modal-lg " role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Hóa đơn</h4>
                    </div>
                    <div class="modal-body modal-bill" id="content-print-BanLe">
                        @Html.Raw(Html.Action("LoadMauIn", "ThietLap", new { id = "K80_HoaDonBanLe.txt" }))
                    </div>
                    <div class="footer-res floatleft">
                        <a href="javascript:void(0)" class="btn btn-main" data-bind="click: function () {InHoaDon('#content-print-BanLe')} ">
                            <img src="/Content/images/iconbepp18.9/innhap.png" alt="in hóa đơn" />  In hóa đơn
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel">
                            <img src="/Content/images/iconbepp18.9/guiggmail.png" alt=" gửi email" />      Gửi email
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel" data-dismiss="modal">
                            <i class="fa fa-ban"></i> Bỏ qua
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade printflast" id="print_GoiDV">
            <div class="modal-dialog draggable   modal-lg " role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Hóa đơn</h4>
                    </div>
                    <div class="modal-body modal-bill" id="content-print-GoiDV">
                        @Html.Raw(Html.Action("LoadMauIn", "ThietLap", new { id = "K80_GoiDichVu.txt" }))
                    </div>
                    <div class="footer-res floatleft">
                        <a href="javascript:void(0)" class="btn btn-main" data-bind="click: function () {InHoaDon('#content-print-GoiDV')} ">
                            <img src="/Content/images/iconbepp18.9/innhap.png" alt="in hóa đơn" />  In hóa đơn
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel">
                            <img src="/Content/images/iconbepp18.9/guiggmail.png" alt="gửi email" />      Gửi email
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel" data-dismiss="modal">
                            <i class="fa fa-ban"></i> Bỏ qua
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade printflast" id="print_HoaDonDatHang">
            <div class="modal-dialog draggable   modal-lg " role="document">
                <div class="modal-content ">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Hóa đơn</h4>
                    </div>
                    <div class="modal-body modal-bill" id="content-print-DatHang">
                        @Html.Raw(Html.Action("LoadMauIn", "ThietLap", new { id = "K80_DatHang.txt" }))
                    </div>
                    <div class="footer-res floatleft">
                        <a href="javascript:void(0)" class="btn btn-main" data-bind="click: function () {InHoaDon('#content-print-DatHang')} ">
                            <img src="/Content/images/iconbepp18.9/innhap.png" alt="in hóa đơn" />  In hóa đơn
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel">
                            <img src="/Content/images/iconbepp18.9/guiggmail.png" alt="gửi email" />      Gửi email
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel" data-dismiss="modal">
                            <i class="fa fa-ban"></i> Bỏ qua
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal tab hóa đơn chế độ di động-->
        <div class="modal fade" id="bill-list-content">
            <div class="modal-dialog draggable modal-md  modal-xs " role="document" style="    margin: 0;    height: 100vw;    width: 100vw;">
                <!-- Modal content-->
                <div class="modal-content" style="    width: 300px;    margin: calc(50vw - 150px);">
                    <div class="modal-body " id="bill-list-content-body">
                        <ul class="container-fluid nopadding" style="height:200px">
                            <!--ko foreach: result_HoaDon -->
                            <li class=" container nopadding active " data-bind="click: $parent.GetThongTinHoaDon, attr:{class: IsActive, title: MaHoaDon}" style="display:block; margin-bottom:15px;">
                                <div class="container-fluid" style="margin-bottom:5px;">
                                    <div class="col-xs-10 " style="border-bottom: 1px solid #ccc">
                                        <label class="pull-left" data-bind="text: commonStatisJs.SubStringContent(MaHoaDon,12)" style="width:calc(100% - 50px);" data-dismiss="modal" onclick=showname(this)></label>
                                        <font data-bind="attr:{id:'li_'+ $index() }, text: MaHoaDon" hidden>
                                        </font>
                                    </div>
                                    <div class="col-xs-2">
                                        <button class="icon-addHH bg-hover " data-bind="click: $parent.CloseHoaDon"
                                                data-dismiss="modal" style="border-radius:15px;width:30px;height:30px;padding: 3px !important;left: unset;top:0">
                                            <i class="material-icons">close</i>
                                        </button>
                                    </div>
                                </div>
                            </li>
                            <!--/ko-->
                        </ul>
                        <div class="col-xs-6">
                            <button class="form-control btn btn-default" href="javascript:void(0)" data-bind="click: prevHoaDon, visible: hasPrevHD">
                                Trước
                            </button>
                        </div>
                        <div class="col-xs-6">
                            <button class="form-control btn btn-default" href="javascript:void(0)" data-bind="click: nextHoaDon, visible: hasNextHD">
                                Sau
                            </button>
                        </div>
                    </div>
                    <div class="modal-footer">

                        <button href="javascript:void(0)" data-bind="click:addPhongBan" class="btn btn-main">
                            Thêm mới hóa đơn
                        </button>
                        <button type="button" class="bnt btn-cancel" data-dismiss="modal">Đóng</button>

                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade printflast" id="print_HoaDonTraHang">
            <div class="modal-dialog draggable   modal-lg " role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Hóa đơn</h4>
                    </div>
                    <div class="modal-body modal-bill" id="content-print-TraHang">
                        @Html.Raw(Html.Action("LoadMauIn", "ThietLap", new { id = "K80_TraHang.txt" }))
                    </div>
                    <div class="footer-res floatleft">
                        <a href="javascript:void(0)" class="btn btn-main" data-bind="click: function () {InHoaDon('#content-print-TraHang')} ">
                            <img src="/Content/images/iconbepp18.9/innhap.png" alt="In hóa đơn" />  In hóa đơn
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel">
                            <img src="/Content/images/iconbepp18.9/guiggmail.png" alt="Gửi Email" />      Gửi email
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel" data-dismiss="modal">
                            <i class="fa fa-ban"></i> Bỏ qua
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade printflast" id="print_HoaDonDoiTraHang">
            <div class="modal-dialog draggable   modal-lg " role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Hóa đơn</h4>
                    </div>
                    <div class="modal-body modal-bill" id="content-print-DoiTraHang">
                        @Html.Raw(Html.Action("LoadMauIn", "ThietLap", new { id = "K80_DoiTraHang.txt" }))
                    </div>
                    <div class="footer-res floatleft">
                        <a href="javascript:void(0)" class="btn btn-main" data-bind="click: function () {InHoaDon('#content-print-DoiTraHang')} ">
                            <img src="/Content/images/iconbepp18.9/innhap.png" alt="In hóa đơn" />  In hóa đơn
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel">
                            <img src="/Content/images/iconbepp18.9/guiggmail.png" alt="Gửi email" />      Gửi email
                        </a>
                        <a href="javascript:void(0)" class="btn btn-cancel" data-dismiss="modal">
                            <i class="fa fa-ban"></i> Bỏ qua
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade " id="modalPopupdoivitri">
            <div class="modal-dialog draggable   modal-lg " role="document">
                @Html.Partial("_doivitriPartial")
            </div>
        </div>
        <div class="modal fade in" id="hdOtherClient">
            <div class="modal-dialog draggable   modal-lg " role="document">
                @Html.Partial("_HoaDonOtherUser")
            </div>
        </div>
    </div>
    <div id="partial_product_group">
        <div class="modal fade" id="partialAddProduct">
            <div class="modal-dialog draggable modal-md  " role="document">
                @Html.Partial("_ThemMoiHangHoaDV")
            </div>
        </div>
        <div class="modal" id="partialGroupProduct">
            <div class="modal-dialog draggable modal-md " role="document">
                @Html.Partial("_ThemNhomHangHoaDV")
            </div>
        </div>
    </div>
    <div class="modal fade" id="partialCalendar">
        <div class="modal-dialog draggable modal-md  " role="document">
            @Html.Partial("_LichHen")
        </div>
    </div>

  
    <div class="bgwhite" hidden></div>
    <script>
        $(document).ready(function () {
            $(".modal-dialog").draggable({ handle: ".modal-header" })
        });
        var op_prev_op;
        function showpanel(options) {
            if (options == op_prev_op && $('.op-function-box').is(':visible')) {
                $('.op-function-box').hide();
                return;
            } else {
                $('.op-function-box').show();
                for (var i = 1; i <= 4; i++) {
                    $('.op-function-box').removeClass('active-' + i);
                }
                $('.op-function-box').addClass('active-' + options);
                switch (options) {
                    case 1:
                        $("#op_js_shortkey").siblings().hide();
                        $("#op_js_shortkey").show();
                        break;
                    case 2:
                        $("#op_js_mauin").siblings().hide();
                        $("#op_js_mauin").show();
                        break;
                    case 3:
                        $("#op_js_function").siblings().hide();
                        $("#op_js_function").show();
                        break;
                    case 4:
                        $("#op_js_nhanvien").siblings().hide();
                        $("#op_js_nhanvien").show();
                        break;
                }
            };
            op_prev_op = options;
        }
        $(document).mouseup(function (e) {
            var container = $(".op-function-box");
            if (!container.is(e.target) && container.has(e.target).length === 0) {
                container.hide();
            }

            var containershowseach_TH = $("#showseach_TH");
            if (!containershowseach_TH.is(e.target) && containershowseach_TH.has(e.target).length === 0) {
                containershowseach_TH.hide();
            }
        });
    </script>
</body>
</html>
<script src="/signalr/hubs"></script>
<script src="~/Scripts/Components/Ko-component.js"></script>
<script src="@Url.ContentVersioned("~/Scripts/Components/Input.js")"></script>
<script src="@Url.ContentVersioned("~/Scripts/Components/NhanVien_KhachHang.js")"></script>
<script src="@Url.ContentVersioned("~/Scripts/BanHang/ssoft-server-time.js")"></script>
<script type="text/javascript" src="@Url.ContentVersioned("~/Content/js/Open24FileManager.js")"></script>

@Html.Partial("~/Views/Gara/_ThongTinThanhToanKH.cshtml")
@Html.Partial("~/Views/Gara/HoaDon/_EditHoaHongHD.cshtml")
@Html.Partial("~/Views/Gara/KhachHang/_ThemNhomKhachHang.cshtml")
@Html.Partial("~/Views/Gara/KhachHang/_ThemMoiKhachHang.cshtml")
@Html.Partial("~/Views/Gara/KhachHang/_vmTrangThai_NguonKhach.cshtml")
@Html.Partial("~/Views/Gara/HoaDon/_ThuTienHoaDon.cshtml")
@Html.Partial("~/Views/Gara/HoaDon/_ThongTinHoaDon.cshtml")
@Html.Partial("~/Views/Gara/_ThanhPhanDinhLuong.cshtml")
@Html.Partial("~/Views/Gara/HoaDon/_ThanhPhanCombo.cshtml")
@Html.Partial("~/Views/Gara/_NhatKyGoiBaoDuong.cshtml")
@Html.Partial("~/Views/BanHang/_trahanghoadon.cshtml")
@Html.Partial("~/Views/Component/_vue-ImageModal.cshtml")
@Html.Partial("~/Views/DoiTac/_UpAnhHoaDon.cshtml")
@Html.Partial("~/Views/BanHang/_NhatKyGiaoDichChiTiet.cshtml")
@Html.Partial("~/Views/BanHang/_vmApDungNhomHoTro.cshtml")
@Html.Partial("~/Views/HangHoa/_vmApplyGroupProduct.cshtml")

<script src="@Html.WriteRenderFile(Scripts.Url("~/bundles/BanLe"))" type="text/javascript"></script>

<script>
    $(function () {
        $.datetimepicker.setLocale('vi');
        $('#datepicker').datetimepicker(
            {
                format: "d/m/Y",
                defaultDate: new Date(),
                mask: true,
                maxDate: new Date(),
                timepicker: false,
                scrollMonth: false,
            });
        $('#timepicker').datetimepicker(
            {
                format: "H:i",
                step: 15,
                datepicker: false,
            });
    });
    $(function () {
        $(".draggable").draggable({ handle: ".modal-header" });
    });
    function loadMauInMacDinh(url, $this) {
        $.ajax({
            url: url, cache: false,
            success: function (result) {
                $this.html(result);
            }
        });
    }
    $("#CTHDView, #divCTDoiTra").on('click', '.quy-cach-edit-left', function () {
        $('.call-quy-cach').mouseup(function () {
            return false
        });
        $(document).mouseup(function () {
            $('.call-quy-cach').hide();
        });
    });
    $(".name-bill2,.name-bill1").mouseup(function () {
        return false
    });
    $(".select-user").mouseup(function () {
        return false;
    });
    $(document).mouseup(function () {
        $(".select-user").hide();
    });
    $(".up-slide").click(function () {
        $(".up-slide a").toggle();
        $(".slide-goods1").toggleClass("sli-gos");
        $(".bill-listchoose").toggleClass("height99");
    });
    $(".bill-print").click(function () {
        $(".function-keys").hide();
        $(".install-notifi").mouseup(function () {
            return false
        });
        $(".bill-print").mouseup(function () {
            return false;
        });
        $(document).mouseup(function () {
            $(".install-notifi").hide();
        });
    });
    $(".main-keys").click(function () {
        $(".install-notifi").hide();
        $(".function-keys").toggle();
        $(".function-keys").mouseup(function () {
            return false
        });
        $(".main-keys").mouseup(function () {
            return false;
        });
        $(document).mouseup(function () {
            $(".function-keys").hide();
        });
    });
    $('#CTHDView, #divCTDoiTra').on('click', '.newprice', function () {
        $(".callprice").mouseup(function () {
            return false
        });
        $('.call-quy-cach').mouseup(function () {
            return false
        });
        $(document).mouseup(function () {
            $(".callprice").hide();
        });
    });
    $(document).on('click', '.choose-person', function () {
        // if input LoHang disable --> not show list LoHang
        var ipLoHang = $(this).children('input');
        if (ipLoHang.attr('disabled') === 'disabled') {
            $(this).attr("aria-expanded", "false");
            $(this).parent().removeClass('open');
        }
    });

    $(document).on('mouseenter', '.group-quantity-serrvice', function (event) {
    }).on('mouseleave', '.group-quantity-serrvice', function (event) {
        $('.group-detail-serrvice').hide();
    });
    $('.tab-so-do').on('click', 'li', function () {
        if ($(this).data('id') === 1 || $(this).data('id') === '1') {
            $('.filter-ban-le').hide();
            $('.filter-so-do').show();
            $('#divListHD').hide();
        }
        else {
            $('.filter-so-do').hide();
            $('.filter-ban-le').show();
            $('#divListHD').show();
        }
    })

    function checkIsShowbtnSave() {
        var number = 0;
        $('#ListBtnGroupSave button').each(function () {
            if ($(this).css('display') !== 'none') {
                number += 1;
            }
        });
        if (number === 3) {
            $('#btnSave').removeClass('add-print');
            $('#btnSave').addClass('add-Save-draft');
        }
        else if (number === 2) {
            $('#btnSave').removeClass('add-Save-draft');
            $('#btnSave').addClass('add-print');
        }
        else {
            $('#btnSave').removeClass('add-print');
            $('#btnSave').removeClass('add-Save-draft');
        }
    }
    $('.btn-gray').on("click", function () {
        $(this).parent(".li-show").css("background", "red")
    });
    $('.li-show').on("mouseenter", function () {
        $(this).find(".ghichu").css("display", "block !important")
    });
    $(document).ready(function () {
        if (!($('.ghichu input').val() == '')) {
            $('.ghichu input').css("color", "gray")
        };
        $('[data-toggle="tooltip"]').tooltip();
    });
    $('.li-show').hover(function () {
        $(this).find(".hoadon-stt").css("font-weight", "bold");
    });
    $(document).ready(function () {
    });
    function openmenu() {
        if (document.getElementById("thanhtoan").style.display == "none") {
            document.getElementById("thanhtoan").style.display = "block";
            document.getElementById("header1").style.display = "none";
            document.getElementById("bill-header").scrollIntoView();
        }
        else {
            closemenu();
            document.getElementById("thanhtoan").style.display = "none";
            document.getElementById("header1").style.display = "block";
            document.getElementById("bill-header").scrollIntoView();
        }
    };
    function closemenu() {
        document.getElementById("thanhtoan").style.display = "none";
        document.getElementById("header1").style.display = "block";
        document.getElementById("bill-header").scrollIntoView();
        document.getElementById("txtSearchHH").focus();
    };
    function showsearch() {
        document.getElementsByClassName('bill-seach').setAttribute('style', 'display:block !important');
    };
    function showtab() {
        $("#divListHD").css("display", "block");
    };
    if (screen.width <= 425) {
        document.getElementById("full-screen").style.display = "none";
    };
    if (screen.width <= 768) {
        document.getElementById("full-screen").style.display = "none";
        document.getElementById("thanhtoan").style.display = "none";
    };
    function pullright() {
        $("#billwidown").toggleClass("right400");
        $("#billwidown i").toggle();
        $("#banhanghanghoa .w701").toggleClass("margin0");
        $("#billwidown  .height-fix").delay(100).fadeToggle();
        $("#floatpayment").fadeToggle();
        $("#thanhtoan").toggleClass("bor22")
    }
    function createShortcut() {
        $.ajax({
            url: "/Home/CreateShortcut",
            type: "POST",
            success: function (data) {
            }
        });
    }
    function barcodeinput() {
        if ($('#pressNormal').css('display') == ('none')) {
            $("#searchandadd").css("width", "calc(100% - 210px)")
        }
        else {
            $("#searchandadd").css("width", "calc(100% - 50px)")
        }
    };
    function showdoitramenu() {
        if ($(".slide-goods").css('bottom') != ('-275px')) {
            $("#btndoitra").html(' <i class="glyphicon glyphicon-menu-up "style="display:inline-block"></i>')
            $("#CTHDView").css('height', 'calc(100% - 40px)');
            $(".slide-goods").css('bottom', '-275px');
        }
        else {
            $("#btndoitra").html(' <i class="glyphicon glyphicon-menu-down "style="display:inline-block"></i>')
            $("#CTHDView").css('height', 'calc(100% - 340px)');
            $(".slide-goods").css('bottom', '0');
        }
    }
    function showname(ele) {
        $("#billname").html($(ele).text());
    };
    function add_zindex_above(ele) {
        $("#bill-header").addClass("z2-front");
        $(document).mouseup(function () {
            $("#bill-header").removeClass("z2-front");
        })
    }
    function push30(ele) {
        if ($(document).width() < 768) {

            $(ele).parent().parent().toggleClass("push30-m");
            $(ele).parent().parent().siblings().removeClass("push30-m");
        }
    }
    $(document).mouseup(function (e) {
        var container = $(".dropbox");
        if (!container.is(e.target) && container.has(e.target).length === 0) {
            container.hide();
        }
    });
    $(document).mouseup(function (e) {
        var container = $(".callprice");
        if (!container.is(e.target) && container.has(e.target).length === 0) {
            container.hide();
        }
    });
</script>
<script type="text/javascript">


    $('.modal-content').resizable({
        minHeight: 300,
        minWidth: 300
    });
</script>